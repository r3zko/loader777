{
    "status": 200,
    "content": 
"bG9jYWwgbGlicyA9IHsKICAgIFsnZ2FtZXNlbnNlL2h0dHAnXSA9ICdnYW1lc2Vuc2UgLyBodHRwJywKICAgIFsnZ2FtZXNlbnNlL3B1aSddID0gJ2dhbWVzZW5zZSAvIHB1aScsCiAgICBbJ2dhbWVzZW5zZS9iYXNlNjQnXSA9ICdnYW1lc2Vuc2UgLyBiYXNlNjQnLAogICAgWydnYW1lc2Vuc2UvZW50aXR5J10gPSAnZ2FtZXNlbnNlIC8gZW50aXR5JywKICAgIFsnZ2FtZXNlbnNlL2ltYWdlcyddID0gJ2dhbWVzZW5zZSAvIGltYWdlcycsCiAgICBbJ2dhbWVzZW5zZS9kaXNjb3JkX3dlYmhvb2tzJ10gPSAnZ2FtZXNlbnNlIC8gZGlzY29yZF93ZWJob29rcycsCiAgICBbJ2dhbWVzZW5zZS9jbGlwYm9hcmQnXSA9ICdnYW1lc2Vuc2UgLyBjbGlwYm9hcmQnLAogICAgWydnYW1lc2Vuc2UvYW50aWFpbV9mdW5jcyddID0gJ2dhbWVzZW5zZSAvIGFudGlhaW1fZnVuY3MnCn0KCmxvY2FsIGxpYl9ub19zdWIgPSB7fQoKZm9yIGksIHYgaW4gcGFpcnMobGlicykgZG8KICAgIGlmIG5vdCBwY2FsbChyZXF1aXJlLCBpKSB0aGVuCiAgICAgICAgbGliX25vX3N1YlsjbGliX25vX3N1YiArIDFdID0gbGlic1tpXQogICAgZW5kCmVuZAoKZm9yIGk9MSwgI2xpYl9ub19zdWIgZG8KICAgIHByaW50KCJcblN1YnNjcmliZSBsaWJyYXJpZXM6XG4iIC4uIHRhYmxlLmNvbmNhdChsaWJfbm9fc3ViLCAiLCBcbiIpKQplbmQKCmxvY2FsIGZmaSA9IHJlcXVpcmUoImZmaSIpCmxvY2FsIGh0dHAgPSByZXF1aXJlKCdnYW1lc2Vuc2UvaHR0cCcpCmxvY2FsIHB1aSA9IHJlcXVpcmUoImdhbWVzZW5zZS9wdWkiKQpsb2NhbCBiYXNlNjQgPSByZXF1aXJlKCJnYW1lc2Vuc2UvYmFzZTY0IikKbG9jYWwgdmVjdG9yID0gcmVxdWlyZSgidmVjdG9yIikKbG9jYWwgZW50X2xpYiA9IHJlcXVpcmUoImdhbWVzZW5zZS9lbnRpdHkiKQpsb2NhbCBpbWFnZXMgPSByZXF1aXJlKCJnYW1lc2Vuc2UvaW1hZ2VzIikKbG9jYWwgZGlzY29yZCA9IHJlcXVpcmUoImdhbWVzZW5zZS9kaXNjb3JkX3dlYmhvb2tzIikKbG9jYWwgY2xpcGJvYXJkID0gcmVxdWlyZSgiZ2FtZXNlbnNlL2NsaXBib2FyZCIpCmxvY2FsIGFudGlhaW1fZnVuY3MgPSByZXF1aXJlKCJnYW1lc2Vuc2UvYW50aWFpbV9mdW5jcyIpCgpYLFkgPSBjbGllbnQuc2NyZWVuX3NpemUoKQoKLS1bWwogICAgTFVBOiBpbnRlcml0dXMKXV0KCmxvY2FsIGV1cGhlbWlhID0gZXVwaGVtaWFfZGF0YSBhbmQgZXVwaGVtaWFfZGF0YSgpIG9yIHsKICAgIHVzZXJuYW1lID0gImxvYWRlcjc3NyIsCiAgICBidWlsZCA9ICJyZW5ld2VkIgp9Cgpsb2NhbCBub3RpZnlfZGF0YSA9IHt9CgpwdWkuYWNjZW50ID0gIkZGNzM2OWZmIiAtLSBsdWEgbWFpbiBjb2xvcgpwdWkubWFjcm9zLmhlYXJ0ID0gJ+KdpCcKbG9jYWwgZ3JvdXAgPSBwdWkuZ3JvdXAoImFhIiwiYW50aS1haW1ib3QgYW5nbGVzIikgLS0gR1JPVVAgLSBBTlRJQUlNCmxvY2FsIGdyb3VwX290aGVyID0gcHVpLmdyb3VwKCJhYSIsIk90aGVyIikgLS0gR1JPVVAgLSBPVEhFUgoKbG9jYWwgcmVmcyA9IHsKICAgIHJlZmVyZW5jZXMgPSB7CiAgICAgICAgbWluaW11bV9kYW1hZ2UgPSB1aS5yZWZlcmVuY2UoIlJBR0UiLCAiQWltYm90IiwgIk1pbmltdW0gZGFtYWdlIiksCiAgICAgICAgbWluaW11bV9kYW1hZ2Vfb3ZlcnJpZGUgPSB7dWkucmVmZXJlbmNlKCJSQUdFIiwgIkFpbWJvdCIsICJNaW5pbXVtIGRhbWFnZSBvdmVycmlkZSIpfSwKICAgICAgICBkb3VibGVfdGFwID0ge3VpLnJlZmVyZW5jZSgnUkFHRScsICdBaW1ib3QnLCAnRG91YmxlIHRhcCcpfSwKICAgICAgICBwcyA9IHsgdWkucmVmZXJlbmNlKCJNSVNDIiwgIk1pc2NlbGxhbmVvdXMiLCAiUGluZyBzcGlrZSIpIH0sCiAgICAgICAgZHVja19wZWVrX2Fzc2lzdCA9IHVpLnJlZmVyZW5jZSgnUkFHRScsICdPdGhlcicsICdEdWNrIHBlZWsgYXNzaXN0JyksCiAgICAgICAgZW5hYmxlZCA9IHVpLnJlZmVyZW5jZSgnQUEnLCAnQW50aS1haW1ib3QgYW5nbGVzJywgJ0VuYWJsZWQnKSwKICAgICAgICBwaXRjaCA9IHt1aS5yZWZlcmVuY2UoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdQaXRjaCcpfSwKICAgICAgICB5YXdfYmFzZSA9IHVpLnJlZmVyZW5jZSgnQUEnLCAnQW50aS1haW1ib3QgYW5nbGVzJywgJ1lhdyBiYXNlJyksCiAgICAgICAgeWF3ID0ge3VpLnJlZmVyZW5jZSgnQUEnLCAnQW50aS1haW1ib3QgYW5nbGVzJywgJ1lhdycpfSwKICAgICAgICB5YXdfaml0dGVyID0ge3VpLnJlZmVyZW5jZSgnQUEnLCAnQW50aS1haW1ib3QgYW5nbGVzJywgJ1lhdyBqaXR0ZXInKX0sCiAgICAgICAgYm9keV95YXcgPSB7dWkucmVmZXJlbmNlKCdBQScsICdBbnRpLWFpbWJvdCBhbmdsZXMnLCAnQm9keSB5YXcnKX0sCiAgICAgICAgZnJlZXN0YW5kaW5nX2JvZHlfeWF3ID0gdWkucmVmZXJlbmNlKCdBQScsICdhbnRpLWFpbWJvdCBhbmdsZXMnLCAnRnJlZXN0YW5kaW5nIGJvZHkgeWF3JyksCiAgICAgICAgZWRnZV95YXcgPSB1aS5yZWZlcmVuY2UoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdFZGdlIHlhdycpLAogICAgICAgIGZyZWVzdGFuZGluZyA9IHt1aS5yZWZlcmVuY2UoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdGcmVlc3RhbmRpbmcnKX0sCiAgICAgICAgcm9sbCA9IHVpLnJlZmVyZW5jZSgnQUEnLCAnQW50aS1haW1ib3QgYW5nbGVzJywgJ1JvbGwnKSwKICAgICAgICBzbG93X21vdGlvbiA9IHt1aS5yZWZlcmVuY2UoJ0FBJywgJ090aGVyJywgJ1Nsb3cgbW90aW9uJyl9LAogICAgICAgIGxlZ19tb3ZlbWVudCA9IHVpLnJlZmVyZW5jZSgnQUEnLCAnT3RoZXInLCAnTGVnIG1vdmVtZW50JyksCiAgICAgICAgb25fc2hvdF9hbnRpX2FpbSA9IHt1aS5yZWZlcmVuY2UoJ0FBJywgJ090aGVyJywgJ09uIHNob3QgYW50aS1haW0nKX0KICAgIH0sICAKICAgIHJlZiA9IHsKICAgICAgICBhYV9lbmFibGUgPSB1aS5yZWZlcmVuY2UoIkFBIiwiYW50aS1haW1ib3QgYW5nbGVzIiwiZW5hYmxlZCIpLAogICAgICAgIHBpdGNoID0gdWkucmVmZXJlbmNlKCJBQSIsImFudGktYWltYm90IGFuZ2xlcyIsInBpdGNoIiksCiAgICAgICAgcGl0Y2hfdmFsdWUgPSBzZWxlY3QoMiwgdWkucmVmZXJlbmNlKCJBQSIsImFudGktYWltYm90IGFuZ2xlcyIsInBpdGNoIikpLAogICAgICAgIHlhd19iYXNlID0gdWkucmVmZXJlbmNlKCJBQSIsImFudGktYWltYm90IGFuZ2xlcyIsInlhdyBiYXNlIiksCiAgICAgICAgeWF3ID0gdWkucmVmZXJlbmNlKCJBQSIsImFudGktYWltYm90IGFuZ2xlcyIsInlhdyIpLAogICAgICAgIHlhd192YWx1ZSA9IHNlbGVjdCgyLCB1aS5yZWZlcmVuY2UoIkFBIiwiYW50aS1haW1ib3QgYW5nbGVzIiwieWF3IikpLAogICAgICAgIHlhd19qaXR0ZXIgPSB1aS5yZWZlcmVuY2UoIkFBIiwiQW50aS1haW1ib3QgYW5nbGVzIiwiWWF3IEppdHRlciIpLAogICAgICAgIHlhd19qaXR0ZXJfdmFsdWUgPSBzZWxlY3QoMiwgdWkucmVmZXJlbmNlKCJBQSIsIkFudGktYWltYm90IGFuZ2xlcyIsIllhdyBKaXR0ZXIiKSksCiAgICAgICAgYm9keV95YXcgPSB1aS5yZWZlcmVuY2UoIkFBIiwiQW50aS1haW1ib3QgYW5nbGVzIiwiQm9keSB5YXciKSwKICAgICAgICBib2R5X3lhd192YWx1ZSA9IHNlbGVjdCgyLCB1aS5yZWZlcmVuY2UoIkFBIiwiQW50aS1haW1ib3QgYW5nbGVzIiwiQm9keSB5YXciKSksCiAgICAgICAgZnJlZXN0YW5kX2JvZHlfeWF3ID0gdWkucmVmZXJlbmNlKCJBQSIsIkFudGktYWltYm90IGFuZ2xlcyIsImZyZWVzdGFuZGluZyBib2R5IHlhdyIpLAogICAgICAgIGVkZ2V5YXcgPSB1aS5yZWZlcmVuY2UoIkFBIiwiYW50aS1haW1ib3QgYW5nbGVzIiwiZWRnZSB5YXciKSwKICAgICAgICBmcmVlc3RhbmQgPSB7dWkucmVmZXJlbmNlKCJBQSIsImFudGktYWltYm90IGFuZ2xlcyIsImZyZWVzdGFuZGluZyIpfSwKICAgICAgICByb2xsID0gdWkucmVmZXJlbmNlKCJBQSIsImFudGktYWltYm90IGFuZ2xlcyIsInJvbGwiKSwKICAgICAgICBzbGlkZSA9IHt1aS5yZWZlcmVuY2UoIkFBIiwib3RoZXIiLCJzbG93IG1vdGlvbiIpfSwKICAgICAgICBmYWtlZHVjayA9IHVpLnJlZmVyZW5jZSgicmFnZSIsIm90aGVyIiwiZHVjayBwZWVrIGFzc2lzdCIpLAogICAgICAgIHF1aWNrX3BlZWsgPSB7dWkucmVmZXJlbmNlKCJyYWdlIiwgIm90aGVyIiwgInF1aWNrIHBlZWsgYXNzaXN0Iil9LAogICAgICAgIGRvdWJsZXRhcCA9IHt1aS5yZWZlcmVuY2UoInJhZ2UiLCAiYWltYm90IiwgImRvdWJsZSB0YXAiKX0sCiAgICB9Cn0KCmxvY2FsIGZ1bmNzID0gewogICAgY29udGFpbnMgPSBmdW5jdGlvbih0YmwsIGFyZykKICAgICAgICBmb3IgaW5kZXgsIHZhbHVlIGluIG5leHQsIHRibCBkbyAKICAgICAgICAgICAgaWYgdmFsdWUgPT0gYXJnIHRoZW4gCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZSBlbmQgCiAgICAgICAgICAgIGVuZCAKICAgICAgICByZXR1cm4gZmFsc2UKICAgIGVuZCwKICAgIGxlcnAgPSBmdW5jdGlvbihhLCBiLCB0KQogICAgICAgIHJldHVybiBhICsgKGIgLSBhKSAqIHQKICAgIGVuZCwKICAgIHJnYmFfdG9faGV4ID0gZnVuY3Rpb24oYixjLGQsZSkKICAgICAgICByZXR1cm4gc3RyaW5nLmZvcm1hdCgnJTAyeCUwMnglMDJ4JTAyeCcsYixjLGQsZSkKICAgIGVuZCwKICAgIGdyYWRpZW50X3RleHQgPSBmdW5jdGlvbih0ZXh0LCBzcGVlZCwgcixnLGIsYSkKICAgICAgICBsb2NhbCBmaW5hbF90ZXh0ID0gJycKICAgICAgICBsb2NhbCBjdXJ0aW1lID0gZ2xvYmFscy5jdXJ0aW1lKCkKICAgICAgICBsb2NhbCBjZW50ZXIgPSBtYXRoLmZsb29yKCN0ZXh0IC8gMikgKyAxCiAgICAgICAgZm9yIGk9MSwgI3RleHQgZG8KICAgICAgICAgICAgbG9jYWwgZGlzdGFuY2UgPSBtYXRoLmFicyhpIC0gY2VudGVyKQogICAgICAgICAgICBhID0gMjU1IC0gbWF0aC5hYnMoMjU1ICogbWF0aC5zaW4oc3BlZWQgKiBjdXJ0aW1lIC8gNCAtIGRpc3RhbmNlICogNCAvIDIwKSkKICAgICAgICAgICAgbG9jYWwgY29sID0gc3RyaW5nLmZvcm1hdCgnJTAyeCUwMnglMDJ4JTAyeCcscixnLGIsYSkKICAgICAgICAgICAgZmluYWxfdGV4dCA9IGZpbmFsX3RleHQgLi4gJ1xhJyAuLiBjb2wgLi4gdGV4dDpzdWIoaSwgaSkKICAgICAgICBlbmQKICAgICAgICByZXR1cm4gZmluYWxfdGV4dAogICAgZW5kLAogICAgdGV4dF9mYWRlX2FuaW1hdGlvbiA9IGZ1bmN0aW9uKHNwZWVkLCByLCBnLCBiLCBhLCB0ZXh0KQogICAgICAgIGxvY2FsIGZpbmFsX3RleHQgPSAnJwogICAgICAgIGxvY2FsIGN1cnRpbWUgPSBnbG9iYWxzLmN1cnRpbWUoKQogICAgICAgIGZvciBpPTAsICN0ZXh0IGRvCiAgICAgICAgICAgIGxvY2FsIGNvbG9yID0gc3RyaW5nLmZvcm1hdCgnJTAyeCUwMnglMDJ4JTAyeCcsIHIsIGcsIGIsIGEqbWF0aC5hYnMoMSptYXRoLmNvcygyKnNwZWVkKmN1cnRpbWUvNCtpKjUvMzApKSkKICAgICAgICAgICAgZmluYWxfdGV4dCA9IGZpbmFsX3RleHQuLidcYScuLmNvbG9yLi50ZXh0OnN1YihpLCBpKQogICAgICAgIGVuZAogICAgICAgIHJldHVybiBmaW5hbF90ZXh0CiAgICBlbmQsCiAgICBoaWRlX3NrZWV0X2FudGlhaW1fZGVmID0gZnVuY3Rpb24odmFsdWUpCiAgICAgICAgdmFsdWUgPSBub3QgdmFsdWUKICAgICAgICB1aS5zZXRfdmlzaWJsZShyZWZzLnJlZi5hYV9lbmFibGUsIHZhbHVlKSB1aS5zZXRfdmlzaWJsZShyZWZzLnJlZi5waXRjaCwgdmFsdWUpIHVpLnNldF92aXNpYmxlKHJlZnMucmVmLnBpdGNoX3ZhbHVlLCB2YWx1ZSkKICAgICAgICB1aS5zZXRfdmlzaWJsZShyZWZzLnJlZi55YXdfYmFzZSwgdmFsdWUpIHVpLnNldF92aXNpYmxlKHJlZnMucmVmLnlhdywgdmFsdWUpIHVpLnNldF92aXNpYmxlKHJlZnMucmVmLnlhd192YWx1ZSwgdmFsdWUpCiAgICAgICAgdWkuc2V0X3Zpc2libGUocmVmcy5yZWYueWF3X2ppdHRlciwgdmFsdWUpIHVpLnNldF92aXNpYmxlKHJlZnMucmVmLnlhd19qaXR0ZXJfdmFsdWUsIHZhbHVlKSB1aS5zZXRfdmlzaWJsZShyZWZzLnJlZi5ib2R5X3lhdywgdmFsdWUpCiAgICAgICAgdWkuc2V0X3Zpc2libGUocmVmcy5yZWYuYm9keV95YXdfdmFsdWUsIHZhbHVlKSB1aS5zZXRfdmlzaWJsZShyZWZzLnJlZi5lZGdleWF3LCB2YWx1ZSkgdWkuc2V0X3Zpc2libGUocmVmcy5yZWYuZnJlZXN0YW5kWzFdLCB2YWx1ZSkKICAgICAgICB1aS5zZXRfdmlzaWJsZShyZWZzLnJlZi5mcmVlc3RhbmRbMl0sIHZhbHVlKSB1aS5zZXRfdmlzaWJsZShyZWZzLnJlZi5yb2xsLCB2YWx1ZSkgdWkuc2V0X3Zpc2libGUocmVmcy5yZWYuZnJlZXN0YW5kX2JvZHlfeWF3LCB2YWx1ZSkKICAgIGVuZCwKICAgIGludGVyc2VjdCA9IGZ1bmN0aW9uKHgsIHksIHdpZHRoLCBoZWlnaHQpCiAgICAgICAgbG9jYWwgY3gsIGN5ID0gdWkubW91c2VfcG9zaXRpb24oKQogICAgICAgIHJldHVybiBjeCA+PSB4IGFuZCBjeCA8PSB4ICsgd2lkdGggYW5kIGN5ID49IHkgYW5kIGN5IDw9IHkgKyBoZWlnaHQKICAgIGVuZCwKICAgIGNvbnZlcnRVbml4VGltZSA9IGZ1bmN0aW9uKHVuaXhUaW1lKQogICAgICAgIGxvY2FsIGhvdXJzID0gbWF0aC5mbG9vcih1bml4VGltZSAvIDM2MDApICUgMjQKICAgICAgICBsb2NhbCBtaW51dGVzID0gbWF0aC5mbG9vcih1bml4VGltZSAvIDYwKSAlIDYwCiAgICAgICAgbG9jYWwgc2Vjb25kcyA9IHVuaXhUaW1lICUgNjAKICAgICAgICBsb2NhbCB0aW1lU3RyaW5nID0gc3RyaW5nLmZvcm1hdCgiJTAyZDolMDJkOiUwMmQiLCBob3VycywgbWludXRlcywgc2Vjb25kcykKICAgICAgICByZXR1cm4gdGltZVN0cmluZwogICAgZW5kLAogICAgbXVsdGljb2xvcl9jb25zb2xlID0gZnVuY3Rpb24oLi4uKQogICAgICAgIGxvY2FsIHRleHRzID0gey4uLn0KICAgICAgICBmb3IgaT0xLCAjdGV4dHMgZG8KICAgICAgICAgICAgbG9jYWwgdGV4dCA9IHRleHRzW2ldCiAgICAgICAgICAgIGNsaWVudC5jb2xvcl9sb2codGV4dFsxXSwgdGV4dFsyXSwgdGV4dFszXSwgaSB+PSAjdGV4dHMgYW5kICh0ZXh0WzRdIC4uICdcMCcpIG9yIHRleHRbNF0pCiAgICAgICAgZW5kCiAgICBlbmQsCiAgICBncmFkaWVudF90ZXh0ID0gZnVuY3Rpb24ocjEsIGcxLCBiMSwgYTEsIHIyLCBnMiwgYjIsIGEyLCB0ZXh0KQogICAgICAgIGxvY2FsIG91dHB1dCA9ICcnCiAgICAKICAgICAgICBsb2NhbCBsZW4gPSAjdGV4dC0xCiAgICAKICAgICAgICBsb2NhbCByaW5jID0gKHIyIC0gcjEpIC8gbGVuCiAgICAgICAgbG9jYWwgZ2luYyA9IChnMiAtIGcxKSAvIGxlbgogICAgICAgIGxvY2FsIGJpbmMgPSAoYjIgLSBiMSkgLyBsZW4KICAgICAgICBsb2NhbCBhaW5jID0gKGEyIC0gYTEpIC8gbGVuCiAgICAKICAgICAgICBmb3IgaT0xLCBsZW4rMSBkbwogICAgICAgICAgICBvdXRwdXQgPSBvdXRwdXQgLi4gKCdcYSUwMnglMDJ4JTAyeCUwMnglcycpOmZvcm1hdChyMSwgZzEsIGIxLCBhMSwgdGV4dDpzdWIoaSwgaSkpCiAgICAKICAgICAgICAgICAgcjEgPSByMSArIHJpbmMKICAgICAgICAgICAgZzEgPSBnMSArIGdpbmMKICAgICAgICAgICAgYjEgPSBiMSArIGJpbmMKICAgICAgICAgICAgYTEgPSBhMSArIGFpbmMKICAgICAgICBlbmQKICAgIAogICAgICAgIHJldHVybiBvdXRwdXQKICAgIGVuZAp9Cgpsb2NhbCB4LCBvID0gJ1x4MTRceDE0XHgxNFx4RkYnLCAnXHgwY1x4MGNceDBjXHhGRicKCmxvY2FsIHBhdHRlcm4gPSB0YWJsZS5jb25jYXR7CiAgICB4LHgsbyx4LAogICAgbyx4LG8seCwKICAgIG8seCx4LHgsCiAgICBvLHgsbyx4Cn0KCmxvY2FsIHRleF9pZCA9IHJlbmRlcmVyLmxvYWRfcmdiYShwYXR0ZXJuLCA0LCA0KQoKZnVuY3Rpb24gcmVuZGVyX29nc2tlZXRfYm9yZGVyKHgseSx3LGgsYSx0ZXh0KQogICAgcmVuZGVyZXIucmVjdGFuZ2xlKHggLSAxMCwgeSAtIDQ4ICx3ICsgMjAsIGggKyAxNiwxMiwxMiwxMixhKQogICAgcmVuZGVyZXIucmVjdGFuZ2xlKHggLSA5LCB5IC0gNDcgLHcgKyAxOCwgaCArIDE0LDYwLDYwLDYwLGEpCiAgICByZW5kZXJlci5yZWN0YW5nbGUoeCAtIDgsIHkgLSA0NiAsdyArIDE2LCBoICsgMTIsNDAsNDAsNDAsYSkKICAgIHJlbmRlcmVyLnJlY3RhbmdsZSh4IC0gNSwgeSAtIDQzICx3ICsgMTAsIGggKyA2LDYwLDYwLDYwLGEpCiAgICByZW5kZXJlci5yZWN0YW5nbGUoeCAtIDQsIHkgLSA0MiAsdyArIDgsIGggKyA0LDEyLDEyLDEyLGEpCiAgICByZW5kZXJlci50ZXh0dXJlKHRleF9pZCwgeCAtIDQsIHkgLSA0MiwgdyArIDgsIGggKyA0LCAyNTUsIDI1NSwgMjU1LCBhLCAiciIpCiAgICByZW5kZXJlci5ncmFkaWVudCh4IC0gNCx5IC0gNDIsIHcgLzIsIDEsIDU5LCAxNzUsIDIyMiwgYSwgMjAyLCA3MCwgMjA1LCBhLHRydWUpICAgICAgICAgICAgICAgCiAgICByZW5kZXJlci5ncmFkaWVudCh4IC0gNCArIHcgLyAyICx5IC0gNDIsIHcgLzIgKyA4LjUsIDEsMjAyLCA3MCwgMjA1LCBhLDIwNCwgMjI3LCA1MywgYSx0cnVlKQogICAgcmVuZGVyZXIudGV4dCh4LCB5IC0gNDAsIDI1NSwyNTUsMjU1LGEsICIiLCBuaWwsIHRleHQpCmVuZAoKbG9jYWwgY2ZnX2RhdGEgPSB7fQpjZmdfZGF0YS5kYXRhYmFzZSA9IHsKICAgIGNvbmZpZ3MgPSAiOmludGVyaXR1c19jZmdfYmVzdGU6Igp9CmNmZ19kYXRhLnByZXNldHMgPSB7CiAgICB7bmFtZSA9ICJEZWZhdWx0IiwgY29uZmlnID0gIlczc2laVzVoWW14bElqcDBjblZsTENKNVlYZGZZbUZ6WlNJNklrRjBJSFJoY21kbGRITWlMQ0p6ZEdGMFpTSTZJa3AxYlhBaWZTeDdJbVZ1WVdKc1pTSTZkSEoxWlN3aWMzUmhkR1VpT2lKS2RXMXdJbjBzZXlKU2RXNGlPbnNpWlc1aFlteGxJanBtWVd4elpTd2ljR2wwWTJnaU9pSlNZVzVrYjIwaUxDSm1iM0pqWlNJNmRISjFaU3dpYlc5a1pTSTZJa0ZzZDJGNWN5QnZiaUlzSW1OMWMzUnZiVjl3YVhSamFDSTZNQ3dpZVdGM1gycHBkSFJsY2w5emJHbGtaWElpT2pBc0lubGhkeUk2SWxOcFpHVjNZWGx6SWl3aWVXRjNYMnBwZEhSbGNpSTZJbEpoYm1SdmJTSXNJbmxoZDE5c1pXWjBJam90TWpFc0lubGhkMTl5YVdkb2RDSTZNakVzSW5saGQxOXpiR2xrWlhJaU9qRjlMQ0pFZFdOckxXcDFiWEFpT25zaVpXNWhZbXhsSWpwMGNuVmxMQ0p3YVhSamFDSTZJbHBsY204aUxDSm1iM0pqWlNJNlptRnNjMlVzSW0xdlpHVWlPaUpKYm5aaGJHbGtJSFJwWTJ0eklpd2lZM1Z6ZEc5dFgzQnBkR05vSWpvd0xDSjVZWGRmYW1sMGRHVnlYM05zYVdSbGNpSTZMVFF6TENKNVlYY2lPaUpUY0dsdUlpd2llV0YzWDJwcGRIUmxjaUk2SWxKaGJtUnZiU0lzSW5saGQxOXNaV1owSWpvdE1qRXNJbmxoZDE5eWFXZG9kQ0k2TWpFc0lubGhkMTl6Ykdsa1pYSWlPamN3ZlN3aVJIVmpheUk2ZXlKbGJtRmliR1VpT25SeWRXVXNJbkJwZEdOb0lqb2lVbUZ1Wkc5dElpd2labTl5WTJVaU9uUnlkV1VzSW0xdlpHVWlPaUpCYkhkaGVYTWdiMjRpTENKamRYTjBiMjFmY0dsMFkyZ2lPakFzSW5saGQxOXFhWFIwWlhKZmMyeHBaR1Z5SWpvd0xDSjVZWGNpT2lKVGFXUmxkMkY1Y3lJc0lubGhkMTlxYVhSMFpYSWlPaUpTWVc1a2IyMGlMQ0o1WVhkZmJHVm1kQ0k2TFRJeExDSjVZWGRmY21sbmFIUWlPakl4TENKNVlYZGZjMnhwWkdWeUlqb3hmU3dpVTNSaGJtUWlPbnNpWlc1aFlteGxJanBtWVd4elpTd2ljR2wwWTJnaU9pSlNZVzVrYjIwaUxDSm1iM0pqWlNJNmRISjFaU3dpYlc5a1pTSTZJa0ZzZDJGNWN5QnZiaUlzSW1OMWMzUnZiVjl3YVhSamFDSTZNQ3dpZVdGM1gycHBkSFJsY2w5emJHbGtaWElpT2pBc0lubGhkeUk2SWxOcFpHVjNZWGx6SWl3aWVXRjNYMnBwZEhSbGNpSTZJbEpoYm1SdmJTSXNJbmxoZDE5c1pXWjBJam90TWpFc0lubGhkMTl5YVdkb2RDSTZNakVzSW5saGQxOXpiR2xrWlhJaU9qRjlMQ0pLZFcxd0lqcDdJbVZ1WVdKc1pTSTZkSEoxWlN3aWNHbDBZMmdpT2lKSmJuUmxjbWwwZFhNaUxDSm1iM0pqWlNJNlptRnNjMlVzSW0xdlpHVWlPaUpKYm5aaGJHbGtJSFJwWTJ0eklpd2lZM1Z6ZEc5dFgzQnBkR05vSWpvd0xDSjVZWGRmYW1sMGRHVnlYM05zYVdSbGNpSTZNQ3dpZVdGM0lqb2lVM0JwYmlJc0lubGhkMTlxYVhSMFpYSWlPaUpQWm1ZaUxDSjVZWGRmYkdWbWRDSTZMVEl4TENKNVlYZGZjbWxuYUhRaU9qSXhMQ0o1WVhkZmMyeHBaR1Z5SWpvM01IMHNJbE5zYjNkM1lXeHJJanA3SW1WdVlXSnNaU0k2ZEhKMVpTd2ljR2wwWTJnaU9pSlNZVzVrYjIwaUxDSm1iM0pqWlNJNmRISjFaU3dpYlc5a1pTSTZJa0ZzZDJGNWN5QnZiaUlzSW1OMWMzUnZiVjl3YVhSamFDSTZNQ3dpZVdGM1gycHBkSFJsY2w5emJHbGtaWElpT2pBc0lubGhkeUk2SWxOcFpHVjNZWGx6SWl3aWVXRjNYMnBwZEhSbGNpSTZJbEpoYm1SdmJTSXNJbmxoZDE5c1pXWjBJam90TWpFc0lubGhkMTl5YVdkb2RDSTZNakVzSW5saGQxOXpiR2xrWlhJaU9qRjlMQ0pFZFdOckxXMXZkbVVpT25zaVpXNWhZbXhsSWpwMGNuVmxMQ0p3YVhSamFDSTZJbEpoYm1SdmJTSXNJbVp2Y21ObElqcDBjblZsTENKdGIyUmxJam9pUVd4M1lYbHpJRzl1SWl3aVkzVnpkRzl0WDNCcGRHTm9Jam93TENKNVlYZGZhbWwwZEdWeVgzTnNhV1JsY2lJNk1Dd2llV0YzSWpvaVUybGtaWGRoZVhNaUxDSjVZWGRmYW1sMGRHVnlJam9pVW1GdVpHOXRJaXdpZVdGM1gyeGxablFpT2kweU1Td2llV0YzWDNKcFoyaDBJam95TVN3aWVXRjNYM05zYVdSbGNpSTZNWDE5TEhzaVJIVmpheUk2ZXlKbGJtRmliR1VpT25SeWRXVXNJbmxoZDE5MGVYQmxJam9pVENBbUlGSWlMQ0p3YVhSamFDSTZJa1J2ZDI0aUxDSjVZWGRmYzJ4cFpHVnlYM04wWVhScFl5STZNQ3dpWW05a2VWOTVZWGNpT2lKS2FYUjBaWElpTENKaWIyUjVYM2xoZDE5emJHbGtaWElpT2pBc0lubGhkeUk2SWpFNE1DSXNJbU4xYzNSdmJWOXdhWFJqYUNJNk1Dd2llV0YzWDNOc2FXUmxjbDl5SWpveU1Td2llV0YzWDJwcGRIUmxjbDl6Ykdsa1pYSmZiQ0k2TFRJeExDSjVZWGRmYzJ4cFpHVnlYMlJsYkdGNUlqb3dMQ0o1WVhkZmFtbDBkR1Z5WDIxdlpHVWlPaUpUZEdGMGFXTWlMQ0o1WVhkZmFtbDBkR1Z5SWpvaVVtRnVaRzl0SWl3aWVXRjNYMnBwZEhSbGNsOXpiR2xrWlhKZmMzUmhkR2xqSWpvd0xDSjVZWGRmYW1sMGRHVnlYM05zYVdSbGNsOXlJam95TVN3aWVXRjNYM05zYVdSbGNsOXNJam90TWpGOUxDSkVkV05yTFcxdmRtVWlPbnNpWlc1aFlteGxJanAwY25WbExDSjVZWGRmZEhsd1pTSTZJa3dnSmlCU0lpd2ljR2wwWTJnaU9pSkViM2R1SWl3aWVXRjNYM05zYVdSbGNsOXpkR0YwYVdNaU9qQXNJbUp2WkhsZmVXRjNJam9pU21sMGRHVnlJaXdpWW05a2VWOTVZWGRmYzJ4cFpHVnlJam93TENKNVlYY2lPaUl4T0RBaUxDSmpkWE4wYjIxZmNHbDBZMmdpT2pBc0lubGhkMTl6Ykdsa1pYSmZjaUk2TWpFc0lubGhkMTlxYVhSMFpYSmZjMnhwWkdWeVgyd2lPaTB5TVN3aWVXRjNYM05zYVdSbGNsOWtaV3hoZVNJNk1Dd2llV0YzWDJwcGRIUmxjbDl0YjJSbElqb2lVM1JoZEdsaklpd2llV0YzWDJwcGRIUmxjaUk2SWxKaGJtUnZiU0lzSW5saGQxOXFhWFIwWlhKZmMyeHBaR1Z5WDNOMFlYUnBZeUk2TUN3aWVXRjNYMnBwZEhSbGNsOXpiR2xrWlhKZmNpSTZNakVzSW5saGQxOXpiR2xrWlhKZmJDSTZMVEl4ZlN3aVVuVnVJanA3SW1WdVlXSnNaU0k2ZEhKMVpTd2llV0YzWDNSNWNHVWlPaUpNSUNZZ1VpSXNJbkJwZEdOb0lqb2lSRzkzYmlJc0lubGhkMTl6Ykdsa1pYSmZjM1JoZEdsaklqb3dMQ0ppYjJSNVgzbGhkeUk2SWtwcGRIUmxjaUlzSW1KdlpIbGZlV0YzWDNOc2FXUmxjaUk2TUN3aWVXRjNJam9pTVRnd0lpd2lZM1Z6ZEc5dFgzQnBkR05vSWpvd0xDSjVZWGRmYzJ4cFpHVnlYM0lpT2pJeExDSjVZWGRmYW1sMGRHVnlYM05zYVdSbGNsOXNJam90TWpFc0lubGhkMTl6Ykdsa1pYSmZaR1ZzWVhraU9qQXNJbmxoZDE5cWFYUjBaWEpmYlc5a1pTSTZJbE4wWVhScFl5SXNJbmxoZDE5cWFYUjBaWElpT2lKU1lXNWtiMjBpTENKNVlYZGZhbWwwZEdWeVgzTnNhV1JsY2w5emRHRjBhV01pT2pBc0lubGhkMTlxYVhSMFpYSmZjMnhwWkdWeVgzSWlPakl4TENKNVlYZGZjMnhwWkdWeVgyd2lPaTB5TVgwc0lrZHNiMkpoYkNJNmV5SmxibUZpYkdVaU9uUnlkV1VzSW5saGQxOTBlWEJsSWpvaVRDQW1JRklpTENKd2FYUmphQ0k2SWtSdmQyNGlMQ0o1WVhkZmMyeHBaR1Z5WDNOMFlYUnBZeUk2TUN3aVltOWtlVjk1WVhjaU9pSkthWFIwWlhJaUxDSmliMlI1WDNsaGQxOXpiR2xrWlhJaU9qQXNJbmxoZHlJNklqRTRNQ0lzSW1OMWMzUnZiVjl3YVhSamFDSTZNQ3dpZVdGM1gzTnNhV1JsY2w5eUlqb3lNU3dpZVdGM1gycHBkSFJsY2w5emJHbGtaWEpmYkNJNkxUSXhMQ0o1WVhkZmMyeHBaR1Z5WDJSbGJHRjVJam93TENKNVlYZGZhbWwwZEdWeVgyMXZaR1VpT2lKVGRHRjBhV01pTENKNVlYZGZhbWwwZEdWeUlqb2lVbUZ1Wkc5dElpd2llV0YzWDJwcGRIUmxjbDl6Ykdsa1pYSmZjM1JoZEdsaklqb3dMQ0o1WVhkZmFtbDBkR1Z5WDNOc2FXUmxjbDl5SWpveU1Td2llV0YzWDNOc2FXUmxjbDlzSWpvdE1qRjlMQ0pUZEdGdVpDSTZleUpsYm1GaWJHVWlPblJ5ZFdVc0lubGhkMTkwZVhCbElqb2lUQ0FtSUZJaUxDSndhWFJqYUNJNklrUnZkMjRpTENKNVlYZGZjMnhwWkdWeVgzTjBZWFJwWXlJNk1Dd2lZbTlrZVY5NVlYY2lPaUpLYVhSMFpYSWlMQ0ppYjJSNVgzbGhkMTl6Ykdsa1pYSWlPakFzSW5saGR5STZJakU0TUNJc0ltTjFjM1J2YlY5d2FYUmphQ0k2TUN3aWVXRjNYM05zYVdSbGNsOXlJam95TVN3aWVXRjNYMnBwZEhSbGNsOXpiR2xrWlhKZmJDSTZMVEl4TENKNVlYZGZjMnhwWkdWeVgyUmxiR0Y1SWpvd0xDSjVZWGRmYW1sMGRHVnlYMjF2WkdVaU9pSlRkR0YwYVdNaUxDSjVZWGRmYW1sMGRHVnlJam9pVW1GdVpHOXRJaXdpZVdGM1gycHBkSFJsY2w5emJHbGtaWEpmYzNSaGRHbGpJam93TENKNVlYZGZhbWwwZEdWeVgzTnNhV1JsY2w5eUlqb3lNU3dpZVdGM1gzTnNhV1JsY2w5c0lqb3RNakY5TENKR1lXdGxiR0ZuSWpwN0ltVnVZV0pzWlNJNlptRnNjMlVzSW5saGQxOTBlWEJsSWpvaVRDQW1JRklpTENKd2FYUmphQ0k2SWtSdmQyNGlMQ0o1WVhkZmMyeHBaR1Z5WDNOMFlYUnBZeUk2TUN3aVltOWtlVjk1WVhjaU9pSkthWFIwWlhJaUxDSmliMlI1WDNsaGQxOXpiR2xrWlhJaU9qQXNJbmxoZHlJNklqRTRNQ0lzSW1OMWMzUnZiVjl3YVhSamFDSTZNQ3dpZVdGM1gzTnNhV1JsY2w5eUlqb3lNU3dpZVdGM1gycHBkSFJsY2w5emJHbGtaWEpmYkNJNkxUSXhMQ0o1WVhkZmMyeHBaR1Z5WDJSbGJHRjVJam93TENKNVlYZGZhbWwwZEdWeVgyMXZaR1VpT2lKVGRHRjBhV01pTENKNVlYZGZhbWwwZEdWeUlqb2lVbUZ1Wkc5dElpd2llV0YzWDJwcGRIUmxjbDl6Ykdsa1pYSmZjM1JoZEdsaklqb3dMQ0o1WVhkZmFtbDBkR1Z5WDNOc2FXUmxjbDl5SWpveU1Td2llV0YzWDNOc2FXUmxjbDlzSWpvdE1qRjlMQ0pLZFcxd0lqcDdJbVZ1WVdKc1pTSTZkSEoxWlN3aWVXRjNYM1I1Y0dVaU9pSk1JQ1lnVWlJc0luQnBkR05vSWpvaVJHOTNiaUlzSW5saGQxOXpiR2xrWlhKZmMzUmhkR2xqSWpvd0xDSmliMlI1WDNsaGR5STZJa3BwZEhSbGNpSXNJbUp2WkhsZmVXRjNYM05zYVdSbGNpSTZNQ3dpZVdGM0lqb2lNVGd3SWl3aVkzVnpkRzl0WDNCcGRHTm9Jam93TENKNVlYZGZjMnhwWkdWeVgzSWlPakl4TENKNVlYZGZhbWwwZEdWeVgzTnNhV1JsY2w5c0lqb3RNakVzSW5saGQxOXpiR2xrWlhKZlpHVnNZWGtpT2pBc0lubGhkMTlxYVhSMFpYSmZiVzlrWlNJNklsTjBZWFJwWXlJc0lubGhkMTlxYVhSMFpYSWlPaUpTWVc1a2IyMGlMQ0o1WVhkZmFtbDBkR1Z5WDNOc2FXUmxjbDl6ZEdGMGFXTWlPakFzSW5saGQxOXFhWFIwWlhKZmMyeHBaR1Z5WDNJaU9qSXhMQ0o1WVhkZmMyeHBaR1Z5WDJ3aU9pMHlNWDBzSWxOc2IzZDNZV3hySWpwN0ltVnVZV0pzWlNJNmRISjFaU3dpZVdGM1gzUjVjR1VpT2lKTUlDWWdVaUlzSW5CcGRHTm9Jam9pUkc5M2JpSXNJbmxoZDE5emJHbGtaWEpmYzNSaGRHbGpJam93TENKaWIyUjVYM2xoZHlJNklrcHBkSFJsY2lJc0ltSnZaSGxmZVdGM1gzTnNhV1JsY2lJNk1Dd2llV0YzSWpvaU1UZ3dJaXdpWTNWemRHOXRYM0JwZEdOb0lqb3dMQ0o1WVhkZmMyeHBaR1Z5WDNJaU9qSXhMQ0o1WVhkZmFtbDBkR1Z5WDNOc2FXUmxjbDlzSWpvdE1qRXNJbmxoZDE5emJHbGtaWEpmWkdWc1lYa2lPakFzSW5saGQxOXFhWFIwWlhKZmJXOWtaU0k2SWxOMFlYUnBZeUlzSW5saGQxOXFhWFIwWlhJaU9pSlNZVzVrYjIwaUxDSjVZWGRmYW1sMGRHVnlYM05zYVdSbGNsOXpkR0YwYVdNaU9qQXNJbmxoZDE5cWFYUjBaWEpmYzJ4cFpHVnlYM0lpT2pJeExDSjVZWGRmYzJ4cFpHVnlYMndpT2kweU1YMHNJa1IxWTJzdGFuVnRjQ0k2ZXlKbGJtRmliR1VpT25SeWRXVXNJbmxoZDE5MGVYQmxJam9pVENBbUlGSWlMQ0p3YVhSamFDSTZJa1J2ZDI0aUxDSjVZWGRmYzJ4cFpHVnlYM04wWVhScFl5STZNQ3dpWW05a2VWOTVZWGNpT2lKS2FYUjBaWElpTENKaWIyUjVYM2xoZDE5emJHbGtaWElpT2pBc0lubGhkeUk2SWpFNE1DSXNJbU4xYzNSdmJWOXdhWFJqYUNJNk1Dd2llV0YzWDNOc2FXUmxjbDl5SWpveU1Td2llV0YzWDJwcGRIUmxjbDl6Ykdsa1pYSmZiQ0k2TFRJeExDSjVZWGRmYzJ4cFpHVnlYMlJsYkdGNUlqb3dMQ0o1WVhkZmFtbDBkR1Z5WDIxdlpHVWlPaUpUZEdGMGFXTWlMQ0o1WVhkZmFtbDBkR1Z5SWpvaVVtRnVaRzl0SWl3aWVXRjNYMnBwZEhSbGNsOXpiR2xrWlhKZmMzUmhkR2xqSWpvd0xDSjVZWGRmYW1sMGRHVnlYM05zYVdSbGNsOXlJam95TVN3aWVXRjNYM05zYVdSbGNsOXNJam90TWpGOWZTeDdJbVZ1WVdKc1pTSTZabUZzYzJVc0luSmxjMlYwYVdZaU9sc2lWR0Z5WjJWMElFUmxZWFJvSWl3aVVtVmhZMmhsWkNCVWFXMWxJRXhwYm1VaUxDSitJbDBzSW5Cb1lYTmxJam9pTXlJc0luTjBZWFJsSWpwYklsTjBZVzVrSWl3aVJIVmpheUlzSW40aVhYMHNXM3NpWW05a2VWOTVZWGNpT2pFeE15d2lhbWwwZEdWeUlqb3pMQ0psYm1GaWJHVmtJanAwY25WbGZTeDdJbUp2WkhsZmVXRjNJam94TVRNc0ltcHBkSFJsY2lJNk15d2laVzVoWW14bFpDSTZkSEoxWlgwc2V5SmliMlI1WDNsaGR5STZNVEV6TENKcWFYUjBaWElpT2pNc0ltVnVZV0pzWldRaU9uUnlkV1Y5TEhzaVltOWtlVjk1WVhjaU9qRXhNeXdpYW1sMGRHVnlJam96TENKbGJtRmliR1ZrSWpwbVlXeHpaWDBzZXlKaWIyUjVYM2xoZHlJNk1URXpMQ0pxYVhSMFpYSWlPak1zSW1WdVlXSnNaV1FpT21aaGJITmxmVjFkIn0KfQoKbG9jYWwgdWlfbWVudSA9IHsKICAgIHRhYnNfbmFtZXMgPSB7Iu6EpSIsIu6EtiIsIuKZuyIsIuKcqCIsIuKYsCIsIu6EsiJ9LAogICAgc2VsZWN0ZWRfdGFiID0gMSwKICAgIHNlbGVjdGVkX2NvbG9yID0geyB7MjAsIDIwLCAyMCwgMjU1fSwgezIxMCwyMTAsMjEwLDI1NX0gfSwKICAgIG1lbnVfYWxwaGEgPSAyNTUsCiAgICBpc19ob3ZlcmVkID0gZmFsc2UsCiAgICBkcGlfc2NhbGluZ195ID0ge3s4NCwxNDl9LHsxMDAsMTgxfSx7MTE2LDIxM30sezEzMiwyNDV9LHsxNDgsMjc2fX0sCiAgICBwZXNhZGVsb19uYV9jb3ppbmhhMiA9IHs1OTcsNzQxLDg4NSwxMDMwLDExNzMgfSwKICAgIHNlbGVjdGVkX2dzX3RhYiA9IGZhbHNlLAogICAgbW91c2VfcHJlc3MgPSBmYWxzZSwKICAgIG9sZF9tcG9zID0gezAsMH0KfQoKZnVuY3Rpb24gaXNfYWFfdGFiKCkKICAgIGxvY2FsIG1lbnVfc2l6ZSA9IHsgdWkubWVudV9zaXplKCkgfQogIAogICAgCiAgICBsb2NhbCBtZW51X3BvcyA9IHsgdWkubWVudV9wb3NpdGlvbigpIH0KICAgIGxvY2FsIG1vdXNlX3BvcyA9IHsgdWkubW91c2VfcG9zaXRpb24oKSB9CgogICBsb2NhbCBzY2FsZSA9IHswLDB9CiAgIGxvY2FsIHNjYWxlX3ggPSAwCiAgIGxvY2FsIHBlc2FkZWxvX25vX2RpcmVpdG8gPSAwCgogICAgaWYgdWkuZ2V0KHVpLnJlZmVyZW5jZSgiTUlTQyIsIlNldHRpbmdzIiwiRFBJIHNjYWxlIikpID09ICIxMDAlIiB0aGVuCiAgICAgICAgc2NhbGUgPSB7IHVpX21lbnUuZHBpX3NjYWxpbmdfeVsxXVsxXSx1aV9tZW51LmRwaV9zY2FsaW5nX3lbMV1bMl0gfQogICAgICAgIHNjYWxlX3ggPSA3NgogICAgICAgIHBlc2FkZWxvX25vX2RpcmVpdG8gPSB1aV9tZW51LnBlc2FkZWxvX25hX2NvemluaGEyWzFdCiAgICBlbHNlaWYgdWkuZ2V0KHVpLnJlZmVyZW5jZSgiTUlTQyIsIlNldHRpbmdzIiwiRFBJIHNjYWxlIikpICA9PSAiMTI1JSIgdGhlbgogICAgICAgIHNjYWxlID0geyB1aV9tZW51LmRwaV9zY2FsaW5nX3lbMl1bMV0sdWlfbWVudS5kcGlfc2NhbGluZ195WzJdWzJdIH0KICAgICAgICBzY2FsZV94ID0gOTUKICAgICAgICBwZXNhZGVsb19ub19kaXJlaXRvID0gdWlfbWVudS5wZXNhZGVsb19uYV9jb3ppbmhhMlsyXQogICAgZWxzZWlmIHVpLmdldCh1aS5yZWZlcmVuY2UoIk1JU0MiLCJTZXR0aW5ncyIsIkRQSSBzY2FsZSIpKSAgPT0gIjE1MCUiIHRoZW4KICAgICAgICBzY2FsZSA9IHsgdWlfbWVudS5kcGlfc2NhbGluZ195WzNdWzFdLHVpX21lbnUuZHBpX3NjYWxpbmdfeVszXVsyXSB9CiAgICAgICAgc2NhbGVfeCA9IDExMwogICAgICAgIHBlc2FkZWxvX25vX2RpcmVpdG8gPSB1aV9tZW51LnBlc2FkZWxvX25hX2NvemluaGEyWzNdCiAgICBlbHNlaWYgdWkuZ2V0KHVpLnJlZmVyZW5jZSgiTUlTQyIsIlNldHRpbmdzIiwiRFBJIHNjYWxlIikpICA9PSAiMTc1JSIgdGhlbgogICAgICAgIHNjYWxlID0geyB1aV9tZW51LmRwaV9zY2FsaW5nX3lbNF1bMV0sdWlfbWVudS5kcGlfc2NhbGluZ195WzRdWzJdIH0KICAgICAgICBzY2FsZV94ID0gMTMyCiAgICAgICAgcGVzYWRlbG9fbm9fZGlyZWl0byA9IHVpX21lbnUucGVzYWRlbG9fbmFfY296aW5oYTJbNF0KICAgIGVsc2VpZiB1aS5nZXQodWkucmVmZXJlbmNlKCJNSVNDIiwiU2V0dGluZ3MiLCJEUEkgc2NhbGUiKSkgID09ICIyMDAlIiB0aGVuCiAgICAgICAgc2NhbGUgPSB7IHVpX21lbnUuZHBpX3NjYWxpbmdfeVs1XVsxXSx1aV9tZW51LmRwaV9zY2FsaW5nX3lbNV1bMl0gfQogICAgICAgIHNjYWxlX3ggPSAxNTEKICAgICAgICBwZXNhZGVsb19ub19kaXJlaXRvID0gdWlfbWVudS5wZXNhZGVsb19uYV9jb3ppbmhhMls1XQogICAgZW5kCgogICAgaWYgdWlfbWVudS5tb3VzZV9wcmVzcyA9PSBmYWxzZSB0aGVuCiAgICAgICAgdWlfbWVudS5vbGRfbXBvcyA9IG1vdXNlX3BvcwogICAgZW5kICAgICAgCgogICAgaWYgY2xpZW50LmtleV9zdGF0ZSgweDEpIHRoZW4KICAgICAgICBpZiBub3QgdWlfbWVudS5tb3VzZV9wcmVzcyB0aGVuCiAgICAgICAgICAgIHVpX21lbnUubW91c2VfcHJlc3MgPSB0cnVlCiAgICAgICAgICAgIGlmIG1vdXNlX3Bvc1sxXSA+IG1lbnVfcG9zWzFdICsgNSBhbmQgbW91c2VfcG9zWzFdIDwgbWVudV9wb3NbMV0gKyA1ICsgc2NhbGVfeCB0aGVuCiAgICAgICAgICAgICAgICBpZiBtb3VzZV9wb3NbMl0gPiBtZW51X3Bvc1syXSArIHNjYWxlWzFdIGFuZCBtb3VzZV9wb3NbMl0gPCBtZW51X3Bvc1syXSArIHNjYWxlWzJdIHRoZW4KICAgICAgICAgICAgICAgICAgICB1aV9tZW51LnNlbGVjdGVkX2dzX3RhYiA9IHRydWUKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGVsc2VpZiBtb3VzZV9wb3NbMl0gPiBtZW51X3Bvc1syXSArIDE5IGFuZCAobWVudV9zaXplWzJdID49IHBlc2FkZWxvX25vX2RpcmVpdG8gYW5kIG1vdXNlX3Bvc1syXSA8IG1lbnVfcG9zWzJdICsgbWVudV9zaXplWzJdIG9yIG1vdXNlX3Bvc1syXSA8IG1lbnVfcG9zWzJdICsgcGVzYWRlbG9fbm9fZGlyZWl0bykgYW5kIHVpX21lbnUuc2VsZWN0ZWRfZ3NfdGFiID09IHRydWUgdGhlbgogICAgICAgICAgICAgICAgICAgIHVpX21lbnUuc2VsZWN0ZWRfZ3NfdGFiID0gZmFsc2UKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVsc2UKICAgICAgICB1aV9tZW51Lm1vdXNlX3ByZXNzID0gZmFsc2UKICAgIGVuZAplbmQKCgpmdW5jdGlvbiBuZXdfdGFiKCkKCiAgICB1aV9tZW51LmlzX2hvdmVyZWQgPSBmYWxzZQogICAgaWYgbm90IHVpLmlzX21lbnVfb3BlbigpICB0aGVuCiAgICAgICAgdWlfbWVudS5tZW51X2FscGhhID0gMAogICAgZWxzZQogICAgICAgIHVpX21lbnUubWVudV9hbHBoYSA9IDI1NQogICAgZW5kCgogICAgaWYgdWlfbWVudS5tZW51X2FscGhhIDwgMjU0IHRoZW4gcmV0dXJuIGVuZAoKICAgIGxvY2FsIG1lbnVfc2l6ZSA9IHsgdWkubWVudV9zaXplKCkgfQogICAgbG9jYWwgZGl2aWRlX21lbnUgPSAobWVudV9zaXplWzFdIC0gMTIpIC8gI3VpX21lbnUudGFic19uYW1lcwogICAgCiAgICBsb2NhbCBtZW51X3BvcyA9IHsgdWkubWVudV9wb3NpdGlvbigpIH0KICAgIGxvY2FsIG1vdXNlX3BvcyA9IHsgdWkubW91c2VfcG9zaXRpb24oKSB9CgogICAgaWYgbm90IHVpX21lbnUuc2VsZWN0ZWRfZ3NfdGFiIHRoZW4gcmV0dXJuIGVuZAoKICAgIGZvciBrLHYgaW4gaXBhaXJzKHVpX21lbnUudGFic19uYW1lcykgZG8KCiAgICAgICAgaWYgdWlfbWVudS5zZWxlY3RlZF90YWIgPT0gayB0aGVuCiAgICAgICAgICAgIHVpX21lbnUuc2VsZWN0ZWRfY29sb3JbMV0gPSB7MjAsIDIwLCAyMH0KICAgICAgICAgICAgdWlfbWVudS5zZWxlY3RlZF9jb2xvclsyXSA9IHsyMTAsIDIxMCwgMjEwfQogICAgICAgIGVsc2UKICAgICAgICAgICAgdWlfbWVudS5zZWxlY3RlZF9jb2xvclsxXSA9IHsxMiwgMTIsIDEyfQogICAgICAgICAgICB1aV9tZW51LnNlbGVjdGVkX2NvbG9yWzJdID0gezkwLCA5MCwgOTB9CiAgICAgICAgZW5kCiAgICAgICAKICAgICAgICByZW5kZXJlci50ZXh0KG1lbnVfcG9zWzFdICsgKGRpdmlkZV9tZW51ICogaykgLSBkaXZpZGVfbWVudSAvIDIgLG1lbnVfcG9zWzJdIC0gMjUsdWlfbWVudS5zZWxlY3RlZF9jb2xvclsyXVsxXSwgdWlfbWVudS5zZWxlY3RlZF9jb2xvclsyXVsyXSwgdWlfbWVudS5zZWxlY3RlZF9jb2xvclsyXVszXSx1aV9tZW51Lm1lbnVfYWxwaGEsImNkKyIsMCx2KQoKICAgICAgICBpZiBtb3VzZV9wb3NbMV0gPiBtZW51X3Bvc1sxXSArIChkaXZpZGVfbWVudSAqIGspIC0gIGRpdmlkZV9tZW51IGFuZCBtb3VzZV9wb3NbMV0gPCBtZW51X3Bvc1sxXSArIChkaXZpZGVfbWVudSAqIGspIGFuZCBtb3VzZV9wb3NbMl0gPiBtZW51X3Bvc1syXSAtIDUwIGFuZCBtb3VzZV9wb3NbMl0gPCBtZW51X3Bvc1syXSB0aGVuCiAgICAgICAgICAgIHVpX21lbnUuaXNfaG92ZXJlZCA9IHRydWUKICAgICAgICAgICAgaWYgIGNsaWVudC5rZXlfc3RhdGUoMHgxKSB0aGVuCiAgICAgICAgICAgICAgICB1aV9tZW51LnNlbGVjdGVkX3RhYiA9IGsKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKICAgIHJlbmRlcmVyLnRleHQobWVudV9wb3NbMV0gKyAoZGl2aWRlX21lbnUgKiB1aV9tZW51LnNlbGVjdGVkX3RhYikgLSBkaXZpZGVfbWVudSAvIDIgLG1lbnVfcG9zWzJdIC0gMjUsMjEwLCAyMTAsIDIxMCx1aV9tZW51Lm1lbnVfYWxwaGEsImNkKyIsMCx1aV9tZW51LnRhYnNfbmFtZXNbdWlfbWVudS5zZWxlY3RlZF90YWJdKQplbmQKCmZ1bmN0aW9uIHJlbmRlcl90YWJzKCkgCiAgICBpZiBub3QgdWlfbWVudS5zZWxlY3RlZF9nc190YWIgdGhlbiByZXR1cm4gZW5kCgogICAgaWYgdWlfbWVudS5tZW51X2FscGhhIDwgMjU0IHRoZW4gcmV0dXJuIGVuZAoKICAgIGxvY2FsIG1lbnVfcyA9IHsgdWkubWVudV9zaXplKCkgfQogICAgbG9jYWwgbWVudV9wID0geyB1aS5tZW51X3Bvc2l0aW9uKCkgfQoKICAgIGxvY2FsIGRpdmlkZV9tZW51ID0gKG1lbnVfc1sxXSAtIDEyKSAvICN1aV9tZW51LnRhYnNfbmFtZXMKICAgIAoKICAgIHJlbmRlcmVyLnRleHR1cmUodGV4X2lkLCBtZW51X3BbMV0gKyAxLCBtZW51X3BbMl0tNDksIG1lbnVfc1sxXSAtIDIsIDUwLCAyNTUsIDI1NSwgMjU1LCB1aV9tZW51Lm1lbnVfYWxwaGEsICJyIikKCiAgICByZW5kZXJlci5yZWN0YW5nbGUobWVudV9wWzFdICsgKGRpdmlkZV9tZW51ICogdWlfbWVudS5zZWxlY3RlZF90YWIpIC0gZGl2aWRlX21lbnUgKyA0LCBtZW51X3BbMl0gLSA0NCxkaXZpZGVfbWVudSAtMSw0NCwxMSwxMSwxMSx1aV9tZW51Lm1lbnVfYWxwaGEpIAogICAgCiAgICAtLXRvcCBiYXIKICAgIHJlbmRlcmVyLnJlY3RhbmdsZShtZW51X3BbMV0gLG1lbnVfcFsyXSAtIDUzLG1lbnVfc1sxXSAsMSAsMTIsMTIsMTIsdWlfbWVudS5tZW51X2FscGhhKSAKICAgIHJlbmRlcmVyLnJlY3RhbmdsZShtZW51X3BbMV0gKyAyLG1lbnVfcFsyXSAtIDUyLG1lbnVfc1sxXSAtIDQsNSAsNjAsNjAsNjAsdWlfbWVudS5tZW51X2FscGhhKSAKICAgIHJlbmRlcmVyLnJlY3RhbmdsZShtZW51X3BbMV0gKyAyLG1lbnVfcFsyXSAtIDUxLG1lbnVfc1sxXSAtIDQsMyAsNDAsNDAsNDAsdWlfbWVudS5tZW51X2FscGhhKSAKICAgIAogICAgLS1sZWZ0IGJhcgogICAgcmVuZGVyZXIucmVjdGFuZ2xlKG1lbnVfcFsxXSAsbWVudV9wWzJdIC0gNTMsMSw1MyAsMTIsMTIsMTIsdWlfbWVudS5tZW51X2FscGhhKSAKICAgIHJlbmRlcmVyLnJlY3RhbmdsZShtZW51X3BbMV0gKyAxLG1lbnVfcFsyXSAtIDUyLDQsNTIgLDYwLDYwLDYwLHVpX21lbnUubWVudV9hbHBoYSkgCiAgICByZW5kZXJlci5yZWN0YW5nbGUobWVudV9wWzFdICsgMixtZW51X3BbMl0gLSA1MSwzLDUxICw0MCw0MCw0MCx1aV9tZW51Lm1lbnVfYWxwaGEpIAogICAgcmVuZGVyZXIucmVjdGFuZ2xlKG1lbnVfcFsxXSArIDUsbWVudV9wWzJdIC0gNDgsMSw0OCAsNjAsNjAsNjAsdWlfbWVudS5tZW51X2FscGhhKQogICAgCiAgICAtLXJpZ2h0IGJhcgogICAgcmVuZGVyZXIucmVjdGFuZ2xlKG1lbnVfcFsxXSArIG1lbnVfc1sxXSAtIDEsbWVudV9wWzJdIC0gNTMsMSw1MyAsMTIsMTIsMTIsdWlfbWVudS5tZW51X2FscGhhKSAKICAgIHJlbmRlcmVyLnJlY3RhbmdsZShtZW51X3BbMV0gKyBtZW51X3NbMV0gLSAzLG1lbnVfcFsyXSAtIDUyLDIsNTIgLDYwLDYwLDYwLHVpX21lbnUubWVudV9hbHBoYSkgCiAgICByZW5kZXJlci5yZWN0YW5nbGUobWVudV9wWzFdICsgbWVudV9zWzFdIC0gNSxtZW51X3BbMl0gLSA1MSwzLDUxICw0MCw0MCw0MCx1aV9tZW51Lm1lbnVfYWxwaGEpCiAgICByZW5kZXJlci5yZWN0YW5nbGUobWVudV9wWzFdICsgbWVudV9zWzFdIC0gNixtZW51X3BbMl0gLSA0OCwxLDQ4ICw2MCw2MCw2MCx1aV9tZW51Lm1lbnVfYWxwaGEpIAoKICAgIHJlbmRlcmVyLmdyYWRpZW50KG1lbnVfcFsxXSArIDcsbWVudV9wWzJdIC0gNDYsIG1lbnVfc1sxXS8yLDEsIDU5LCAxNzUsIDIyMiwgdWlfbWVudS5tZW51X2FscGhhLCAyMDIsIDcwLCAyMDUsIHVpX21lbnUubWVudV9hbHBoYSx0cnVlKQogICAgICAgICAgICAgICAgCiAgICByZW5kZXJlci5ncmFkaWVudChtZW51X3BbMV0gKyA3ICsgbWVudV9zWzFdLzIgLG1lbnVfcFsyXSAtIDQ2LCBtZW51X3NbMV0vMiAtIDEzLjMsIDEsMjAzLCA3MCwgMjA1LCB1aV9tZW51Lm1lbnVfYWxwaGEsMjA0LCAyMjcsIDUzLCB1aV9tZW51Lm1lbnVfYWxwaGEsdHJ1ZSkKZW5kCgpsb2NhbCBhYV90YWJsZSA9IHsKICAgIHN0YXRlcyA9IHsiR2xvYmFsIiwgIlN0YW5kIiwgIlJ1biIsICJEdWNrIiwgIkR1Y2stbW92ZSIsICJKdW1wIiwgIkR1Y2stanVtcCIsICJTbG93d2FsayIsICJGYWtlbGFnIn0sCiAgICBkZWZlbnNpdmVfc3RhdGVzID0geyJTdGFuZCIsICJSdW4iLCAiRHVjayIsICJEdWNrLW1vdmUiLCAiSnVtcCIsICJEdWNrLWp1bXAiLCAiU2xvd3dhbGsifSwKICAgIGFudGlfYmZfc3RhdGVzID0geyJTdGFuZCIsICJSdW4iLCAiRHVjayIsICJEdWNrLW1vdmUiLCAiSnVtcCIsICJEdWNrLWp1bXAiLCAiU2xvd3dhbGsifSwKICAgIHBpdGNoID0geydPZmYnLCdEZWZhdWx0JywnVXAnLCAnRG93bicsICdNaW5pbWFsJywgJ1JhbmRvbScsICdDdXN0b20nfSwKICAgIHlhdyA9IHsnT2ZmJywgJzE4MCcsICdTcGluJywgJ1N0YXRpYycsICcxODAgWicsICdDcm9zc2hhaXInfSwKICAgIHlhd19iYXNlID0geyJMb2NhbCB2aWV3IiwgIkF0IHRhcmdldHMifQp9Cgpsb2NhbCBhbnRpX2JmX3RhYmxlID0gewogICAgbWF4X3BoYXNlID0gNSwKICAgIHBoYXNlX3RvX3N0cmluZyA9IHsiMSIsICIyIiwgIjMiLCAiNCIsICI1In0sCiAgICBlbnRpdHkgPSBlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpLAogICAgZW50aXR5XzIgPSBuaWwsCiAgICByZWNvcmRlZF9lbnQgPSBuaWwsCiAgICBtaXNzX2NvdW50ZXIgPSAwLAogICAgdGltZXJfYnJ1dGUgPSAwLAogICAgZW50aXR5X2NoYW5nZWQgPSBmYWxzZQp9Cgpsb2NhbCBfdWkgPSB7CiAgICBsdWEgPSB7CiAgICAgICAgZW5hYmxlX2x1YSA9IGdyb3VwOmNoZWNrYm94KCJcdkludGVccnJpdHVzIi4uIiB8IFx2Ii4uIGV1cGhlbWlhLnVzZXJuYW1lKSwKICAgICAgICB0ZXh0X2J1aWxkID0gZ3JvdXA6bGFiZWwoIkJ1aWxkIH4gXHYiLi5ldXBoZW1pYS5idWlsZCksCiAgICAgICAgdGFiID0gZ3JvdXA6Y29tYm9ib3goIlxuICIsICJBbnRpLWFpbSIsICJEZWZlbnNpdmUiLCAiQW50aS1CcnV0ZWZvcmNlIiwgIlZpc3VhbHMiLCAiTWlzY2VsbGFuZW91cyIsICJDb25maWciKSwgICAgCiAgICB9LAoKICAgIGtleWJpbmRzID0gewogICAgICAgIGZyZWVzdGFuZGluZyA9IGdyb3VwX290aGVyOmhvdGtleSgiRnJlZXN0YW5kaW5nIiksCiAgICAgICAgbWFudWFsX2xlZnQgPSBncm91cF9vdGhlcjpob3RrZXkoIk1hbnVhbCBsZWZ0IiksCiAgICAgICAgbWFudWFsX3JpZ2h0ID0gZ3JvdXBfb3RoZXI6aG90a2V5KCJNYW51YWwgcmlnaHQiKSwKICAgICAgICBtYW51YWxfZm9yd2FyZCA9IGdyb3VwX290aGVyOmhvdGtleSgiTWFudWFsIGZvcndhcmQiKSwKICAgICAgICBmcmVlc3RhbmRpbmdfZGlzYWJsZXJzID0gZ3JvdXBfb3RoZXI6bXVsdGlzZWxlY3QoIkZyZWVzdGFuZGluZyBkaXNhYmxlcnMiLCBhYV90YWJsZS5zdGF0ZXMpLAogICAgICAgIHR3ZWFrcyA9IGdyb3VwX290aGVyOm11bHRpc2VsZWN0KCJUd2Vha3MiLCAiQW50aS1iYWNrc3RhYiIsICJTYWZlIGhlYWQiLCAiRS1TcGFtIikKICAgIH0sCgogICAgYW50aWFpbSA9IHsKICAgICAgICBlbmFibGUgPSBncm91cDpjaGVja2JveCgiRW5hYmxlIH4gXHZCdWlsZGVyIiksCiAgICAgICAgeWF3X2Jhc2UgPSBncm91cDpjb21ib2JveCgiWWF3IGJhc2UiLCBhYV90YWJsZS55YXdfYmFzZSksCiAgICAgICAgc3RhdGUgPSBncm91cDpjb21ib2JveCgiU3RhdGUiLCBhYV90YWJsZS5zdGF0ZXMpCiAgICB9LAoKICAgIGRlZmVuc2l2ZSA9IHsKICAgICAgICBlbmFibGUgPSBncm91cDpjaGVja2JveCgiRW5hYmxlIH4gXHZEZWZlbnNpdmUiKSwKICAgICAgICBzdGF0ZSA9IGdyb3VwOmNvbWJvYm94KCJTdGF0ZSIsIGFhX3RhYmxlLmRlZmVuc2l2ZV9zdGF0ZXMpCiAgICB9LAoKICAgIGFudGlfYmYgPSB7CiAgICAgICAgZW5hYmxlID0gZ3JvdXA6Y2hlY2tib3goIkVuYWJsZSB+IFx2QW50aS1CcnV0ZWZvcmNlIiksCiAgICAgICAgcmVzZXRpZiA9IGdyb3VwOm11bHRpc2VsZWN0KCJSZXNldCB3aGVuIiwgeyJUYXJnZXQgRGVhdGgiLCAiUmVhY2hlZCBUaW1lIExpbmUifSksCiAgICAgICAgc3RhdGUgPSBncm91cDptdWx0aXNlbGVjdCgiU3RhdGUiLCBhYV90YWJsZS5hbnRpX2JmX3N0YXRlcyksCiAgICAgICAgcGhhc2UgPSBncm91cDpjb21ib2JveCgiUGhhc2UiLCBhbnRpX2JmX3RhYmxlLnBoYXNlX3RvX3N0cmluZykKICAgIH0sCgogICAgdmlzdWFscyA9IHsKICAgICAgICBlbmFibGUgPSBncm91cDpjaGVja2JveCgiRW5hYmxlIH4gXHZWaXN1YWxzIiwgezI1NSwgMTE1LCAxMDUsIDI1NX0pLAogICAgICAgIGhpdGxvZ3MgPSBncm91cDptdWx0aXNlbGVjdCgiSGl0bG9ncyIsIHsiSGl0IiwgIk1pc3MiLCAiTmFkZWQiLCAiRmlyZWQifSksCiAgICAgICAgbm90aWZ5X3N0eWxlID0gZ3JvdXA6Y29tYm9ib3goIk5vdGlmaWNhdGlvbiBzdHlsZSIsIHsiRGVmYXVsdCIsICJNb2Rlcm4iLCAiT0cifSksCiAgICAgICAgaW5kc19zdHlsZSA9IGdyb3VwOmNvbWJvYm94KCJJbmRpY2F0b3JzIiwgeyJPZmYiLCAiUGl4ZWwiLCAiTWluaW1hbCIsICJNb2Rlcm4ifSksCiAgICAgICAgaW5kc19vcHRpb25zID0gZ3JvdXA6bXVsdGlzZWxlY3QoIkluZGljYXRvcnMgbW9kaWZpY2F0aW9uIiwgeyJJbiBzY29wZSIsICJBbmltYXRlZCIsICJBbHBoYSJ9KSwKICAgICAgICB3YXRlcm1hcmtzID0gZ3JvdXA6Y29tYm9ib3goIldhdGVybWFyayIsIHsiT2ZmIiwgIkRlZmF1bHQiLCAiTWluaW1hbCIsICJMZWdhY3kiLCAiSW50ZXJpdHVzIiwgIkNvdW50cnktQmFzZWQifSksCiAgICAgICAgd2F0ZXJtYXJrc19wb3MgPSBncm91cDpjb21ib2JveCgiUG9zIiwgeyJCb3R0b20iLCAiTGVmdCJ9KSwKICAgICAgICB3YXRlcm1hcmtfb3B0aW9ucyA9IGdyb3VwOm11bHRpc2VsZWN0KCJXYXRlcm1hcmsgbW9kaWZpY2F0aW9uIiwgeyJEZXN5bmMiLCAiQWxwaGEifSksCiAgICAgICAgb3RoZXJzID0gZ3JvdXA6bXVsdGlzZWxlY3QoIk90aGVyIiwgeyJEZWZlbnNpdmUiLCAiU2xvdy1kb3duIn0pLAogICAgICAgIGRlYnVnX3BhbmVsID0gZ3JvdXA6Y29tYm9ib3goIkRlYnVnIFBhbmVsIiwgeyJPZmYiLCAiRGVmYXVsdCIsICJNb2Rlcm4ifSksCiAgICAgICAgYW50aWFpbV9hcnJvd3MgPSBncm91cDpjb21ib2JveCgiQXJyb3dzIiwgeyJPZmYiLCAiVGVhbVNrZWV0In0pCiAgICB9LAoKICAgIG1pc2MgPSB7CiAgICAgICAgYWx0ZXJuYXRpdmVfdWkgPSBncm91cDpjaGVja2JveCgiQWx0ZXJuYXRpdmUgdWkiKSwKICAgICAgICBhbmltcyA9IGdyb3VwOm11bHRpc2VsZWN0KCJBbmltcyIsICJwaXRjaCAwIiwicmV2ZXJzZWQgbGVncyIsInN0YXRpYyBsZWdzIiwgImxlZyBicmFrZXIiLCJwZXJmZWN0IiksCiAgICAgICAgY2xhbnRhZyA9IGdyb3VwOmNoZWNrYm94KCJDbGFudGFnIiksCiAgICAgICAgZmFzdF9sYWRkZXIgPSBncm91cDpjaGVja2JveCgiRmFzdCBsYWRkZXIiKQogICAgfSwKCiAgICBjZmdzID0gewogICAgICAgIGNmZ3Nfc2VsZWN0ID0gZ3JvdXA6Y29tYm9ib3goIlxuICIsIHsiTG9jYWwiLCAiRGlzY29yZCJ9KSwKICAgICAgICAtLWltcG9ydCA9IGdyb3VwOmJ1dHRvbigiXHZJbXBvcnQiLCBmdW5jdGlvbigpIGltcG9ydF9jZmcoKSBlbmQpLAogICAgICAgIC0tZXhwb3J0ID0gZ3JvdXA6YnV0dG9uKCJcdkV4cG9ydCIsIGZ1bmN0aW9uKCkgZXhwb3J0X2NmZygpIGVuZCksCiAgICAgICAgLS1kZWZhdWx0ID0gZ3JvdXA6YnV0dG9uKCJcdkRlZmF1bHQiLCBmdW5jdGlvbigpIGRlZmF1bHRfY2ZnKCkgZW5kKSwKICAgICAgICAtLXNoYXJlID0gZ3JvdXA6YnV0dG9uKCJcdlNoYXJlIG9uIGRpc2NvcmQiLCBmdW5jdGlvbigpIHNoYXJlX2NmZygpIGVuZCksCiAgICAgICAgZGlzY29yZF9saXN0ID0gZ3JvdXA6bGlzdGJveCgiRGlzY29yZCIsIHsiTm8gY2ZncyBmb3VuZC4ifSksCiAgICAgICAgZGlzY29yZF9sb2FkID0gZ3JvdXA6YnV0dG9uKCJcdkxvYWQiLCBmdW5jdGlvbigpIGxvYWRfZGlzY29yZF9jZmdzKCkgZW5kKSwKICAgICAgICBkaXNjb3JkX3JlZnJlc2ggPSBncm91cDpidXR0b24oIlx2UmVmcmVzaCIsIGZ1bmN0aW9uKCkgcmVmcmVzaF9kaXNjb3JkX2NmZ3MoKSBlbmQpCiAgICB9Cn0KCl91aS5sdWEudGV4dF9idWlsZDpkZXBlbmQoe191aS5sdWEuZW5hYmxlX2x1YSwgdHJ1ZX0pCl91aS5sdWEudGFiOmRlcGVuZCh7X3VpLmx1YS5lbmFibGVfbHVhLCB0cnVlfSwge191aS5taXNjLmFsdGVybmF0aXZlX3VpLCBmYWxzZX0pCl91aS5hbnRpYWltLmVuYWJsZTpkZXBlbmQoe191aS5sdWEuZW5hYmxlX2x1YSwgdHJ1ZX0sIHtfdWkubHVhLnRhYiwgIkFudGktYWltIn0pCl91aS5hbnRpYWltLnlhd19iYXNlOmRlcGVuZCh7X3VpLmx1YS5lbmFibGVfbHVhLCB0cnVlfSwge191aS5sdWEudGFiLCAiQW50aS1haW0ifSwge191aS5hbnRpYWltLmVuYWJsZSwgdHJ1ZX0pCl91aS5hbnRpYWltLnN0YXRlOmRlcGVuZCh7X3VpLmx1YS5lbmFibGVfbHVhLCB0cnVlfSwge191aS5sdWEudGFiLCAiQW50aS1haW0ifSwge191aS5hbnRpYWltLmVuYWJsZSwgdHJ1ZX0pCl91aS5kZWZlbnNpdmUuZW5hYmxlOmRlcGVuZCh7X3VpLmx1YS5lbmFibGVfbHVhLCB0cnVlfSwge191aS5sdWEudGFiLCAiRGVmZW5zaXZlIn0pCl91aS5kZWZlbnNpdmUuc3RhdGU6ZGVwZW5kKHtfdWkubHVhLmVuYWJsZV9sdWEsIHRydWV9LCB7X3VpLmx1YS50YWIsICJEZWZlbnNpdmUifSwge191aS5kZWZlbnNpdmUuZW5hYmxlLCB0cnVlfSkKX3VpLmNmZ3MuY2Znc19zZWxlY3Q6ZGVwZW5kKHtfdWkubHVhLmVuYWJsZV9sdWEsIHRydWV9LCB7X3VpLmx1YS50YWIsICJDb25maWcifSkKLS1fdWkuY2Zncy5pbXBvcnQ6ZGVwZW5kKHtfdWkubHVhLmVuYWJsZV9sdWEsIHRydWV9LCB7X3VpLmx1YS50YWIsICJDb25maWcifSwge191aS5jZmdzLmNmZ3Nfc2VsZWN0LCAiTG9jYWwifSkKLS1fdWkuY2Zncy5leHBvcnQ6ZGVwZW5kKHtfdWkubHVhLmVuYWJsZV9sdWEsIHRydWV9LCB7X3VpLmx1YS50YWIsICJDb25maWcifSwge191aS5jZmdzLmNmZ3Nfc2VsZWN0LCAiTG9jYWwifSkKX3VpLmNmZ3MuZGlzY29yZF9saXN0OmRlcGVuZCh7X3VpLmx1YS5lbmFibGVfbHVhLCB0cnVlfSwge191aS5sdWEudGFiLCAiQ29uZmlnIn0sIHtfdWkuY2Zncy5jZmdzX3NlbGVjdCwgIkRpc2NvcmQifSkKX3VpLmNmZ3MuZGlzY29yZF9sb2FkOmRlcGVuZCh7X3VpLmx1YS5lbmFibGVfbHVhLCB0cnVlfSwge191aS5sdWEudGFiLCAiQ29uZmlnIn0sIHtfdWkuY2Zncy5jZmdzX3NlbGVjdCwgIkRpc2NvcmQifSkKX3VpLmNmZ3MuZGlzY29yZF9yZWZyZXNoOmRlcGVuZCh7X3VpLmx1YS5lbmFibGVfbHVhLCB0cnVlfSwge191aS5sdWEudGFiLCAiQ29uZmlnIn0sIHtfdWkuY2Zncy5jZmdzX3NlbGVjdCwgIkRpc2NvcmQifSkKX3VpLnZpc3VhbHMuZW5hYmxlOmRlcGVuZCh7X3VpLmx1YS5lbmFibGVfbHVhLCB0cnVlfSwge191aS5sdWEudGFiLCAiVmlzdWFscyJ9KQpfdWkua2V5YmluZHMuZnJlZXN0YW5kaW5nOmRlcGVuZCh7X3VpLmx1YS5lbmFibGVfbHVhLCB0cnVlfSwge191aS5sdWEudGFiLCAiQW50aS1haW0ifSkKX3VpLmtleWJpbmRzLm1hbnVhbF9sZWZ0OmRlcGVuZCh7X3VpLmx1YS5lbmFibGVfbHVhLCB0cnVlfSwge191aS5sdWEudGFiLCAiQW50aS1haW0ifSkKX3VpLmtleWJpbmRzLm1hbnVhbF9yaWdodDpkZXBlbmQoe191aS5sdWEuZW5hYmxlX2x1YSwgdHJ1ZX0sIHtfdWkubHVhLnRhYiwgIkFudGktYWltIn0pCl91aS5rZXliaW5kcy5tYW51YWxfZm9yd2FyZDpkZXBlbmQoe191aS5sdWEuZW5hYmxlX2x1YSwgdHJ1ZX0sIHtfdWkubHVhLnRhYiwgIkFudGktYWltIn0pCl91aS5rZXliaW5kcy50d2Vha3M6ZGVwZW5kKHtfdWkubHVhLmVuYWJsZV9sdWEsIHRydWV9LCB7X3VpLmx1YS50YWIsICJBbnRpLWFpbSJ9KQpfdWkubWlzYy5jbGFudGFnOmRlcGVuZCh7X3VpLmx1YS5lbmFibGVfbHVhLCB0cnVlfSwge191aS5sdWEudGFiLCAiTWlzY2VsbGFuZW91cyJ9KQpfdWkubWlzYy5mYXN0X2xhZGRlcjpkZXBlbmQoe191aS5sdWEuZW5hYmxlX2x1YSwgdHJ1ZX0sIHtfdWkubHVhLnRhYiwgIk1pc2NlbGxhbmVvdXMifSkKX3VpLm1pc2MuYWx0ZXJuYXRpdmVfdWk6ZGVwZW5kKHtfdWkubHVhLmVuYWJsZV9sdWEsIHRydWV9LCB7X3VpLmx1YS50YWIsICJNaXNjZWxsYW5lb3VzIn0pCl91aS5taXNjLmFuaW1zOmRlcGVuZCh7X3VpLmx1YS5lbmFibGVfbHVhLCB0cnVlfSwge191aS5sdWEudGFiLCAiTWlzY2VsbGFuZW91cyJ9KQpfdWkua2V5YmluZHMuZnJlZXN0YW5kaW5nX2Rpc2FibGVyczpkZXBlbmQoe191aS5sdWEuZW5hYmxlX2x1YSwgdHJ1ZX0sIHtfdWkubHVhLnRhYiwgIkFudGktYWltIn0pCl91aS52aXN1YWxzLm5vdGlmeV9zdHlsZTpkZXBlbmQoe191aS5sdWEuZW5hYmxlX2x1YSwgdHJ1ZX0sIHtfdWkubHVhLnRhYiwgIlZpc3VhbHMifSwge191aS52aXN1YWxzLmVuYWJsZSwgdHJ1ZX0pCl91aS52aXN1YWxzLmFudGlhaW1fYXJyb3dzOmRlcGVuZCh7X3VpLmx1YS5lbmFibGVfbHVhLCB0cnVlfSwge191aS5sdWEudGFiLCAiVmlzdWFscyJ9LCB7X3VpLnZpc3VhbHMuZW5hYmxlLCB0cnVlfSkKX3VpLnZpc3VhbHMuaW5kc19zdHlsZTpkZXBlbmQoe191aS5sdWEuZW5hYmxlX2x1YSwgdHJ1ZX0sIHtfdWkubHVhLnRhYiwgIlZpc3VhbHMifSwge191aS52aXN1YWxzLmVuYWJsZSwgdHJ1ZX0pCl91aS52aXN1YWxzLmhpdGxvZ3M6ZGVwZW5kKHtfdWkubHVhLmVuYWJsZV9sdWEsIHRydWV9LCB7X3VpLmx1YS50YWIsICJWaXN1YWxzIn0sIHtfdWkudmlzdWFscy5lbmFibGUsIHRydWV9KQpfdWkudmlzdWFscy53YXRlcm1hcmtzOmRlcGVuZCh7X3VpLmx1YS5lbmFibGVfbHVhLCB0cnVlfSwge191aS5sdWEudGFiLCAiVmlzdWFscyJ9LCB7X3VpLnZpc3VhbHMuZW5hYmxlLCB0cnVlfSkKX3VpLnZpc3VhbHMud2F0ZXJtYXJrc19wb3M6ZGVwZW5kKHtfdWkubHVhLmVuYWJsZV9sdWEsIHRydWV9LCB7X3VpLmx1YS50YWIsICJWaXN1YWxzIn0sIHtfdWkudmlzdWFscy5lbmFibGUsIHRydWV9LCB7X3VpLnZpc3VhbHMud2F0ZXJtYXJrcywgZnVuY3Rpb24oKSByZXR1cm4gX3VpLnZpc3VhbHMud2F0ZXJtYXJrcy52YWx1ZSB+PSAiT2ZmIiBlbmQgfSkKX3VpLnZpc3VhbHMub3RoZXJzOmRlcGVuZCh7X3VpLmx1YS5lbmFibGVfbHVhLCB0cnVlfSwge191aS5sdWEudGFiLCAiVmlzdWFscyJ9LCB7X3VpLnZpc3VhbHMuZW5hYmxlLCB0cnVlfSkKX3VpLnZpc3VhbHMuZGVidWdfcGFuZWw6ZGVwZW5kKHtfdWkubHVhLmVuYWJsZV9sdWEsIHRydWV9LCB7X3VpLmx1YS50YWIsICJWaXN1YWxzIn0sIHtfdWkudmlzdWFscy5lbmFibGUsIHRydWV9KQpfdWkudmlzdWFscy53YXRlcm1hcmtfb3B0aW9uczpkZXBlbmQoe191aS5sdWEuZW5hYmxlX2x1YSwgdHJ1ZX0sIHtfdWkubHVhLnRhYiwgIlZpc3VhbHMifSwge191aS52aXN1YWxzLmVuYWJsZSwgdHJ1ZX0sIHtfdWkudmlzdWFscy53YXRlcm1hcmtzLCBmdW5jdGlvbigpIHJldHVybiBfdWkudmlzdWFscy53YXRlcm1hcmtzLnZhbHVlIH49ICJPZmYiIGVuZCB9KQpfdWkudmlzdWFscy5pbmRzX29wdGlvbnM6ZGVwZW5kKHtfdWkubHVhLmVuYWJsZV9sdWEsIHRydWV9LCB7X3VpLmx1YS50YWIsICJWaXN1YWxzIn0sIHtfdWkudmlzdWFscy5pbmRzX3N0eWxlLCBmdW5jdGlvbigpIHJldHVybiBfdWkudmlzdWFscy5pbmRzX3N0eWxlLnZhbHVlIH49ICJPZmYiIGVuZCB9LCB7X3VpLnZpc3VhbHMuZW5hYmxlLCB0cnVlfSkKLS1fdWkuY2Zncy5kZWZhdWx0OmRlcGVuZCh7X3VpLmx1YS5lbmFibGVfbHVhLCB0cnVlfSwge191aS5sdWEudGFiLCAiQ29uZmlnIn0sIHtfdWkuY2Zncy5jZmdzX3NlbGVjdCwgIkxvY2FsIn0pCi0tX3VpLmNmZ3Muc2hhcmU6ZGVwZW5kKHtfdWkubHVhLmVuYWJsZV9sdWEsIHRydWV9LCB7X3VpLmx1YS50YWIsICJDb25maWcifSwge191aS5jZmdzLmNmZ3Nfc2VsZWN0LCAiTG9jYWwifSkKX3VpLmFudGlfYmYuZW5hYmxlOmRlcGVuZCh7X3VpLmx1YS5lbmFibGVfbHVhLCB0cnVlfSwge191aS5sdWEudGFiLCAiQW50aS1CcnV0ZWZvcmNlIn0pCl91aS5hbnRpX2JmLnBoYXNlOmRlcGVuZCh7X3VpLmx1YS5lbmFibGVfbHVhLCB0cnVlfSwge191aS5sdWEudGFiLCAiQW50aS1CcnV0ZWZvcmNlIn0sIHtfdWkuYW50aV9iZi5lbmFibGUsIHRydWV9KQpfdWkuYW50aV9iZi5yZXNldGlmOmRlcGVuZCh7X3VpLmx1YS5lbmFibGVfbHVhLCB0cnVlfSwge191aS5sdWEudGFiLCAiQW50aS1CcnV0ZWZvcmNlIn0sIHtfdWkuYW50aV9iZi5lbmFibGUsIHRydWV9KQpfdWkuYW50aV9iZi5zdGF0ZTpkZXBlbmQoe191aS5sdWEuZW5hYmxlX2x1YSwgdHJ1ZX0sIHtfdWkubHVhLnRhYiwgIkFudGktQnJ1dGVmb3JjZSJ9LCB7X3VpLmFudGlfYmYuZW5hYmxlLCB0cnVlfSkKCmFhX2J1aWxkZXIgPSB7fQpmb3IgaSwgc3RhdGUgaW4gaXBhaXJzKGFhX3RhYmxlLnN0YXRlcykgZG8KICAgIGFhX2J1aWxkZXJbc3RhdGVdID0ge30KICAgIGxvY2FsIG1lbnUgPSBhYV9idWlsZGVyW3N0YXRlXQoKICAgIG1lbnUuZW5hYmxlID0gZ3JvdXA6Y2hlY2tib3goIkVuYWJsZSB+IFx2ICIuLiBhYV90YWJsZS5zdGF0ZXNbaV0pCiAgICBtZW51LnBpdGNoID0gZ3JvdXA6Y29tYm9ib3goIlBpdGNoIiwgYWFfdGFibGUucGl0Y2gpCiAgICBtZW51LmN1c3RvbV9waXRjaCA9IGdyb3VwOnNsaWRlcigiXG4gIiwgLTg5LCA4OSwgMCwgdHJ1ZSwgIsKwIikKICAgIG1lbnUueWF3ID0gZ3JvdXA6Y29tYm9ib3goIllhdyIsIGFhX3RhYmxlLnlhdykKICAgIG1lbnUueWF3X3R5cGUgPSBncm91cDpjb21ib2JveCgiWWF3IHR5cGUiLCB7IlN0YXRpYyIsICJMICYgUiIsICJEZWxheSJ9KQogICAgbWVudS55YXdfc2xpZGVyX3N0YXRpYyA9IGdyb3VwOnNsaWRlcigiXG4gIiwgLTE4MCwgMTgwLCAwLCB0cnVlLCAiwrAiLCAxKQogICAgbWVudS55YXdfc2xpZGVyX2wgPSBncm91cDpzbGlkZXIoIkxlZnQiLCAtMTgwLCAxODAsIDAsIHRydWUsICLCsCIsIDEpCiAgICBtZW51Lnlhd19zbGlkZXJfciA9IGdyb3VwOnNsaWRlcigiUmlnaHQiLCAtMTgwLCAxODAsIDAsIHRydWUsICLCsCIsIDEpCiAgICBtZW51Lnlhd19zbGlkZXJfZGVsYXkgPSBncm91cDpzbGlkZXIoIkRlbGF5IiwgMCwgMTUsIDAsIHRydWUsICIlIiwgMSkKICAgIG1lbnUueWF3X2ppdHRlciA9IGdyb3VwOmNvbWJvYm94KCJZYXcgaml0dGVyIiwgeyJPZmYiLCAiT2Zmc2V0IiwgIkNlbnRlciIsICJSYW5kb20iLCAiU2tpdHRlciJ9KQogICAgbWVudS55YXdfaml0dGVyX21vZGUgPSBncm91cDpjb21ib2JveCgiSml0dGVyIHR5cGUiLCB7IlN0YXRpYyIsICJMICYgUiJ9KQogICAgbWVudS55YXdfaml0dGVyX3NsaWRlcl9zdGF0aWMgPSBncm91cDpzbGlkZXIoIlxuICIsIC0xODAsIDE4MCwgMCwgdHJ1ZSwgIsKwIiwgMSkKICAgIG1lbnUueWF3X2ppdHRlcl9zbGlkZXJfbCA9IGdyb3VwOnNsaWRlcigiTGVmdCIsIC0xODAsIDE4MCwgMCwgdHJ1ZSwgIsKwIiwgMSkKICAgIG1lbnUueWF3X2ppdHRlcl9zbGlkZXJfciA9IGdyb3VwOnNsaWRlcigiUmlnaHQiLCAtMTgwLCAxODAsIDAsIHRydWUsICLCsCIsIDEpCiAgICBtZW51LmJvZHlfeWF3ID0gZ3JvdXA6Y29tYm9ib3goIkJvZHkgeWF3IiwgeyJPZmYiLCAiT3Bwb3NpdGUiLCAiSml0dGVyIiwgIlN0YXRpYyJ9KQogICAgbWVudS5ib2R5X3lhd19zbGlkZXIgPSBncm91cDpzbGlkZXIoIlxuICIsIC0xODAsIDE4MCwgMCwgdHJ1ZSwgIsKwIiwgMSkKZW5kCgpmb3IgaSwgc3RhdGUgaW4gaXBhaXJzKGFhX3RhYmxlLnN0YXRlcykgZG8KICAgIGxvY2FsIG1lbnUgPSBhYV9idWlsZGVyW3N0YXRlXQogICAgbG9jYWwgaXNfdGFiID0ge191aS5sdWEudGFiLCAiQW50aS1haW0ifQogICAgbG9jYWwgaXNfZW5hYmxlZF9sdWEgPSB7X3VpLmx1YS5lbmFibGVfbHVhLCB0cnVlfQogICAgbG9jYWwgaXNfY2hlY2tib3hfY2hlY2tlZCA9IHtfdWkuYW50aWFpbS5lbmFibGUsIHRydWV9CiAgICBsb2NhbCBpc19lbmFibGVkID0ge21lbnUuZW5hYmxlLCB0cnVlfQogICAgbG9jYWwgaXNfc3RhdGUgPSB7X3VpLmFudGlhaW0uc3RhdGUsIGFhX3RhYmxlLnN0YXRlc1tpXX0KICAgIG1lbnUuZW5hYmxlOmRlcGVuZChpc190YWIsIGlzX3N0YXRlLCBpc19jaGVja2JveF9jaGVja2VkLCBpc19lbmFibGVkX2x1YSkKICAgIG1lbnUucGl0Y2g6ZGVwZW5kKGlzX3RhYiwgaXNfc3RhdGUsIGlzX2NoZWNrYm94X2NoZWNrZWQsIGlzX2VuYWJsZWQsIGlzX2VuYWJsZWRfbHVhKQogICAgbWVudS5jdXN0b21fcGl0Y2g6ZGVwZW5kKGlzX3RhYiwgaXNfc3RhdGUsIGlzX2NoZWNrYm94X2NoZWNrZWQsIGlzX2VuYWJsZWQsIHttZW51LnBpdGNoLCAiQ3VzdG9tIn0sIGlzX2VuYWJsZWRfbHVhKQogICAgbWVudS55YXc6ZGVwZW5kKGlzX3RhYiwgaXNfc3RhdGUsIGlzX2NoZWNrYm94X2NoZWNrZWQsIGlzX2VuYWJsZWQsIGlzX2VuYWJsZWRfbHVhKQogICAgbWVudS55YXdfdHlwZTpkZXBlbmQoaXNfdGFiLCBpc19zdGF0ZSwgaXNfY2hlY2tib3hfY2hlY2tlZCwgaXNfZW5hYmxlZCwge21lbnUueWF3LCBmdW5jdGlvbigpIHJldHVybiBtZW51Lnlhdy52YWx1ZSB+PSAiT2ZmIiBlbmR9LCBpc19lbmFibGVkX2x1YSkKICAgIG1lbnUueWF3X3NsaWRlcl9zdGF0aWM6ZGVwZW5kKGlzX3RhYiwgaXNfc3RhdGUsIGlzX2NoZWNrYm94X2NoZWNrZWQsIGlzX2VuYWJsZWQsIHttZW51LnlhdywgZnVuY3Rpb24oKSByZXR1cm4gbWVudS55YXcudmFsdWUgfj0gIk9mZiIgZW5kfSwge21lbnUueWF3X3R5cGUsIGZ1bmN0aW9uKCkgcmV0dXJuIG1lbnUueWF3X3R5cGUudmFsdWUgPT0gIlN0YXRpYyIgZW5kfSwgaXNfZW5hYmxlZF9sdWEpCiAgICBtZW51Lnlhd19zbGlkZXJfbDpkZXBlbmQoaXNfdGFiLCBpc19zdGF0ZSwgaXNfY2hlY2tib3hfY2hlY2tlZCwgaXNfZW5hYmxlZCwge21lbnUueWF3LCBmdW5jdGlvbigpIHJldHVybiBtZW51Lnlhdy52YWx1ZSB+PSAiT2ZmIiBlbmR9LCB7bWVudS55YXdfdHlwZSwgZnVuY3Rpb24oKSByZXR1cm4gbWVudS55YXdfdHlwZS52YWx1ZSB+PSAiU3RhdGljIiBlbmR9LCBpc19lbmFibGVkX2x1YSkKICAgIG1lbnUueWF3X3NsaWRlcl9yOmRlcGVuZChpc190YWIsIGlzX3N0YXRlLCBpc19jaGVja2JveF9jaGVja2VkLCBpc19lbmFibGVkLCB7bWVudS55YXcsIGZ1bmN0aW9uKCkgcmV0dXJuIG1lbnUueWF3LnZhbHVlIH49ICJPZmYiIGVuZH0sIHttZW51Lnlhd190eXBlLCBmdW5jdGlvbigpIHJldHVybiBtZW51Lnlhd190eXBlLnZhbHVlIH49ICJTdGF0aWMiIGVuZH0sIGlzX2VuYWJsZWRfbHVhKQogICAgbWVudS55YXdfc2xpZGVyX2RlbGF5OmRlcGVuZChpc190YWIsIGlzX3N0YXRlLCBpc19jaGVja2JveF9jaGVja2VkLCBpc19lbmFibGVkLCB7bWVudS55YXcsIGZ1bmN0aW9uKCkgcmV0dXJuIG1lbnUueWF3LnZhbHVlIH49ICJPZmYiIGVuZH0sIHttZW51Lnlhd190eXBlLCBmdW5jdGlvbigpIHJldHVybiBtZW51Lnlhd190eXBlLnZhbHVlID09ICJEZWxheSIgZW5kfSwgaXNfZW5hYmxlZF9sdWEpCiAgICBtZW51Lnlhd19qaXR0ZXI6ZGVwZW5kKGlzX3RhYiwgaXNfc3RhdGUsIGlzX2NoZWNrYm94X2NoZWNrZWQsIGlzX2VuYWJsZWQsIHttZW51LnlhdywgZnVuY3Rpb24oKSByZXR1cm4gbWVudS55YXcudmFsdWUgfj0gIk9mZiIgZW5kfSwgaXNfZW5hYmxlZF9sdWEpCiAgICBtZW51Lnlhd19qaXR0ZXJfbW9kZTpkZXBlbmQoaXNfdGFiLCBpc19zdGF0ZSwgaXNfY2hlY2tib3hfY2hlY2tlZCwgaXNfZW5hYmxlZCwge21lbnUueWF3LCBmdW5jdGlvbigpIHJldHVybiBtZW51Lnlhdy52YWx1ZSB+PSAiT2ZmIiBlbmR9LCB7bWVudS55YXdfaml0dGVyLCBmdW5jdGlvbigpIHJldHVybiBtZW51Lnlhd19qaXR0ZXIudmFsdWUgfj0gIk9mZiIgZW5kfSwgaXNfZW5hYmxlZF9sdWEpCiAgICBtZW51Lnlhd19qaXR0ZXJfc2xpZGVyX3N0YXRpYzpkZXBlbmQoaXNfdGFiLCBpc19zdGF0ZSwgaXNfY2hlY2tib3hfY2hlY2tlZCwgaXNfZW5hYmxlZCwge21lbnUueWF3LCBmdW5jdGlvbigpIHJldHVybiBtZW51Lnlhdy52YWx1ZSB+PSAiT2ZmIiBlbmR9LCB7bWVudS55YXdfaml0dGVyLCBmdW5jdGlvbigpIHJldHVybiBtZW51Lnlhd19qaXR0ZXIudmFsdWUgfj0gIk9mZiIgZW5kfSwge21lbnUueWF3X2ppdHRlcl9tb2RlLCBmdW5jdGlvbigpIHJldHVybiBtZW51Lnlhd19qaXR0ZXJfbW9kZS52YWx1ZSA9PSAiU3RhdGljIiBlbmR9LCBpc19lbmFibGVkX2x1YSkKICAgIG1lbnUueWF3X2ppdHRlcl9zbGlkZXJfbDpkZXBlbmQoaXNfdGFiLCBpc19zdGF0ZSwgaXNfY2hlY2tib3hfY2hlY2tlZCwgaXNfZW5hYmxlZCwge21lbnUueWF3LCBmdW5jdGlvbigpIHJldHVybiBtZW51Lnlhdy52YWx1ZSB+PSAiT2ZmIiBlbmR9LCB7bWVudS55YXdfaml0dGVyLCBmdW5jdGlvbigpIHJldHVybiBtZW51Lnlhd19qaXR0ZXIudmFsdWUgfj0gIk9mZiIgZW5kfSwge21lbnUueWF3X2ppdHRlcl9tb2RlLCBmdW5jdGlvbigpIHJldHVybiBtZW51Lnlhd19qaXR0ZXJfbW9kZS52YWx1ZSA9PSAiTCAmIFIiIGVuZH0sIGlzX2VuYWJsZWRfbHVhKQogICAgbWVudS55YXdfaml0dGVyX3NsaWRlcl9yOmRlcGVuZChpc190YWIsIGlzX3N0YXRlLCBpc19jaGVja2JveF9jaGVja2VkLCBpc19lbmFibGVkLCB7bWVudS55YXcsIGZ1bmN0aW9uKCkgcmV0dXJuIG1lbnUueWF3LnZhbHVlIH49ICJPZmYiIGVuZH0sIHttZW51Lnlhd19qaXR0ZXIsIGZ1bmN0aW9uKCkgcmV0dXJuIG1lbnUueWF3X2ppdHRlci52YWx1ZSB+PSAiT2ZmIiBlbmR9LCB7bWVudS55YXdfaml0dGVyX21vZGUsIGZ1bmN0aW9uKCkgcmV0dXJuIG1lbnUueWF3X2ppdHRlcl9tb2RlLnZhbHVlID09ICJMICYgUiIgZW5kfSwgaXNfZW5hYmxlZF9sdWEpCiAgICBtZW51LmJvZHlfeWF3OmRlcGVuZChpc190YWIsIGlzX3N0YXRlLCBpc19jaGVja2JveF9jaGVja2VkLCBpc19lbmFibGVkLCBpc19lbmFibGVkX2x1YSkKICAgIG1lbnUuYm9keV95YXdfc2xpZGVyOmRlcGVuZChpc190YWIsIGlzX3N0YXRlLCBpc19jaGVja2JveF9jaGVja2VkLCBpc19lbmFibGVkLCB7bWVudS5ib2R5X3lhdywgZnVuY3Rpb24oKSByZXR1cm4gbWVudS5ib2R5X3lhdy52YWx1ZSB+PSAiT2ZmIiBhbmQgbWVudS5ib2R5X3lhdy52YWx1ZSB+PSAiT3Bwb3NpdGUiIGVuZH0sIGlzX2VuYWJsZWRfbHVhKQplbmQKCmRlZmVuc2l2ZV9idWlsZGVyID0ge30KZm9yIGksIHN0YXRlIGluIGlwYWlycyhhYV90YWJsZS5kZWZlbnNpdmVfc3RhdGVzKSBkbyAKICAgIGRlZmVuc2l2ZV9idWlsZGVyW3N0YXRlXSA9IHt9CiAgICBsb2NhbCBtZW51ID0gZGVmZW5zaXZlX2J1aWxkZXJbc3RhdGVdCgogICAgbWVudS5mb3JjZSA9IGdyb3VwOmNoZWNrYm94KCJGb3JjZSBcdmRlZmVuc2l2ZSIpCiAgICBtZW51LmVuYWJsZSA9IGdyb3VwOmNoZWNrYm94KCJPdmVycmlkZSB+XHYgIi4uIGFhX3RhYmxlLmRlZmVuc2l2ZV9zdGF0ZXNbaV0pCiAgICBtZW51LnBpdGNoID0gZ3JvdXA6Y29tYm9ib3goIlBpdGNoIiwgJ0Rpc2FibGVkJywgJ1VwJywgJ1plcm8nLCAnUmFuZG9tJywgJ0ludGVyaXR1cycsICdDdXN0b20nKQogICAgbWVudS5jdXN0b21fcGl0Y2ggPSBncm91cDpzbGlkZXIoIlxuICIsIC04OSwgODksIDAsIHRydWUsICLCsCIpCiAgICBtZW51LnlhdyA9IGdyb3VwOmNvbWJvYm94KCJZYXciLCAnRGlzYWJsZWQnLCAnU2lkZXdheXMnLCAnUmFuZG9tJywgJ1NwaW4nLCAiMy1XYXkiLCAiNS1XYXkiLCAiTCAmIFIiKQogICAgbWVudS55YXdfc2xpZGVyID0gZ3JvdXA6c2xpZGVyKCJcbiAiLCAxLCAxMDAsIDcwLCB0cnVlLCAiJSIpCiAgICBtZW51Lnlhd19sZWZ0ID0gZ3JvdXA6c2xpZGVyKCJMZWZ0IiwgLTEwMCwgMTAwLCAwLCB0cnVlLCAiwrAiKQogICAgbWVudS55YXdfcmlnaHQgPSBncm91cDpzbGlkZXIoIlJpZ2h0IiwgLTEwMCwgMTAwLCAwLCB0cnVlLCAiwrAiKQogICAgbWVudS55YXdfaml0dGVyID0gZ3JvdXA6Y29tYm9ib3goIllhdyBqaXR0ZXIiLCB7Ik9mZiIsICJPZmZzZXQiLCAiQ2VudGVyIiwgIlJhbmRvbSIsICJTa2l0dGVyIn0pCiAgICBtZW51Lnlhd19qaXR0ZXJfc2xpZGVyID0gZ3JvdXA6c2xpZGVyKCJcbiAiLCAtMTgwLCAxODAsIDAsIHRydWUsICLCsCIpCiAgICBtZW51Lm1vZGUgPSBncm91cDpjb21ib2JveCgiTW9kZSIsIHsiQWx3YXlzIG9uIiwgIlN3aXRjaCIsICJJbnZhbGlkIHRpY2tzIn0pCmVuZAoKZm9yIGksIHN0YXRlIGluIGlwYWlycyhhYV90YWJsZS5kZWZlbnNpdmVfc3RhdGVzKSBkbyAKICAgIGxvY2FsIG1lbnUgPSBkZWZlbnNpdmVfYnVpbGRlcltzdGF0ZV0KICAgIGxvY2FsIGlzX3RhYiA9IHtfdWkubHVhLnRhYiwgIkRlZmVuc2l2ZSJ9CiAgICBsb2NhbCBpc19lbmFibGVkID0ge191aS5kZWZlbnNpdmUuZW5hYmxlLCB0cnVlfQogICAgbG9jYWwgaXNfZW5hYmxlZF9sdWEgPSB7X3VpLmx1YS5lbmFibGVfbHVhLCB0cnVlfQogICAgbG9jYWwgaXNfc3RhdGUgPSB7X3VpLmRlZmVuc2l2ZS5zdGF0ZSwgYWFfdGFibGUuZGVmZW5zaXZlX3N0YXRlc1tpXX0KICAgIG1lbnUuZm9yY2U6ZGVwZW5kKGlzX3RhYiwgaXNfZW5hYmxlZCwgaXNfc3RhdGUsIHttZW51LmVuYWJsZSwgZmFsc2V9LCBpc19lbmFibGVkX2x1YSkKICAgIG1lbnUuZW5hYmxlOmRlcGVuZChpc190YWIsIGlzX3N0YXRlLCBpc19lbmFibGVkLCB7bWVudS5mb3JjZSwgZmFsc2V9LCBpc19lbmFibGVkX2x1YSkKICAgIG1lbnUucGl0Y2g6ZGVwZW5kKGlzX3RhYiwgaXNfc3RhdGUsIGlzX2VuYWJsZWQsIHttZW51LmVuYWJsZSwgdHJ1ZX0sIGlzX2VuYWJsZWRfbHVhKQogICAgbWVudS5jdXN0b21fcGl0Y2g6ZGVwZW5kKGlzX3RhYiwgaXNfc3RhdGUsIGlzX2VuYWJsZWQsIHttZW51LmVuYWJsZSwgdHJ1ZX0sIHttZW51LnBpdGNoLCAiQ3VzdG9tIn0sIGlzX2VuYWJsZWRfbHVhKQogICAgbWVudS55YXc6ZGVwZW5kKGlzX3RhYiwgaXNfc3RhdGUsIGlzX2VuYWJsZWQsIHttZW51LmVuYWJsZSwgdHJ1ZX0sIGlzX2VuYWJsZWRfbHVhKQogICAgbWVudS55YXdfc2xpZGVyOmRlcGVuZChpc190YWIsIGlzX3N0YXRlLCBpc19lbmFibGVkLCB7bWVudS5lbmFibGUsIHRydWV9LCB7bWVudS55YXcsIGZ1bmN0aW9uKCkgcmV0dXJuIG1lbnUueWF3LnZhbHVlIH49ICJPZmYiIGVuZH0sIGlzX2VuYWJsZWRfbHVhLCB7bWVudS55YXcsICJTcGluIn0pCiAgICBtZW51Lnlhd19sZWZ0OmRlcGVuZChpc190YWIsIGlzX3N0YXRlLCBpc19lbmFibGVkLCB7bWVudS5lbmFibGUsIHRydWV9LCB7bWVudS55YXcsIGZ1bmN0aW9uKCkgcmV0dXJuIG1lbnUueWF3LnZhbHVlIH49ICJPZmYiIGVuZH0sIGlzX2VuYWJsZWRfbHVhLCB7bWVudS55YXcsICJMICYgUiJ9KQogICAgbWVudS55YXdfcmlnaHQ6ZGVwZW5kKGlzX3RhYiwgaXNfc3RhdGUsIGlzX2VuYWJsZWQsIHttZW51LmVuYWJsZSwgdHJ1ZX0sIHttZW51LnlhdywgZnVuY3Rpb24oKSByZXR1cm4gbWVudS55YXcudmFsdWUgfj0gIk9mZiIgZW5kfSwgaXNfZW5hYmxlZF9sdWEsIHttZW51LnlhdywgIkwgJiBSIn0pCiAgICBtZW51Lnlhd19qaXR0ZXI6ZGVwZW5kKGlzX3RhYiwgaXNfc3RhdGUsIGlzX2VuYWJsZWQsIHttZW51LmVuYWJsZSwgdHJ1ZX0sIHttZW51LnlhdywgZnVuY3Rpb24oKSByZXR1cm4gbWVudS55YXcudmFsdWUgfj0gIk9mZiIgZW5kfSwgaXNfZW5hYmxlZF9sdWEpCiAgICBtZW51Lnlhd19qaXR0ZXJfc2xpZGVyOmRlcGVuZChpc190YWIsIGlzX3N0YXRlLCBpc19lbmFibGVkLCB7bWVudS5lbmFibGUsIHRydWV9LCB7bWVudS55YXdfaml0dGVyLCBmdW5jdGlvbigpIHJldHVybiBtZW51Lnlhd19qaXR0ZXIudmFsdWUgfj0gIk9mZiIgZW5kfSwgaXNfZW5hYmxlZF9sdWEpCiAgICBtZW51Lm1vZGU6ZGVwZW5kKGlzX3RhYiwgaXNfc3RhdGUsIGlzX2VuYWJsZWQsIHttZW51LmVuYWJsZSwgdHJ1ZX0sIGlzX2VuYWJsZWRfbHVhKQplbmQKCmFudGlfYmZfYnVpbGRlciA9IHt9CmZvciBpID0gMSwgYW50aV9iZl90YWJsZS5tYXhfcGhhc2UgZG8gCiAgICBhbnRpX2JmX2J1aWxkZXJbaV0gPSB7fQogICAgbG9jYWwgbWVudSA9IGFudGlfYmZfYnVpbGRlcltpXQogICAgCiAgICBtZW51LmVuYWJsZWQgPSBncm91cDpjaGVja2JveCgiRW5hYmxlIH4gW1x2Ii4uaS4uIlxyXSBwaGFzZSIpCiAgICBtZW51LmppdHRlciA9IGdyb3VwOnNsaWRlcigiWWF3IGppdHRlciIsIC0xODAsIDE4MCwgMCwgdHJ1ZSwgImciLCAxKQogICAgbWVudS5ib2R5X3lhdyA9IGdyb3VwOnNsaWRlcigiQm9keSB5YXcgbGltaXQiLCAtMTgwLCAxODAsIDAsIHRydWUsICJwcm9jIiwgMSkKZW5kCgpmb3IgaSA9IDEsIGFudGlfYmZfdGFibGUubWF4X3BoYXNlIGRvIAogICAgbG9jYWwgbWVudSA9IGFudGlfYmZfYnVpbGRlcltpXQoKICAgIG1lbnUuZW5hYmxlZDpkZXBlbmQoe191aS5sdWEuZW5hYmxlX2x1YSwgdHJ1ZX0sIHtfdWkubHVhLnRhYiwgIkFudGktQnJ1dGVmb3JjZSJ9LCB7X3VpLmFudGlfYmYuZW5hYmxlLCB0cnVlfSwge191aS5hbnRpX2JmLnBoYXNlLCBhbnRpX2JmX3RhYmxlLnBoYXNlX3RvX3N0cmluZ1tpXX0pCiAgICBtZW51LmppdHRlcjpkZXBlbmQoe191aS5sdWEuZW5hYmxlX2x1YSwgdHJ1ZX0sIHtfdWkubHVhLnRhYiwgIkFudGktQnJ1dGVmb3JjZSJ9LCB7X3VpLmFudGlfYmYuZW5hYmxlLCB0cnVlfSwge191aS5hbnRpX2JmLnBoYXNlLCBhbnRpX2JmX3RhYmxlLnBoYXNlX3RvX3N0cmluZ1tpXX0sIHttZW51LmVuYWJsZWQsIHRydWV9KQogICAgbWVudS5ib2R5X3lhdzpkZXBlbmQoe191aS5sdWEuZW5hYmxlX2x1YSwgdHJ1ZX0sIHtfdWkubHVhLnRhYiwgIkFudGktQnJ1dGVmb3JjZSJ9LCB7X3VpLmFudGlfYmYuZW5hYmxlLCB0cnVlfSwge191aS5hbnRpX2JmLnBoYXNlLCBhbnRpX2JmX3RhYmxlLnBoYXNlX3RvX3N0cmluZ1tpXX0sIHttZW51LmVuYWJsZWQsIHRydWV9KQplbmQKCmxvY2FsIGNvbmZpZ19pdGVtcyA9IHsKICAgIF91aS5hbnRpYWltLAogICAgX3VpLmRlZmVuc2l2ZSwKICAgIGRlZmVuc2l2ZV9idWlsZGVyLAogICAgYWFfYnVpbGRlciwKICAgIF91aS5hbnRpX2JmLAogICAgYW50aV9iZl9idWlsZGVyCn0KCmxvY2FsIHBhY2thZ2UgPSBwdWkuc2V0dXAoY29uZmlnX2l0ZW1zKQoKLS0gZnVuY3Rpb24gaW1wb3J0X2NmZygpCi0tICAgICBsb2NhbCBwcm90ZWN0ZWQgPSBmdW5jdGlvbigpCi0tICAgICAgICAgZGVjcnlwdGVkID0ganNvbi5wYXJzZShiYXNlNjQuZGVjb2RlKGNsaXBib2FyZC5nZXQoKSkpCi0tICAgICAgICAgcGFja2FnZTpsb2FkKGRlY3J5cHRlZCkKLS0gICAgIGVuZAoKLS0gICAgIGlmIHBjYWxsKHByb3RlY3RlZCkgdGhlbgotLSAgICAgICAgIG5ld19ub3RpZnkoIlN1Y2Nlc3NmdWxseSEgSW1wb3J0ZWQgc2V0dGluZ3MgZnJvbSBjbGlwYm9hcmQiLCAyNTUsIDExNSwgMTA1KQotLSAgICAgZWxzZQotLSAgICAgICAgIG5ld19ub3RpZnkoIkVycm9yIiwgMjE0LCAwLCAzNiwyNTUpCi0tICAgICBlbmQKLS0gZW5kCgotLSBmdW5jdGlvbiBleHBvcnRfY2ZnKCkKLS0gICAgIGxvY2FsIHByb3RlY3RlZCA9IGZ1bmN0aW9uKCkKLS0gICAgICAgICBkYXRhID0gcGFja2FnZTpzYXZlKCkKLS0gICAgICAgICBsb2NhbCBlbmNyeXB0ZWQgPSBiYXNlNjQuZW5jb2RlKGpzb24uc3RyaW5naWZ5KGRhdGEpKQoKLS0gICAgICAgICBjbGlwYm9hcmQuc2V0KGVuY3J5cHRlZCkKLS0gICAgIGVuZAoKLS0gICAgIGlmIHBjYWxsKHByb3RlY3RlZCkgdGhlbgotLSAgICAgICAgIG5ld19ub3RpZnkoIlN1Y2Nlc3NmdWxseSEgRXhwb3J0ZWQgc2V0dGluZ3MgdG8gY2xpcGJvYXJkIiwgMjU1LCAxMTUsIDEwNSkKLS0gICAgIGVsc2UKLS0gICAgICAgICBuZXdfbm90aWZ5KCJFcnJvciIsIDIxNCwgMCwgMzYsMjU1KQotLSAgICAgZW5kCi0tIGVuZAoKbG9jYWwgY2Znc190b19saXN0ID0ge30KZnVuY3Rpb24gcmVmcmVzaF9kaXNjb3JkX2NmZ3MoKQogICAgaHR0cC5nZXQoImh0dHBzOi8vd3lzY2lndWZhOS5jdDgucGwvZ2V0X2NmZ19saXN0LnBocCIsIGZ1bmN0aW9uKHIsIHMpCiAgICAgICAgaWYgciB0aGVuCiAgICAgICAgICAgIGxvY2FsIGRhdGEgPSBqc29uLnBhcnNlKHMuYm9keSkKICAgICAgICAgICAgY2Znc190b19saXN0ID0gZGF0YS5jZmdzCiAgICAgICAgICAgIF91aS5jZmdzLmRpc2NvcmRfbGlzdDp1cGRhdGUoZGF0YS5jZmdzKQogICAgICAgIGVsc2UKICAgICAgICAgICAgbmV3X25vdGlmeSgiRXJyb3IiLDIxNCwgMCwgMzYsMjU1KQogICAgICAgIGVuZAogICAgZW5kKQplbmQKcmVmcmVzaF9kaXNjb3JkX2NmZ3MoKQoKZnVuY3Rpb24gbG9hZF9kaXNjb3JkX2NmZ3MoKQogICAgbG9jYWwgbGlzdF9pdGVtID0gKF91aS5jZmdzLmRpc2NvcmRfbGlzdDpnZXQoKSArIDEpCiAgICBpZiBsaXN0X2l0ZW0gPT0gbmlsIHRoZW4gcmV0dXJuIGVuZAogICAgbG9jYWwgc2VsZWN0ZWRfaXRlbSA9IGNmZ3NfdG9fbGlzdFtsaXN0X2l0ZW1dCgogICAgaHR0cC5nZXQoImh0dHBzOi8vd3lzY2lndWZhOS5jdDgucGwvZ2V0X2NmZy5waHA/Y2Zncz0iLi5zZWxlY3RlZF9pdGVtLCBmdW5jdGlvbihyLCBzKQogICAgICAgIGlmIHIgdGhlbgogICAgICAgICAgICBsb2NhbCBkYXRhID0ganNvbi5wYXJzZShzLmJvZHkpCiAgICAgICAgICAgIGRlY3J5cHRlZCA9IGpzb24ucGFyc2UoYmFzZTY0LmRlY29kZShkYXRhLmNmZ3MpKQogICAgICAgICAgICBwYWNrYWdlOmxvYWQoZGVjcnlwdGVkKQoKICAgICAgICAgICAgbmV3X25vdGlmeSgiU3VjY2Vzc2Z1bGx5ISBJbXBvcnRlZCBzZXR0aW5ncyBmcm9tIGRpc2NvcmQiLCAyNTUsIDExNSwgMTA1KQogICAgICAgIGVsc2UKICAgICAgICAgICAgbmV3X25vdGlmeSgiRXJyb3IiLDIxNCwgMCwgMzYsMjU1KQogICAgICAgIGVuZAogICAgZW5kKQogICAgLS1kaXNjb3JkX2xvYWQKZW5kCgpmdW5jdGlvbiBkZWZhdWx0X2NmZygpCiAgICBodHRwLmdldCgiaHR0cHM6Ly93eXNjaWd1ZmE5LmN0OC5wbC9jZmdzL2RlZmF1bHQudHh0IiwgZnVuY3Rpb24ocixzKQogICAgICAgIGlmIHIgdGhlbgogICAgICAgICAgICBwYWNrYWdlOmxvYWQoanNvbi5wYXJzZShiYXNlNjQuZGVjb2RlKHMuYm9keSkpKQogICAgICAgICAgICBuZXdfbm90aWZ5KCJTdWNjZXNzZnVsbHkhIExvYWRlZCBkZWZhdWx0IGNvbmZpZyIsMjU1LCAxMTUsIDEwNSkKICAgICAgICBlbHNlCiAgICAgICAgICAgIG5ld19ub3RpZnkoIkVycm9yIiwyMTQsIDAsIDM2LDI1NSkKICAgICAgICBlbmQKICAgIGVuZCkKZW5kCgoKZnVuY3Rpb24gc2hhcmVfY2ZnKCkKICAgIGRhdGEgPSBwYWNrYWdlOnNhdmUoKQogICAgbG9jYWwgZW5jcnlwdGVkID0gYmFzZTY0LmVuY29kZShqc29uLnN0cmluZ2lmeShkYXRhKSkKCiAgICBodHRwLmdldCgiaHR0cHM6Ly93eXNjaWd1ZmE5LmN0OC5wbC9wb3N0X2NmZy5waHA/ZW5jcnlwdGVkX2RhdGE9Ii4uZW5jcnlwdGVkLi4iJnVuaXhfdGltZT0iLi5jbGllbnQudW5peF90aW1lKCkuLiImbmFtZV9jZmdzPSIuLmV1cGhlbWlhLnVzZXJuYW1lLi4iIiwgZnVuY3Rpb24ociwgcykKICAgICAgICBpZiByIHRoZW4KCiAgICAgICAgICAgIGxvY2FsIFdlYmhvb2sgPSBkaXNjb3JkLm5ldygiY2ZnIHdlYmhvb2siKQogICAgICAgICAgICBsb2NhbCBSaWNoRW1iZWQgPSBkaXNjb3JkLm5ld0VtYmVkKCkKCiAgICAgICAgICAgIFdlYmhvb2s6c2V0VXNlcm5hbWUoIkludGVyaXR1cyBjZmciKQogICAgICAgICAgICBSaWNoRW1iZWQ6c2V0VGl0bGUoZXVwaGVtaWEudXNlcm5hbWUgLi4gIiB+ICIgLi4gZXVwaGVtaWEuYnVpbGQpCiAgICAgICAgICAgIFJpY2hFbWJlZDpzZXREZXNjcmlwdGlvbigiQ2ZnIHVwbG9hZGVkIHN1Y2Nlc3NmdWxseVxueW91IGNhbiBkb3dubG9hZCBpdCBbaGVyZV0oIi4ucy5ib2R5Li4iKSIpCiAgICAgICAgICAgIFJpY2hFbWJlZDpzZXRDb2xvcigxNjc0MTIyNSkKICAgICAgICAgICAgV2ViaG9vazpzZW5kKFJpY2hFbWJlZCkKCiAgICAgICAgICAgIG5ld19ub3RpZnkoIlN1Y2Nlc3NmdWxseSEgU2hhcmVkIGNmZyIsMjU1LCAxMTUsIDEwNSkKICAgICAgICBlbHNlCiAgICAgICAgICAgIG5ld19ub3RpZnkoIkVycm9yIiwyMTQsIDAsIDM2LDI1NSkKICAgICAgICBlbmQKCiAgICBlbmQpCmVuZAoKbG9jYWwgcHJldl9zaW11bGF0aW9uX3RpbWUgPSAwCgpsb2NhbCBmdW5jdGlvbiB0aW1lX3RvX3RpY2tzKHQpCiAgICByZXR1cm4gbWF0aC5mbG9vcigwLjUgKyAodCAvIGdsb2JhbHMudGlja2ludGVydmFsKCkpKQplbmQKCmxvY2FsIGRpZmZfc2ltID0gMAoKZnVuY3Rpb24gc2ltX2RpZmYoKSAKICAgIGxvY2FsIGN1cnJlbnRfc2ltdWxhdGlvbl90aW1lID0gdGltZV90b190aWNrcyhlbnRpdHkuZ2V0X3Byb3AoZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKSwgIm1fZmxTaW11bGF0aW9uVGltZSIpKQogICAgbG9jYWwgZGlmZiA9IGN1cnJlbnRfc2ltdWxhdGlvbl90aW1lIC0gcHJldl9zaW11bGF0aW9uX3RpbWUKICAgIHByZXZfc2ltdWxhdGlvbl90aW1lID0gY3VycmVudF9zaW11bGF0aW9uX3RpbWUKICAgIGRpZmZfc2ltID0gZGlmZgogICAgcmV0dXJuIGRpZmZfc2ltCmVuZAoKZnVuY3Rpb24gbm9ybWFsaXplX3lhdyh5YXcpIHlhdyA9ICh5YXcgJSAzNjAgKyAzNjApICUgMzYwIHJldHVybiB5YXcgPiAxODAgYW5kIHlhdyAtIDM2MCBvciB5YXcgZW5kCgpsb2NhbCBncm91bmRfdGljayA9IDEKbG9jYWwgZW5kX3RpbWUgPSAwCmxvY2FsIGdyb3VuZF90aWNrcyA9IDEKbG9jYWwgbGFzdF9zaW1fdGltZSA9IDAKbG9jYWwgZGVmZW5zaXZlX3VudGlsID0gMApjdXJyZW50X3RpY2tjb3VudCA9IDAKaW5kX2FuaW1fc2NvcGUgPSAwCmluZF9hbmltX3Njb3BlX2FscGhhID0gMQp3YXRlcm1hcmtfYWxwaGEgPSAxCnRvX2ppdHRlciA9IGZhbHNlCmFscGhhX2FuaW0gPSAwCmxvY2FsIG5vdGlmeV9ob3ZlciA9IGZhbHNlCmxvY2FsIGluZF9ob3ZlciA9IGZhbHNlCmxvY2FsIGRlYnVnX2hvdmVyID0gZmFsc2UKbG9jYWwgZnRfcHJldiA9IDAKdG9fZHJhdyA9ICJubyIKdG9fdXAgPSAibm8iCmxvY2FsIGNoZWNrZXIgPSAwCmxvY2FsIGFndXdubyA9IDAKdG9fZHJhd190aWNrcyA9IDAKbG9jYWwgY2xhbnRhZ3MgPSB7CiAgICAnJywKICAgICdpJywKICAgICdpbicsCiAgICAnaW50JywKICAgICdpbnRlJywKICAgICdpbnRlcicsCiAgICAnaW50ZXJpJywKICAgICdpbnRlcml0JywKICAgICdpbnRlcml0dScsCiAgICAnaW50ZXJpdHVzLicsCiAgICAnaW50ZXJpdHVzLnInLAogICAgJ2ludGVyaXR1cy5yZScsCiAgICAnaW50ZXJpdHVzLnJlZCcsCiAgICAnaW50ZXJpdHVzLnJlZCcsCiAgICAnaW50ZXJpdHVzLnJlZCcsCiAgICAnaW50ZXJpdHVzLnJlZCcsCiAgICAnbnRlcml0dXMucmVkJywKICAgICdlcml0dXMucmVkJywKICAgICdyaXR1cy5yZWQnLAogICAgJ2l0dXMucmVkJywKICAgICd0dXMucmVkJywKICAgICd1cy5yZWQnLAogICAgJ3MucmVkJywKICAgICdyZWQnLAogICAgJ2VkJywKICAgICdkJywKICAgICcnCn0KbG9jYWwgY2xhbnRhZ19wcmV2Cgpsb2NhbCBoaXRsb2dzX3BvcyA9IHsKICAgIHBvc194ID0gWCAvIDIgLSAxODAsCiAgICBwb3NfeSA9IFkgLSAyODAsCiAgICBzaXplX3cgPSAzNzAsCiAgICBzaXplX2ggPSAyMzUKfQoKbG9jYWwgaW5kaWNhdG9yX3BvcyA9IHsKICAgIHBvc194ID0gWCAvIDIgLSAzMCwKICAgIHBvc195ID0gWSAvMiArIDI1LAogICAgc2l6ZV93ID0gNjAsCiAgICBzaXplX2ggPSA3MAp9Cgpsb2NhbCBkZWJ1Z19wb3MgPSB7CiAgICBwb3NfeCA9IDQwLAogICAgcG9zX3kgPSBZIC8yICsgMjUsCiAgICBzaXplX3cgPSAxNDAsCiAgICBzaXplX2ggPSA5MAp9Cgpsb2NhbCBjdHggPSAoZnVuY3Rpb24oKQogICAgbG9jYWwgY3R4ID0ge30KCiAgICBjdHguY2ZncyA9IHsKICAgICAgICBkZWxldGVfY29uZmlnID0gZnVuY3Rpb24obmFtZSkKICAgICAgICAgICAgbG9jYWwgZGIgPSBkYXRhYmFzZS5yZWFkKGNmZ19kYXRhLmRhdGFiYXNlLmNvbmZpZ3MpIG9yIHt9CiAgICAgICAgCiAgICAgICAgICAgIGZvciBpLCB2IGluIHBhaXJzKGRiKSBkbwogICAgICAgICAgICAgICAgaWYgdi5uYW1lID09IG5hbWUgdGhlbgogICAgICAgICAgICAgICAgICAgIHRhYmxlLnJlbW92ZShkYiwgaSkKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIAogICAgICAgICAgICBmb3IgaSwgdiBpbiBwYWlycyhjZmdfZGF0YS5wcmVzZXRzKSBkbwogICAgICAgICAgICAgICAgaWYgdi5uYW1lID09IG5hbWUgdGhlbgogICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIAogICAgICAgICAgICBkYXRhYmFzZS53cml0ZShjZmdfZGF0YS5kYXRhYmFzZS5jb25maWdzLCBkYikKICAgICAgICBlbmQsCiAgICAgICAgaWZfcHJlc2V0ID0gZnVuY3Rpb24obmFtZSkKICAgICAgICAgICAgZm9yIGksIHYgaW4gcGFpcnMoY2ZnX2RhdGEucHJlc2V0cykgZG8KICAgICAgICAgICAgICAgIGlmIHYubmFtZSA9PSBuYW1lIHRoZW4KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICBlbmQsCiAgICAgICAgZ2V0X2NvbmZpZyA9IGZ1bmN0aW9uKG5hbWUpCiAgICAgICAgICAgIGxvY2FsIGRhdGFiYXNlID0gZGF0YWJhc2UucmVhZChjZmdfZGF0YS5kYXRhYmFzZS5jb25maWdzKQoKICAgICAgICAgICAgZm9yIGksIHYgaW4gcGFpcnMoZGF0YWJhc2UpIGRvCiAgICAgICAgICAgICAgICBpZiB2Lm5hbWUgPT0gbmFtZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnID0gdi5jb25maWcsCiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4ID0gaQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICAKICAgICAgICAgICAgZm9yIGksIHYgaW4gcGFpcnMoY2ZnX2RhdGEucHJlc2V0cykgZG8KICAgICAgICAgICAgICAgIGlmIHYubmFtZSA9PSBuYW1lIHRoZW4KICAgICAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgICAgICBjb25maWcgPSB2LmNvbmZpZywKICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIAogICAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICBlbmQsCiAgICAgICAgc2F2ZV9jb25maWcgPSBmdW5jdGlvbihuYW1lKQogICAgICAgICAgICBsb2NhbCBkYiA9IGRhdGFiYXNlLnJlYWQoY2ZnX2RhdGEuZGF0YWJhc2UuY29uZmlncykgb3Ige30KICAgICAgICAgICAgbG9jYWwgY29uZmlnID0ge30KCiAgICAgICAgICAgIGlmIG5hbWU6bWF0Y2goIlteJXddIikgfj0gbmlsIHRoZW4KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIGRhdGEgPSBwYWNrYWdlOnNhdmUoKQogICAgICAgICAgICBsb2NhbCBlbmNyeXB0ZWQgPSBiYXNlNjQuZW5jb2RlKGpzb24uc3RyaW5naWZ5KGRhdGEpKQogICAgICAgICAgICB0YWJsZS5pbnNlcnQoY29uZmlnLCBlbmNyeXB0ZWQpCgogICAgICAgICAgICBsb2NhbCBjZmcgPSBjdHguY2Zncy5nZXRfY29uZmlnKG5hbWUpCgogICAgICAgICAgICBpZiBub3QgY2ZnIHRoZW4KICAgICAgICAgICAgICAgIHRhYmxlLmluc2VydChkYiwge25hbWUgPSBuYW1lLCBjb25maWcgPSBjb25maWd9KQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBkYltjZmcuaW5kZXhdLmNvbmZpZyA9IGNvbmZpZwogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIGRhdGFiYXNlLndyaXRlKGNmZ19kYXRhLmRhdGFiYXNlLmNvbmZpZ3MsIGRiKQogICAgICAgIGVuZCwKICAgICAgICBsb2FkX2NvbmZpZyA9IGZ1bmN0aW9uKG5hbWUpCiAgICAgICAgICAgIGxvY2FsIGNmZyA9IGN0eC5jZmdzLmdldF9jb25maWcobmFtZSkKCiAgICAgICAgICAgIGxvY2FsIGxvYWRfY2ZnCiAgICAgICAgICAgIGlmIGN0eC5jZmdzLmlmX3ByZXNldChuYW1lKSB0aGVuCiAgICAgICAgICAgICAgICBsb2FkX2NmZyA9IGpzb24ucGFyc2UoYmFzZTY0LmRlY29kZShjZmcuY29uZmlnKSkKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgbG9hZF9jZmcgPSBqc29uLnBhcnNlKGJhc2U2NC5kZWNvZGUodW5wYWNrKGNmZy5jb25maWcpKSkKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBwYWNrYWdlOmxvYWQobG9hZF9jZmcpCiAgICAgICAgZW5kLAogICAgICAgIGdldGNvbmZpZ19saXN0ID0gZnVuY3Rpb24oKQogICAgICAgICAgICBsb2NhbCBkYXRhYmFzZSA9IGRhdGFiYXNlLnJlYWQoY2ZnX2RhdGEuZGF0YWJhc2UuY29uZmlncykgb3Ige30KICAgICAgICAgICAgbG9jYWwgY29uZmlnID0ge30KICAgICAgICAgICAgbG9jYWwgcHJlc2V0cyA9IGNmZ19kYXRhLnByZXNldHMKICAgICAgICAKICAgICAgICAgICAgZm9yIGksIHYgaW4gcGFpcnMocHJlc2V0cykgZG8KICAgICAgICAgICAgICAgIHRhYmxlLmluc2VydChjb25maWcsIHYubmFtZSkKICAgICAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgICAgIGZvciBpLCB2IGluIHBhaXJzKGRhdGFiYXNlKSBkbwogICAgICAgICAgICAgICAgdGFibGUuaW5zZXJ0KGNvbmZpZywgdi5uYW1lKQogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIHJldHVybiBjb25maWcKICAgICAgICBlbmQsCiAgICAgICAgZXhwb3J0X2NvbmZpZyA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgZGF0YSA9IHBhY2thZ2U6c2F2ZSgpCiAgICAgICAgICAgIGVuY3J5cHRlZCA9IGJhc2U2NC5lbmNvZGUoanNvbi5zdHJpbmdpZnkoZGF0YSkpCiAgICAgICAgICAgIGNsaXBib2FyZC5zZXQoZW5jcnlwdGVkKQogICAgICAgIGVuZCwKICAgICAgICBpbXBvcnRfY29uZmlnID0gZnVuY3Rpb24oKQogICAgICAgICAgICBkZWNyeXB0ZWQgPSBqc29uLnBhcnNlKGJhc2U2NC5kZWNvZGUoY2xpcGJvYXJkLmdldCgpKSkKICAgICAgICAgICAgcGFja2FnZTpsb2FkKGRlY3J5cHRlZCkKICAgICAgICBlbmQsCiAgICB9CgogICAgY3R4Lm1fcmVuZGVyID0gewogICAgICAgIHJlYyA9IGZ1bmN0aW9uKHNlbGYsIHgsIHksIHcsIGgsIHJhZGl1cywgY29sb3IpCiAgICAgICAgICAgIHJhZGl1cyA9IG1hdGgubWluKHgvMiwgeS8yLCByYWRpdXMpCiAgICAgICAgICAgIGxvY2FsIHIsIGcsIGIsIGEgPSB1bnBhY2soY29sb3IpCiAgICAgICAgICAgIHJlbmRlcmVyLnJlY3RhbmdsZSh4LCB5ICsgcmFkaXVzLCB3LCBoIC0gcmFkaXVzKjIsIHIsIGcsIGIsIGEpCiAgICAgICAgICAgIHJlbmRlcmVyLnJlY3RhbmdsZSh4ICsgcmFkaXVzLCB5LCB3IC0gcmFkaXVzKjIsIHJhZGl1cywgciwgZywgYiwgYSkKICAgICAgICAgICAgcmVuZGVyZXIucmVjdGFuZ2xlKHggKyByYWRpdXMsIHkgKyBoIC0gcmFkaXVzLCB3IC0gcmFkaXVzKjIsIHJhZGl1cywgciwgZywgYiwgYSkKICAgICAgICAgICAgcmVuZGVyZXIuY2lyY2xlKHggKyByYWRpdXMsIHkgKyByYWRpdXMsIHIsIGcsIGIsIGEsIHJhZGl1cywgMTgwLCAwLjI1KQogICAgICAgICAgICByZW5kZXJlci5jaXJjbGUoeCAtIHJhZGl1cyArIHcsIHkgKyByYWRpdXMsIHIsIGcsIGIsIGEsIHJhZGl1cywgOTAsIDAuMjUpCiAgICAgICAgICAgIHJlbmRlcmVyLmNpcmNsZSh4IC0gcmFkaXVzICsgdywgeSAtIHJhZGl1cyArIGgsIHIsIGcsIGIsIGEsIHJhZGl1cywgMCwgMC4yNSkKICAgICAgICAgICAgcmVuZGVyZXIuY2lyY2xlKHggKyByYWRpdXMsIHkgLSByYWRpdXMgKyBoLCByLCBnLCBiLCBhLCByYWRpdXMsIC05MCwgMC4yNSkKICAgICAgICBlbmQsCgogICAgICAgIHJlY19vdXRsaW5lID0gZnVuY3Rpb24oc2VsZiwgeCwgeSwgdywgaCwgcmFkaXVzLCB0aGlja25lc3MsIGNvbG9yKQogICAgICAgICAgICByYWRpdXMgPSBtYXRoLm1pbih3LzIsIGgvMiwgcmFkaXVzKQogICAgICAgICAgICBsb2NhbCByLCBnLCBiLCBhID0gdW5wYWNrKGNvbG9yKQogICAgICAgICAgICBpZiByYWRpdXMgPT0gMSB0aGVuCiAgICAgICAgICAgICAgICByZW5kZXJlci5yZWN0YW5nbGUoeCwgeSwgdywgdGhpY2tuZXNzLCByLCBnLCBiLCBhKQogICAgICAgICAgICAgICAgcmVuZGVyZXIucmVjdGFuZ2xlKHgsIHkgKyBoIC0gdGhpY2tuZXNzLCB3ICwgdGhpY2tuZXNzLCByLCBnLCBiLCBhKQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICByZW5kZXJlci5yZWN0YW5nbGUoeCArIHJhZGl1cywgeSwgdyAtIHJhZGl1cyoyLCB0aGlja25lc3MsIHIsIGcsIGIsIGEpCiAgICAgICAgICAgICAgICByZW5kZXJlci5yZWN0YW5nbGUoeCArIHJhZGl1cywgeSArIGggLSB0aGlja25lc3MsIHcgLSByYWRpdXMqMiwgdGhpY2tuZXNzLCByLCBnLCBiLCBhKQogICAgICAgICAgICAgICAgcmVuZGVyZXIucmVjdGFuZ2xlKHgsIHkgKyByYWRpdXMsIHRoaWNrbmVzcywgaCAtIHJhZGl1cyoyLCByLCBnLCBiLCBhKQogICAgICAgICAgICAgICAgcmVuZGVyZXIucmVjdGFuZ2xlKHggKyB3IC0gdGhpY2tuZXNzLCB5ICsgcmFkaXVzLCB0aGlja25lc3MsIGggLSByYWRpdXMqMiwgciwgZywgYiwgYSkKICAgICAgICAgICAgICAgIHJlbmRlcmVyLmNpcmNsZV9vdXRsaW5lKHggKyByYWRpdXMsIHkgKyByYWRpdXMsIHIsIGcsIGIsIGEsIHJhZGl1cywgMTgwLCAwLjI1LCB0aGlja25lc3MpCiAgICAgICAgICAgICAgICByZW5kZXJlci5jaXJjbGVfb3V0bGluZSh4ICsgcmFkaXVzLCB5ICsgaCAtIHJhZGl1cywgciwgZywgYiwgYSwgcmFkaXVzLCA5MCwgMC4yNSwgdGhpY2tuZXNzKQogICAgICAgICAgICAgICAgcmVuZGVyZXIuY2lyY2xlX291dGxpbmUoeCArIHcgLSByYWRpdXMsIHkgKyByYWRpdXMsIHIsIGcsIGIsIGEsIHJhZGl1cywgLTkwLCAwLjI1LCB0aGlja25lc3MpCiAgICAgICAgICAgICAgICByZW5kZXJlci5jaXJjbGVfb3V0bGluZSh4ICsgdyAtIHJhZGl1cywgeSArIGggLSByYWRpdXMsIHIsIGcsIGIsIGEsIHJhZGl1cywgMCwgMC4yNSwgdGhpY2tuZXNzKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQsCgogICAgICAgIGdsb3dfbW9kdWxlID0gZnVuY3Rpb24oc2VsZiwgeCwgeSwgdywgaCwgd2lkdGgsIHJvdW5kaW5nLCBhY2NlbnQsIGFjY2VudF9pbm5lcikKICAgICAgICAgICAgbG9jYWwgdGhpY2tuZXNzID0gMQogICAgICAgICAgICBsb2NhbCBvZmZzZXQgPSAxCiAgICAgICAgICAgIGxvY2FsIHIsIGcsIGIsIGEgPSB1bnBhY2soYWNjZW50KQogICAgICAgICAgICBpZiBhY2NlbnRfaW5uZXIgdGhlbgogICAgICAgICAgICAgICAgc2VsZjpyZWMoeCAsIHksIHcsIGggKyAxLCByb3VuZGluZywgYWNjZW50X2lubmVyKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgZm9yIGsgPSAwLCB3aWR0aCBkbwogICAgICAgICAgICAgICAgaWYgYSAqIChrL3dpZHRoKV4oMSkgPiA1IHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBhY2NlbnQgPSB7ciwgZywgYiwgYSAqIChrL3dpZHRoKV4oMil9CiAgICAgICAgICAgICAgICAgICAgc2VsZjpyZWNfb3V0bGluZSh4ICsgKGsgLSB3aWR0aCAtIG9mZnNldCkqdGhpY2tuZXNzLCB5ICsgKGsgLSB3aWR0aCAtIG9mZnNldCkgKiB0aGlja25lc3MsIHcgLSAoayAtIHdpZHRoIC0gb2Zmc2V0KSp0aGlja25lc3MqMiwgaCArIDEgLSAoayAtIHdpZHRoIC0gb2Zmc2V0KSp0aGlja25lc3MqMiwgcm91bmRpbmcgKyB0aGlja25lc3MgKiAod2lkdGggLSBrICsgb2Zmc2V0KSwgdGhpY2tuZXNzLCBhY2NlbnQpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kLAoKICAgICAgICBwYW5kb3JhX29nID0gZnVuY3Rpb24oc2VsZiwgeCx5LHcsaCxyLGcsYixhLCB0ZXh0KQogICAgICAgICAgICBzZWxmOnJlYyh4LHksdyxoLDMsIHswLDAsMCxhfSkKICAgICAgICAgICAgc2VsZjpyZWNfb3V0bGluZSh4ICsgMSwgeSArIDEsIHcgLSAyLCBoIC0gMiwgMywgMSwgezQ1LDQ1LDQ1LGF9KQogICAgICAgICAgICBzZWxmOnJlYyh4ICsgMywgeSArIDMsIHcgLSA2LCBoIC0gNiwgMiwgezE1LDE1LDE1LGF9KQogICAgICAgICAgICByZW5kZXJlci50ZXh0KHggKyA1LCB5ICsgNiwgcixnLGIsYSwgJycsIG5pbCwgdGV4dCkKICAgICAgICBlbmQKICAgIH0KCiAgICBjdHguaGVscHMgPSB7CiAgICAgICAgc3BlZWQgPSBmdW5jdGlvbigpCiAgICAgICAgICAgIGlmIG5vdCBlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICBsb2NhbCBmaXJzdF92ZWxvY2l0eSwgc2Vjb25kX3ZlbG9jaXR5ID0gZW50aXR5LmdldF9wcm9wKGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCksICJtX3ZlY1ZlbG9jaXR5IikKICAgICAgICAgICAgbG9jYWwgc3BlZWQgPSBtYXRoLmZsb29yKG1hdGguc3FydChmaXJzdF92ZWxvY2l0eSpmaXJzdF92ZWxvY2l0eStzZWNvbmRfdmVsb2NpdHkqc2Vjb25kX3ZlbG9jaXR5KSkKICAgICAgICAgICAgCiAgICAgICAgICAgIHJldHVybiBzcGVlZAogICAgICAgIGVuZCwKICAgICAgICBnZXRfc3RhdGUgPSBmdW5jdGlvbihzcGVlZCwgY21kKQogICAgICAgICAgICBpZiBub3QgZW50aXR5LmlzX2FsaXZlKGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCkpIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICBsb2NhbCBmbGFncyA9IGVudGl0eS5nZXRfcHJvcChlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpLCAibV9mRmxhZ3MiKQogICAgICAgICAgICBsb2NhbCBsYW5kID0gYml0LmJhbmQoZmxhZ3MsIGJpdC5sc2hpZnQoMSwgMCkpIH49IDAKICAgICAgICAgICAgaWYgbGFuZCA9PSB0cnVlIHRoZW4gZ3JvdW5kX3RpY2sgPSBncm91bmRfdGljayArIDEgZWxzZSBncm91bmRfdGljayA9IDAgZW5kCiAgICAgICAgCiAgICAgICAgICAgIGlmIGJpdC5iYW5kKGZsYWdzLCAxKSA9PSAxIHRoZW4KICAgICAgICAgICAgICAgIGlmIGNtZC5hbGxvd19zZW5kX3BhY2tldCA9PSBmYWxzZSBvciBjbWQuY2hva2VkY29tbWFuZHMgPiAxIHRoZW4gcmV0dXJuICJGYWtlbGFnIiBlbmQKICAgICAgICAgICAgICAgIGlmIGdyb3VuZF90aWNrIDwgMTAgdGhlbiBpZiBiaXQuYmFuZChmbGFncywgNCkgPT0gNCB0aGVuIHJldHVybiAiRHVjay1qdW1wIiBlbHNlIHJldHVybiAiSnVtcCIgZW5kIGVuZAogICAgICAgICAgICAgICAgaWYgYml0LmJhbmQoZmxhZ3MsIDQpID09IDQgYW5kIHNwZWVkID4gOSB0aGVuIAogICAgICAgICAgICAgICAgICAgIHJldHVybiAiRHVjay1tb3ZlIgogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBpZiBiaXQuYmFuZChmbGFncywgNCkgPT0gNCBvciB1aS5nZXQocmVmcy5yZWYuZmFrZWR1Y2spIHRoZW4gCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJEdWNrIiAtLSBjcm91Y2hpbmcKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBpZiBzcGVlZCA8PSAzIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJTdGFuZCIgLS0gc3RhbmRpbmcKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHVpLmdldChyZWZzLnJlZi5zbGlkZVsyXSkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJTbG93d2FsayIgLS0gc2xvd3dhbGsKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJSdW4iIC0tIG1vdmluZwogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbHNlaWYgYml0LmJhbmQoZmxhZ3MsIDEpID09IDAgdGhlbgogICAgICAgICAgICAgICAgaWYgYml0LmJhbmQoZmxhZ3MsIDQpID09IDQgdGhlbgogICAgICAgICAgICAgICAgICAgIHJldHVybiAiRHVjay1qdW1wIiAtLSBhaXItYwogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHJldHVybiAiSnVtcCIgLS0gYWlyCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kLAogICAgICAgIGdldF9zdGF0ZV9kZWZlbnNpdmUgPSBmdW5jdGlvbihzcGVlZCkKICAgICAgICAgICAgaWYgbm90IGVudGl0eS5pc19hbGl2ZShlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpKSB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgbG9jYWwgZmxhZ3MgPSBlbnRpdHkuZ2V0X3Byb3AoZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKSwgIm1fZkZsYWdzIikKICAgICAgICAgICAgbG9jYWwgbGFuZCA9IGJpdC5iYW5kKGZsYWdzLCBiaXQubHNoaWZ0KDEsIDApKSB+PSAwCiAgICAgICAgICAgIGlmIGxhbmQgPT0gdHJ1ZSB0aGVuIGdyb3VuZF90aWNrID0gZ3JvdW5kX3RpY2sgKyAxIGVsc2UgZ3JvdW5kX3RpY2sgPSAwIGVuZAogICAgICAgICAgICBsb2NhbCBuZXh0X2F0dGFjayA9IGVudGl0eS5nZXRfcHJvcChlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpLCAnbV9mbE5leHRBdHRhY2snKSAtIGdsb2JhbHMuY3VydGltZSgpCgogICAgICAgICAgICBpZiBiaXQuYmFuZChmbGFncywgMSkgPT0gMSB0aGVuCiAgICAgICAgICAgICAgICBpZiBncm91bmRfdGljayA8IDEwIHRoZW4gaWYgYml0LmJhbmQoZmxhZ3MsIDQpID09IDQgdGhlbiByZXR1cm4gIkR1Y2stanVtcCIgZWxzZSByZXR1cm4gIkp1bXAiIGVuZCBlbmQKICAgICAgICAgICAgICAgIGlmIGJpdC5iYW5kKGZsYWdzLCA0KSA9PSA0IGFuZCBzcGVlZCA+IDkgdGhlbiAKICAgICAgICAgICAgICAgICAgICByZXR1cm4gIkR1Y2stbW92ZSIKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgaWYgYml0LmJhbmQoZmxhZ3MsIDQpID09IDQgb3IgdWkuZ2V0KHJlZnMucmVmLmZha2VkdWNrKSB0aGVuIAogICAgICAgICAgICAgICAgICAgIHJldHVybiAiRHVjayIgLS0gY3JvdWNoaW5nCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgaWYgc3BlZWQgPD0gMyB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAiU3RhbmQiIC0tIHN0YW5kaW5nCiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICBpZiB1aS5nZXQocmVmcy5yZWYuc2xpZGVbMl0pIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAiU2xvd3dhbGsiIC0tIHNsb3d3YWxrCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAiUnVuIiAtLSBtb3ZpbmcKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZWxzZWlmIGJpdC5iYW5kKGZsYWdzLCAxKSA9PSAwIHRoZW4KICAgICAgICAgICAgICAgIGlmIGJpdC5iYW5kKGZsYWdzLCA0KSA9PSA0IHRoZW4KICAgICAgICAgICAgICAgICAgICByZXR1cm4gIkR1Y2stanVtcCIgLS0gYWlyLWMKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICByZXR1cm4gIkp1bXAiIC0tIGFpcgogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCwKICAgICAgICBnZW5fdGFibGVfZnJvbV9udW1iZXIgPSBmdW5jdGlvbihudW0pCiAgICAgICAgICAgIGxvY2FsIHNlcXVlbmNlID0ge30KICAgICAgICAgICAgZm9yIGkgPSAxLCBudW0gZG8KICAgICAgICAgICAgICAgIHRhYmxlLmluc2VydChzZXF1ZW5jZSwgdG9zdHJpbmcoaSkpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICByZXR1cm4gdGFibGUuY29uY2F0KHNlcXVlbmNlLCAnLCAnKQogICAgICAgIGVuZAogICAgICAgIAogICAgfQoKICAgIGN0eC5kZWZlbnNpdmVfY2hlY2tzID0gewogICAgICAgIGlzX2RlZmVuc2l2ZV9hY3RpdmUgPSBmdW5jdGlvbigpCiAgICAgICAgICAgIGxvY2FsIHRpY2tjb3VudCA9IGdsb2JhbHMudGlja2NvdW50KCkKICAgICAgICAgICAgbG9jYWwgc2ltX3RpbWUgPSB0b3RpY2tzKGVudGl0eS5nZXRfcHJvcChlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpLCAibV9mbFNpbXVsYXRpb25UaW1lIikpCiAgICAgICAgICAgIGxvY2FsIHNpbV9kaWZmID0gc2ltX3RpbWUgLSBsYXN0X3NpbV90aW1lCgogICAgICAgICAgICBpZiBzaW1fZGlmZiA8IDAgdGhlbgogICAgICAgICAgICAgICAgZGVmZW5zaXZlX3VudGlsID0gdGlja2NvdW50ICsgbWF0aC5hYnMoc2ltX2RpZmYpIC0gdG90aWNrcyhjbGllbnQubGF0ZW5jeSgpKQogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIGxhc3Rfc2ltX3RpbWUgPSBzaW1fdGltZQoKICAgICAgICAgICAgcmV0dXJuIGRlZmVuc2l2ZV91bnRpbCA+IHRpY2tjb3VudAogICAgICAgIGVuZCwKICAgICAgICBjaG9raW5nID0gZnVuY3Rpb24oY21kKQogICAgICAgICAgICBsb2NhbCBjaG9rZSA9IGZhbHNlCiAgICAgICAgCiAgICAgICAgICAgIGlmIGNtZC5hbGxvd19zZW5kX3BhY2tldCA9PSBmYWxzZSBvciBjbWQuY2hva2VkY29tbWFuZHMgPiAxIHRoZW4KICAgICAgICAgICAgICAgIGNob2tlID0gdHJ1ZQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBjaG9rZSA9IGZhbHNlCiAgICAgICAgICAgIGVuZAogICAgICAgIAogICAgICAgICAgICByZXR1cm4gY2hva2UKICAgICAgICBlbmQKICAgIH0KCiAgICBjdHguYW50aWFpbSA9IHsKICAgICAgICBydW4gPSBmdW5jdGlvbihjbWQpCiAgICAgICAgICAgIGxvY2FsIG1lID0gZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKQogICAgICAgICAgICBpZiBub3QgZW50aXR5LmlzX2FsaXZlKG1lKSB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgZGVzeW5jX3R5cGUgPSBlbnRpdHkuZ2V0X3Byb3AobWUsICJtX2ZsUG9zZVBhcmFtZXRlciIsIDExKSAqIDEyMCAtIDYwCiAgICAgICAgICAgIGRlc3luY19zaWRlID0gZGVzeW5jX3R5cGUgPiAwIGFuZCAxIG9yIC0xCgogICAgICAgICAgICBsb2NhbCBzdGF0ZSA9IGN0eC5oZWxwcy5nZXRfc3RhdGUoY3R4LmhlbHBzLnNwZWVkKCksIGNtZCkKICAgICAgICAgICAgaWYgYWFfYnVpbGRlcltjdHguaGVscHMuZ2V0X3N0YXRlKGN0eC5oZWxwcy5zcGVlZCgpLCBjbWQpXS5lbmFibGUudmFsdWUgPT0gZmFsc2UgdGhlbiBzdGF0ZSA9ICJHbG9iYWwiIGVuZCAKICAgICAgICAgICAgbG9jYWwgYWFfdmFsdWVzID0gYWFfYnVpbGRlcltzdGF0ZV0KICAgICAgICAgICAgbG9jYWwgYWFfZGVmZW5zaXZlID0gZGVmZW5zaXZlX2J1aWxkZXJbY3R4LmhlbHBzLmdldF9zdGF0ZV9kZWZlbnNpdmUoY3R4LmhlbHBzLnNwZWVkKCkpXQoKICAgICAgICAgICAgbG9jYWwgcGl0Y2hfdGJsID0gewogICAgICAgICAgICAgICAgWydEaXNhYmxlZCddID0gODksCiAgICAgICAgICAgICAgICBbJ1VwJ10gPSAtODksCiAgICAgICAgICAgICAgICBbJ1plcm8nXSA9IDAsCiAgICAgICAgICAgICAgICBbJ1JhbmRvbSddID0gbWF0aC5yYW5kb20oLTg5LCA4OSksCiAgICAgICAgICAgICAgICBbJ0ludGVyaXR1cyddID0gYWd1d25vID4gMiBhbmQgYWd1d25vIDwgMTQgYW5kIC04OSBvciA4OSwKICAgICAgICAgICAgICAgIFsnQ3VzdG9tJ10gPSBhYV9kZWZlbnNpdmUuY3VzdG9tX3BpdGNoLnZhbHVlCiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIGxvY2FsIHlhd190YmwgPSB7CiAgICAgICAgICAgICAgICBbJ0Rpc2FibGVkJ10gPSAwLAogICAgICAgICAgICAgICAgWydTaWRld2F5cyddID0gZ2xvYmFscy50aWNrY291bnQoKSAlIDMgPT0gMCBhbmQgY2xpZW50LnJhbmRvbV9pbnQoLTEwMCwgLTkwKSBvciBnbG9iYWxzLnRpY2tjb3VudCgpICUgMyA9PSAxIGFuZCAxODAgb3IgZ2xvYmFscy50aWNrY291bnQoKSAlIDMgPT0gMiBhbmQgY2xpZW50LnJhbmRvbV9pbnQoOTAsIDEwMCkgb3IgMCwKICAgICAgICAgICAgICAgIFsnUmFuZG9tJ10gPSBtYXRoLnJhbmRvbSgtMTgwLCAxODApLAogICAgICAgICAgICAgICAgWydTcGluJ10gPSBub3JtYWxpemVfeWF3KGdsb2JhbHMuY3VydGltZSgpICogMTAwMCAqIChhYV9kZWZlbnNpdmUueWF3X3NsaWRlci52YWx1ZSAvIDEwMCkpLAogICAgICAgICAgICAgICAgWyczLVdheSddID0gZ2xvYmFscy50aWNrY291bnQoKSAlIDMgPT0gMCBhbmQgY2xpZW50LnJhbmRvbV9pbnQoLTExMCwgLTkwKSBvciBnbG9iYWxzLnRpY2tjb3VudCgpICUgMyA9PSAxIGFuZCBjbGllbnQucmFuZG9tX2ludCg5MCwgMTIwKSBvciBnbG9iYWxzLnRpY2tjb3VudCgpICUgMyA9PSAyIGFuZCBjbGllbnQucmFuZG9tX2ludCgtMTgwLCAtMTUwKSBvciAwLAogICAgICAgICAgICAgICAgWyc1LVdheSddID0gZ2xvYmFscy50aWNrY291bnQoKSAlIDUgPT0gMCBhbmQgY2xpZW50LnJhbmRvbV9pbnQoLTkwLCAtNzUpIG9yIGdsb2JhbHMudGlja2NvdW50KCkgJSA1ID09IDEgYW5kIGNsaWVudC5yYW5kb21faW50KC00NSwgLTMwKSBvciBnbG9iYWxzLnRpY2tjb3VudCgpICUgNSA9PSAyIGFuZCBjbGllbnQucmFuZG9tX2ludCgtMTgwLCAtMTYwKSBvciBnbG9iYWxzLnRpY2tjb3VudCgpICUgNSA9PSAzIGFuZCBjbGllbnQucmFuZG9tX2ludCg0NSwgNjApIG9yIGdsb2JhbHMudGlja2NvdW50KCkgJSA1ID09IDMgYW5kIGNsaWVudC5yYW5kb21faW50KDkwLCAxMTApIG9yIDAsCiAgICAgICAgICAgICAgICBbJ0wgJiBSJ10gPSBkZXN5bmNfc2lkZSA9PSAxIGFuZCBhYV9kZWZlbnNpdmUueWF3X2xlZnQudmFsdWUgb3IgYWFfZGVmZW5zaXZlLnlhd19yaWdodC52YWx1ZQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiBhYV9kZWZlbnNpdmUuZm9yY2UudmFsdWUgYW5kIG5vdCBhYV9kZWZlbnNpdmUuZW5hYmxlLnZhbHVlIHRoZW4KICAgICAgICAgICAgICAgIGNtZC5mb3JjZV9kZWZlbnNpdmUgPSB0cnVlCiAgICAgICAgICAgIGVsc2VpZiBhYV9kZWZlbnNpdmUuZW5hYmxlLnZhbHVlIGFuZCBub3QgYWFfZGVmZW5zaXZlLmZvcmNlLnZhbHVlIHRoZW4KICAgICAgICAgICAgICAgIGlmIGFhX2RlZmVuc2l2ZS5tb2RlLnZhbHVlID09ICJBbHdheXMgb24iIHRoZW4KICAgICAgICAgICAgICAgICAgICBjbWQuZm9yY2VfZGVmZW5zaXZlID0gdHJ1ZQogICAgICAgICAgICAgICAgZWxzZWlmIGFhX2RlZmVuc2l2ZS5tb2RlLnZhbHVlID09ICJTd2l0Y2giIHRoZW4KICAgICAgICAgICAgICAgICAgICBjbWQuZm9yY2VfZGVmZW5zaXZlID0gY21kLmNvbW1hbmRfbnVtYmVyICUgY2xpZW50LnJhbmRvbV9pbnQoMyw2KSA9PSAxCiAgICAgICAgICAgICAgICBlbHNlaWYgYWFfZGVmZW5zaXZlLm1vZGUudmFsdWUgPT0gIkludmFsaWQgdGlja3MiIHRoZW4KICAgICAgICAgICAgICAgICAgICBjbWQuZm9yY2VfZGVmZW5zaXZlID0gY21kLmNob2tlZGNvbW1hbmRzICUgMiA9PSAxIGFuZCBub3QgY21kLm5vX2Nob2tlCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBpZiBmdW5jcy5jb250YWlucyhfdWkua2V5YmluZHMuZnJlZXN0YW5kaW5nX2Rpc2FibGVycy52YWx1ZSwgc3RhdGUpIHRoZW4KICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi5mcmVlc3RhbmRbMV0sIGZhbHNlKQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBpZiBfdWkua2V5YmluZHMuZnJlZXN0YW5kaW5nOmdldCgpID09IHRydWUgdGhlbgogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi5mcmVlc3RhbmRbMV0sIHRydWUpCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLmZyZWVzdGFuZFsyXSwgIkFsd2F5cyBvbiIpCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLmZyZWVzdGFuZFsxXSwgZmFsc2UpCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLmZyZWVzdGFuZFsyXSwgIk9uIGhvdGtleSIpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBpZiBhYV9kZWZlbnNpdmUuZW5hYmxlLnZhbHVlIGFuZCBjdHguZGVmZW5zaXZlX2NoZWNrcy5pc19kZWZlbnNpdmVfYWN0aXZlKCkgYW5kIG5vdCBjdHguZGVmZW5zaXZlX2NoZWNrcy5jaG9raW5nKGNtZCkgYW5kIG5vdCBhYV9kZWZlbnNpdmUuZm9yY2UudmFsdWUgYW5kIF91aS5kZWZlbnNpdmUuZW5hYmxlLnZhbHVlIHRoZW4KICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi55YXcsICIxODAiKQogICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLnlhd192YWx1ZSwgeWF3X3RibFthYV9kZWZlbnNpdmUueWF3LnZhbHVlXSkKICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi5waXRjaCwgIkN1c3RvbSIpIAogICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLnBpdGNoX3ZhbHVlLCBwaXRjaF90YmxbYWFfZGVmZW5zaXZlLnBpdGNoLnZhbHVlXSkKICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi55YXdfaml0dGVyLCBhYV9kZWZlbnNpdmUueWF3X2ppdHRlci52YWx1ZSkKICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi55YXdfaml0dGVyX3ZhbHVlLCBhYV9kZWZlbnNpdmUueWF3X2ppdHRlcl9zbGlkZXIudmFsdWUpCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi5hYV9lbmFibGUsIF91aS5hbnRpYWltLmVuYWJsZS52YWx1ZSkKICAgICAgICAgICAgICAgIGlmIGFhX3ZhbHVlcy5lbmFibGUudmFsdWUgYW5kIF91aS5hbnRpYWltLmVuYWJsZS52YWx1ZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgaWYgZ2xvYmFscy50aWNrY291bnQoKSA+IGN1cnJlbnRfdGlja2NvdW50ICsgYWFfdmFsdWVzLnlhd19zbGlkZXJfZGVsYXkudmFsdWUgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBpZiBjbWQuY2hva2VkY29tbWFuZHMgPT0gMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvX2ppdHRlciA9IG5vdCB0b19qaXR0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudF90aWNrY291bnQgPSBnbG9iYWxzLnRpY2tjb3VudCgpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVsc2VpZiBnbG9iYWxzLnRpY2tjb3VudCgpIDwgIGN1cnJlbnRfdGlja2NvdW50IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudF90aWNrY291bnQgPSBnbG9iYWxzLnRpY2tjb3VudCgpCiAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi5waXRjaCxhYV92YWx1ZXMucGl0Y2gudmFsdWUpCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLnBpdGNoX3ZhbHVlLCBhYV92YWx1ZXMuY3VzdG9tX3BpdGNoLnZhbHVlKQogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi55YXdfYmFzZSwgX3VpLmFudGlhaW0ueWF3X2Jhc2UudmFsdWUpCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLnlhdywgYWFfdmFsdWVzLnlhdy52YWx1ZSkKICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5yZWYuYm9keV95YXcsIGFhX3ZhbHVlcy5ib2R5X3lhdy52YWx1ZSkKICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5yZWYueWF3X2ppdHRlciwgYWFfdmFsdWVzLnlhd19qaXR0ZXIudmFsdWUpCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLmJvZHlfeWF3X3ZhbHVlLCBhYV92YWx1ZXMuYm9keV95YXdfc2xpZGVyLnZhbHVlKQogICAgICAgICAgICAgICAgICAgIGlmIGFhX3ZhbHVlcy55YXdfaml0dGVyX21vZGUudmFsdWUgPT0gIlN0YXRpYyIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5yZWYueWF3X2ppdHRlcl92YWx1ZSwgYWFfdmFsdWVzLnlhd19qaXR0ZXJfc2xpZGVyX3N0YXRpYy52YWx1ZSkKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgYWFfdmFsdWVzLnlhd19qaXR0ZXJfbW9kZS52YWx1ZSA9PSAiTCAmIFIiIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLnlhd19qaXR0ZXJfdmFsdWUsIGRlc3luY19zaWRlID09IDEgYW5kIGFhX3ZhbHVlcy55YXdfaml0dGVyX3NsaWRlcl9sLnZhbHVlIG9yIGFhX3ZhbHVlcy55YXdfaml0dGVyX3NsaWRlcl9yLnZhbHVlKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGlmIGFhX3ZhbHVlcy55YXdfdHlwZS52YWx1ZSA9PSAiU3RhdGljIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi55YXdfdmFsdWUsIGFhX3ZhbHVlcy55YXdfc2xpZGVyX3N0YXRpYy52YWx1ZSkKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgYWFfdmFsdWVzLnlhd190eXBlLnZhbHVlID09ICJMICYgUiIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5yZWYueWF3X3ZhbHVlLCBkZXN5bmNfc2lkZSA9PSAxIGFuZCBhYV92YWx1ZXMueWF3X3NsaWRlcl9sLnZhbHVlIG9yIGFhX3ZhbHVlcy55YXdfc2xpZGVyX3IudmFsdWUpCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi5ib2R5X3lhdywgIkppdHRlciIpCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi5ib2R5X3lhd192YWx1ZSwgLTEpCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIGFhX3ZhbHVlcy55YXdfdHlwZS52YWx1ZSA9PSAiRGVsYXkiIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLnlhd192YWx1ZSwgdG9faml0dGVyIGFuZCBhYV92YWx1ZXMueWF3X3NsaWRlcl9sLnZhbHVlIG9yIGFhX3ZhbHVlcy55YXdfc2xpZGVyX3IudmFsdWUpCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi5ib2R5X3lhdywgIlN0YXRpYyIpCiAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgIGlmIGFudGlfYmZfdGFibGUubWlzc19jb3VudGVyID09IDEgYW5kIGFudGlfYmZfYnVpbGRlclthbnRpX2JmX3RhYmxlLm1pc3NfY291bnRlcl0uZW5hYmxlZC52YWx1ZSBhbmQgZnVuY3MuY29udGFpbnMoX3VpLmFudGlfYmYuc3RhdGUudmFsdWUsIGN0eC5oZWxwcy5nZXRfc3RhdGVfZGVmZW5zaXZlKGN0eC5oZWxwcy5zcGVlZCgpKSkgYW5kIF91aS5hbnRpX2JmLmVuYWJsZS52YWx1ZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi55YXdfaml0dGVyX3ZhbHVlLCBhbnRpX2JmX2J1aWxkZXJbYW50aV9iZl90YWJsZS5taXNzX2NvdW50ZXJdLmppdHRlci52YWx1ZSkKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgYW50aV9iZl90YWJsZS5taXNzX2NvdW50ZXIgPT0gMiBhbmQgYW50aV9iZl9idWlsZGVyW2FudGlfYmZfdGFibGUubWlzc19jb3VudGVyXS5lbmFibGVkLnZhbHVlIGFuZCBmdW5jcy5jb250YWlucyhfdWkuYW50aV9iZi5zdGF0ZS52YWx1ZSwgY3R4LmhlbHBzLmdldF9zdGF0ZV9kZWZlbnNpdmUoY3R4LmhlbHBzLnNwZWVkKCkpKSBhbmQgX3VpLmFudGlfYmYuZW5hYmxlLnZhbHVlIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLnlhd19qaXR0ZXJfdmFsdWUsIGFudGlfYmZfYnVpbGRlclthbnRpX2JmX3RhYmxlLm1pc3NfY291bnRlcl0uaml0dGVyLnZhbHVlKQogICAgICAgICAgICAgICAgICAgIGVsc2VpZiBhbnRpX2JmX3RhYmxlLm1pc3NfY291bnRlciA9PSAzIGFuZCBhbnRpX2JmX2J1aWxkZXJbYW50aV9iZl90YWJsZS5taXNzX2NvdW50ZXJdLmVuYWJsZWQudmFsdWUgYW5kIGZ1bmNzLmNvbnRhaW5zKF91aS5hbnRpX2JmLnN0YXRlLnZhbHVlLCBjdHguaGVscHMuZ2V0X3N0YXRlX2RlZmVuc2l2ZShjdHguaGVscHMuc3BlZWQoKSkpIGFuZCBfdWkuYW50aV9iZi5lbmFibGUudmFsdWUgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5yZWYueWF3X2ppdHRlcl92YWx1ZSwgYW50aV9iZl9idWlsZGVyW2FudGlfYmZfdGFibGUubWlzc19jb3VudGVyXS5qaXR0ZXIudmFsdWUpCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIGFudGlfYmZfdGFibGUubWlzc19jb3VudGVyID09IDQgYW5kIGFudGlfYmZfYnVpbGRlclthbnRpX2JmX3RhYmxlLm1pc3NfY291bnRlcl0uZW5hYmxlZC52YWx1ZSBhbmQgZnVuY3MuY29udGFpbnMoX3VpLmFudGlfYmYuc3RhdGUudmFsdWUsIGN0eC5oZWxwcy5nZXRfc3RhdGVfZGVmZW5zaXZlKGN0eC5oZWxwcy5zcGVlZCgpKSkgYW5kIF91aS5hbnRpX2JmLmVuYWJsZS52YWx1ZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi55YXdfaml0dGVyX3ZhbHVlLCBhbnRpX2JmX2J1aWxkZXJbYW50aV9iZl90YWJsZS5taXNzX2NvdW50ZXJdLmppdHRlci52YWx1ZSkKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgYW50aV9iZl90YWJsZS5taXNzX2NvdW50ZXIgPT0gNSBhbmQgYW50aV9iZl9idWlsZGVyW2FudGlfYmZfdGFibGUubWlzc19jb3VudGVyXS5lbmFibGVkLnZhbHVlIGFuZCBmdW5jcy5jb250YWlucyhfdWkuYW50aV9iZi5zdGF0ZS52YWx1ZSwgY3R4LmhlbHBzLmdldF9zdGF0ZV9kZWZlbnNpdmUoY3R4LmhlbHBzLnNwZWVkKCkpKSBhbmQgX3VpLmFudGlfYmYuZW5hYmxlLnZhbHVlIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLnlhd19qaXR0ZXJfdmFsdWUsIGFudGlfYmZfYnVpbGRlclthbnRpX2JmX3RhYmxlLm1pc3NfY291bnRlcl0uaml0dGVyLnZhbHVlKQogICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICBpZiBhbnRpX2JmX3RhYmxlLm1pc3NfY291bnRlciA9PSAxIGFuZCBhbnRpX2JmX2J1aWxkZXJbYW50aV9iZl90YWJsZS5taXNzX2NvdW50ZXJdLmVuYWJsZWQudmFsdWUgYW5kIGZ1bmNzLmNvbnRhaW5zKF91aS5hbnRpX2JmLnN0YXRlLnZhbHVlLCBjdHguaGVscHMuZ2V0X3N0YXRlX2RlZmVuc2l2ZShjdHguaGVscHMuc3BlZWQoKSkpIGFuZCBfdWkuYW50aV9iZi5lbmFibGUudmFsdWUgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5yZWYuYm9keV95YXdfdmFsdWUsIGFudGlfYmZfYnVpbGRlclthbnRpX2JmX3RhYmxlLm1pc3NfY291bnRlcl0uYm9keV95YXcudmFsdWUpCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIGFudGlfYmZfdGFibGUubWlzc19jb3VudGVyID09IDIgYW5kIGFudGlfYmZfYnVpbGRlclthbnRpX2JmX3RhYmxlLm1pc3NfY291bnRlcl0uZW5hYmxlZC52YWx1ZSBhbmQgZnVuY3MuY29udGFpbnMoX3VpLmFudGlfYmYuc3RhdGUudmFsdWUsIGN0eC5oZWxwcy5nZXRfc3RhdGVfZGVmZW5zaXZlKGN0eC5oZWxwcy5zcGVlZCgpKSkgYW5kIF91aS5hbnRpX2JmLmVuYWJsZS52YWx1ZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi5ib2R5X3lhd192YWx1ZSwgYW50aV9iZl9idWlsZGVyW2FudGlfYmZfdGFibGUubWlzc19jb3VudGVyXS5ib2R5X3lhdy52YWx1ZSkKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgYW50aV9iZl90YWJsZS5taXNzX2NvdW50ZXIgPT0gMyBhbmQgYW50aV9iZl9idWlsZGVyW2FudGlfYmZfdGFibGUubWlzc19jb3VudGVyXS5lbmFibGVkLnZhbHVlIGFuZCBmdW5jcy5jb250YWlucyhfdWkuYW50aV9iZi5zdGF0ZS52YWx1ZSwgY3R4LmhlbHBzLmdldF9zdGF0ZV9kZWZlbnNpdmUoY3R4LmhlbHBzLnNwZWVkKCkpKSBhbmQgX3VpLmFudGlfYmYuZW5hYmxlLnZhbHVlIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLmJvZHlfeWF3X3ZhbHVlLCBhbnRpX2JmX2J1aWxkZXJbYW50aV9iZl90YWJsZS5taXNzX2NvdW50ZXJdLmJvZHlfeWF3LnZhbHVlKQogICAgICAgICAgICAgICAgICAgIGVsc2VpZiBhbnRpX2JmX3RhYmxlLm1pc3NfY291bnRlciA9PSA0IGFuZCBhbnRpX2JmX2J1aWxkZXJbYW50aV9iZl90YWJsZS5taXNzX2NvdW50ZXJdLmVuYWJsZWQudmFsdWUgYW5kIGZ1bmNzLmNvbnRhaW5zKF91aS5hbnRpX2JmLnN0YXRlLnZhbHVlLCBjdHguaGVscHMuZ2V0X3N0YXRlX2RlZmVuc2l2ZShjdHguaGVscHMuc3BlZWQoKSkpIGFuZCBfdWkuYW50aV9iZi5lbmFibGUudmFsdWUgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5yZWYuYm9keV95YXdfdmFsdWUsIGFudGlfYmZfYnVpbGRlclthbnRpX2JmX3RhYmxlLm1pc3NfY291bnRlcl0uYm9keV95YXcudmFsdWUpCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIGFudGlfYmZfdGFibGUubWlzc19jb3VudGVyID09IDUgYW5kIGFudGlfYmZfYnVpbGRlclthbnRpX2JmX3RhYmxlLm1pc3NfY291bnRlcl0uZW5hYmxlZC52YWx1ZSBhbmQgZnVuY3MuY29udGFpbnMoX3VpLmFudGlfYmYuc3RhdGUudmFsdWUsIGN0eC5oZWxwcy5nZXRfc3RhdGVfZGVmZW5zaXZlKGN0eC5oZWxwcy5zcGVlZCgpKSkgYW5kIF91aS5hbnRpX2JmLmVuYWJsZS52YWx1ZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi5ib2R5X3lhd192YWx1ZSwgYW50aV9iZl9idWlsZGVyW2FudGlfYmZfdGFibGUubWlzc19jb3VudGVyXS5ib2R5X3lhdy52YWx1ZSkKICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgaWYgX3VpLmtleWJpbmRzLm1hbnVhbF9sZWZ0OmdldCgpID09IHRydWUgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5yZWYucGl0Y2gsICJkb3duIikKICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLnlhdywgIjE4MCIpCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi55YXdfdmFsdWUsIC05MCkKICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLnlhd19iYXNlLCAiQXQgdGFyZ2V0cyIpCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi55YXdfaml0dGVyLCAiT2ZmIikKICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLmJvZHlfeWF3LCAiU3RhdGljIikKICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLmJvZHlfeWF3X3ZhbHVlLCAwKQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5yZWYuZnJlZXN0YW5kX2JvZHlfeWF3LCBmYWxzZSkKICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgaWYgX3VpLmtleWJpbmRzLm1hbnVhbF9yaWdodDpnZXQoKSA9PSB0cnVlIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLnBpdGNoLCAiZG93biIpCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi55YXcsICIxODAiKQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5yZWYueWF3X3ZhbHVlLCA5MCkKICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLnlhd19iYXNlLCAiQXQgdGFyZ2V0cyIpCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi55YXdfaml0dGVyLCAiT2ZmIikKICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLmJvZHlfeWF3LCAiU3RhdGljIikKICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLmJvZHlfeWF3X3ZhbHVlLCAwKQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5yZWYuZnJlZXN0YW5kX2JvZHlfeWF3LCBmYWxzZSkKICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgaWYgX3VpLmtleWJpbmRzLm1hbnVhbF9mb3J3YXJkOmdldCgpID09IHRydWUgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5yZWYucGl0Y2gsICJkb3duIikKICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLnlhdywgIjE4MCIpCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi55YXdfdmFsdWUsIDE4MCkKICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLnlhd19iYXNlLCAiQXQgdGFyZ2V0cyIpCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi55YXdfaml0dGVyLCAiT2ZmIikKICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLmJvZHlfeWF3LCAiU3RhdGljIikKICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLmJvZHlfeWF3X3ZhbHVlLCAwKQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5yZWYuZnJlZXN0YW5kX2JvZHlfeWF3LCBmYWxzZSkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIC0tX3VpLmtleWJpbmRzLnR3ZWFrcwoKICAgICAgICAgICAgaWYgZnVuY3MuY29udGFpbnMoX3VpLmtleWJpbmRzLnR3ZWFrcy52YWx1ZSwgIlNhZmUgaGVhZCIpIHRoZW4KICAgICAgICAgICAgICAgIGZvciBpLCB2IGluIHBhaXJzKGVudGl0eS5nZXRfcGxheWVycyh0cnVlKSkgZG8KICAgICAgICAgICAgICAgICAgICBsb2NhbCBsb2NhbF9wbGF5ZXJfb3JpZ2luID0gdmVjdG9yKGVudGl0eS5nZXRfb3JpZ2luKGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCkpKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIHBsYXllcl9vcmlnaW4gPSB2ZWN0b3IoZW50aXR5LmdldF9vcmlnaW4odikpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgZGlmZmVyZW5jZSA9IChsb2NhbF9wbGF5ZXJfb3JpZ2luLnogLSBwbGF5ZXJfb3JpZ2luLnopCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgbG9jYWxfcGxheWVyX3dlYXBvbiA9IGVudGl0eS5nZXRfY2xhc3NuYW1lKGVudGl0eS5nZXRfcGxheWVyX3dlYXBvbihlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpKSkKICAgICAgICAKICAgICAgICAgICAgICAgICAgICAtLXByaW50KGxvY2FsX3BsYXllcl93ZWFwb24pCiAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgaWYgKGxvY2FsX3BsYXllcl93ZWFwb24gPT0gIkNLbmlmZSIgYW5kIHN0YXRlID09ICJEdWNrLWp1bXAiIGFuZCBkaWZmZXJlbmNlID4gLTcwKSB0aGVuICAgIAogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5yZWYucGl0Y2gsICJkb3duIikKICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLnlhdywgIjE4MCIpCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi55YXdfdmFsdWUsIC0xKQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5yZWYueWF3X2Jhc2UsICJBdCB0YXJnZXRzIikKICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLnlhd19qaXR0ZXIsICJPZmYiKQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5yZWYuYm9keV95YXcsICJTdGF0aWMiKQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5yZWYuYm9keV95YXdfdmFsdWUsIDApCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi5mcmVlc3RhbmRfYm9keV95YXcsIGZhbHNlKQoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgZnVuY3MuY29udGFpbnMoX3VpLmtleWJpbmRzLnR3ZWFrcy52YWx1ZSwgIkUtU3BhbSIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGN0eC5kZWZlbnNpdmVfY2hlY2tzLmlzX2RlZmVuc2l2ZV9hY3RpdmUoKSBhbmQgbm90IGN0eC5kZWZlbnNpdmVfY2hlY2tzLmNob2tpbmcoY21kKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLnlhdywgIjE4MCIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLnlhd192YWx1ZSwgMTgwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi5waXRjaCwgIkN1c3RvbSIpIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi5waXRjaF92YWx1ZSwgMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5yZWYueWF3X2ppdHRlciwgIk9mZiIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucmVmLnlhd19qaXR0ZXJfdmFsdWUsIDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIAogICAgICAgICAgICAtLSBhbnRpLWJhY2tzdGFiCiAgICAgICAgICAgIGlmIGZ1bmNzLmNvbnRhaW5zKF91aS5rZXliaW5kcy50d2Vha3MudmFsdWUsICJBbnRpLWJhY2tzdGFiIikgdGhlbgogICAgICAgICAgICAgICAgZm9yIGksIHYgaW4gcGFpcnMoZW50aXR5LmdldF9wbGF5ZXJzKHRydWUpKSBkbwogICAgICAgICAgICAgICAgICAgIGxvY2FsIHBsYXllcl93ZWFwb24gPSBlbnRpdHkuZ2V0X2NsYXNzbmFtZShlbnRpdHkuZ2V0X3BsYXllcl93ZWFwb24odikpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgcGxheWVyX2Rpc3RhbmNlID0gbWF0aC5mbG9vcih2ZWN0b3IoZW50aXR5LmdldF9vcmlnaW4odikpOmRpc3QodmVjdG9yKGVudGl0eS5nZXRfb3JpZ2luKGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCkpKSkgLyA3KQogICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmIHBsYXllcl93ZWFwb24gPT0gIkNLbmlmZSIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBpZiBwbGF5ZXJfZGlzdGFuY2UgPCAzNSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5yZWYueWF3LCAiMTgwIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi55YXdfdmFsdWUsIC0xODApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5yZWYueWF3X2Jhc2UsICJBdCB0YXJnZXRzIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnJlZi55YXdfaml0dGVyLCAiT2ZmIikKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICB9CgogICAgY3R4Lm5vdGlmeSA9IHsKICAgICAgICByZW5kZXJfcmVjdF9vdXRsaW5lID0gZnVuY3Rpb24oeCx5LHcsaCxyLGcsYixhKSAKICAgICAgICAgICAgcmVuZGVyZXIubGluZSh4LCB5LCB4ICsgdywgeSwgcixnLGIsYSkKICAgICAgICAgICAgcmVuZGVyZXIubGluZSh4LCB5LCB4LCB5ICsgaCwgcixnLGIsYSkKICAgICAgICAgICAgcmVuZGVyZXIubGluZSh4LCB5ICsgaCwgeCArIHcsIHkgKyBoLCByLGcsYixhKQogICAgICAgICAgICByZW5kZXJlci5saW5lKHggKyB3LCB5LCB4ICsgdywgeSArIGgsIHIsZyxiLGEpCiAgICAgICAgZW5kLAogICAgICAgIGVhc2VJbk91dCA9IGZ1bmN0aW9uKHQpCgkJCXJldHVybiAodCA+IDAuNSkgYW5kIDQqKCh0LTEpXjMpKzEgb3IgNCp0XjM7CgkJZW5kLAogICAgICAgIGNsYW1wID0gZnVuY3Rpb24odmFsLCBsb3dlciwgdXBwZXIpCgkJCWlmIGxvd2VyID4gdXBwZXIgdGhlbiBsb3dlciwgdXBwZXIgPSB1cHBlciwgbG93ZXIgZW5kCgkJCXJldHVybiBtYXRoLm1heChsb3dlciwgbWF0aC5taW4odXBwZXIsIHZhbCkpCgkJZW5kLAogICAgICAgIHJlbmRlciA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgbG9jYWwgT2Zmc2V0ID0gMAoKICAgICAgICAgICAgaWYgdWkuaXNfbWVudV9vcGVuKCkgYW5kIF91aS52aXN1YWxzLmVuYWJsZS52YWx1ZSB0aGVuCiAgICAgICAgICAgICAgICBjdHgubm90aWZ5LnJlbmRlcl9yZWN0X291dGxpbmUoaGl0bG9nc19wb3MucG9zX3gsIGhpdGxvZ3NfcG9zLnBvc195LCBoaXRsb2dzX3Bvcy5zaXplX3csIGhpdGxvZ3NfcG9zLnNpemVfaCwgMjU1LDI1NSwyNTUsMjU1KQogICAgICAgICAgICAgICAgcmVuZGVyZXIudGV4dChoaXRsb2dzX3Bvcy5wb3NfeCArIGhpdGxvZ3NfcG9zLnNpemVfdyAvMiwgaGl0bG9nc19wb3MucG9zX3ktMTAsIDI1NSwgMjU1LCAyNTUsIDIwMCwgImMiLCBuaWwsICJNMiAtIENFTlRFUiIpCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgaWYgY2xpZW50LmtleV9zdGF0ZSgweDAxKSBhbmQgdWkuaXNfbWVudV9vcGVuKCkgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgbW91c2VfcG9zID0geyB1aS5tb3VzZV9wb3NpdGlvbigpIH0KICAgICAgICAgICAgICAgIGlmIGZ1bmNzLmludGVyc2VjdChoaXRsb2dzX3Bvcy5wb3NfeCwgaGl0bG9nc19wb3MucG9zX3ksIGhpdGxvZ3NfcG9zLnNpemVfdywgaGl0bG9nc19wb3Muc2l6ZV9oKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgbm90aWZ5X2hvdmVyID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgIGhpdGxvZ3NfcG9zLnBvc194ID0gbW91c2VfcG9zWzFdIC0gaGl0bG9nc19wb3Muc2l6ZV93IC8yIAogICAgICAgICAgICAgICAgICAgIGhpdGxvZ3NfcG9zLnBvc195ID0gbW91c2VfcG9zWzJdIC0gaGl0bG9nc19wb3Muc2l6ZV9oIC8yCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgbm90aWZ5X2hvdmVyID0gZmFsc2UKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBpZiBjbGllbnQua2V5X3N0YXRlKDB4MDIpIGFuZCB1aS5pc19tZW51X29wZW4oKSB0aGVuCiAgICAgICAgICAgICAgICBpZiBmdW5jcy5pbnRlcnNlY3QoaGl0bG9nc19wb3MucG9zX3gsIGhpdGxvZ3NfcG9zLnBvc195LCBoaXRsb2dzX3Bvcy5zaXplX3csIGhpdGxvZ3NfcG9zLnNpemVfaCkgdGhlbgogICAgICAgICAgICAgICAgICAgIGhpdGxvZ3NfcG9zLnBvc194ID0gWCAvIDIgLSBoaXRsb2dzX3Bvcy5zaXplX3cgLzIKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIGZvciBpLCBpbmZvX25vdGkgaW4gaXBhaXJzKG5vdGlmeV9kYXRhKSBkbwogICAgICAgICAgICAgICAgaWYgaSA+IDcgdGhlbgogICAgICAgICAgICAgICAgICAgIHRhYmxlLnJlbW92ZShub3RpZnlfZGF0YSwgaSkKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGlmIGluZm9fbm90aS50ZXh0IH49IG5pbCBhbmQgaW5mb19ub3RpLnRleHQgfj0gIiIgdGhlbgogICAgICAgICAgICAgICAgICAgIGlmIGluZm9fbm90aS50aW1lciArIDQuMSA8IGdsb2JhbHMucmVhbHRpbWUoKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGluZm9fbm90aS5mcmFjdGlvbiA9IGN0eC5ub3RpZnkuY2xhbXAoaW5mb19ub3RpLmZyYWN0aW9uIC0gZ2xvYmFscy5mcmFtZXRpbWUoKSAvIDAuMywgMCwgMSkKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIGluZm9fbm90aS5mcmFjdGlvbiA9IGN0eC5ub3RpZnkuY2xhbXAoaW5mb19ub3RpLmZyYWN0aW9uICsgZ2xvYmFscy5mcmFtZXRpbWUoKSAvIDAuMywgMCwgMSkKICAgICAgICAgICAgICAgICAgICAgICAgaW5mb19ub3RpLnRpbWVfbGVmdCA9IGN0eC5ub3RpZnkuY2xhbXAoaW5mb19ub3RpLnRpbWVfbGVmdCArIGdsb2JhbHMuZnJhbWV0aW1lKCkgLyA0LjEsIDAsIDEpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgbG9jYWwgZnJhY3Rpb24gPSBjdHgubm90aWZ5LmVhc2VJbk91dChpbmZvX25vdGkuZnJhY3Rpb24pCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGxvY2FsIHdpZHRoID0gdmVjdG9yKHJlbmRlcmVyLm1lYXN1cmVfdGV4dCgiYyIsIGluZm9fbm90aS50ZXh0KSkKICAgICAgICAgICAgICAgIGxvY2FsIGNvbG9yID0gaW5mb19ub3RpLmNvbG9yCiAgICAgICAgICAgICAgICBsb2NhbCB4LHksdyxoID0gaGl0bG9nc19wb3MucG9zX3gsIGhpdGxvZ3NfcG9zLnBvc195LCBoaXRsb2dzX3Bvcy5zaXplX3csIGhpdGxvZ3NfcG9zLnNpemVfaAoKICAgICAgICAgICAgICAgIGlmIF91aS52aXN1YWxzLm5vdGlmeV9zdHlsZS52YWx1ZSA9PSAiRGVmYXVsdCIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBpZiByZWFkZmlsZSgiaW50ZXIucG5nIikgfj0gbmlsIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHBuZyA9IGltYWdlcy5sb2FkX3BuZyhyZWFkZmlsZSgiaW50ZXIucG5nIikpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHgubV9yZW5kZXI6Z2xvd19tb2R1bGUoeCArICh3LzIpIC0gd2lkdGgueCAvMiAtIDE3LCB5IC0gMjAgKyAzMSAqIGkgKiBmcmFjdGlvbiwgd2lkdGgueCArIDM1LCB3aWR0aC55ICsgMTAsIDEsIDEwLCB7Y29sb3JbMV0sIGNvbG9yWzJdLCBjb2xvclszXSwyNTUgKiBmcmFjdGlvbn0sIHsxNSwxNSwxNSwyNTUgKiBmcmFjdGlvbn0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbmc6ZHJhdyh4ICsgKHcvMikgLSB3aWR0aC54IC8yIC0gMTIsIHkgLSAyMCArIDMxICogaSAqIGZyYWN0aW9uICsgNCwgMTcsIDE1LCBjb2xvclsxXSwgY29sb3JbMl0sIGNvbG9yWzNdLDI1NSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlcmVyLnRleHQoeCArICh3LzIpIC0gd2lkdGgueCAvMiArIDEwLCB5IC0gMjAgKyAzMSAqIGkgKiBmcmFjdGlvbiArIDUsIDI1NSwyNTUsMjU1LDI1NSpmcmFjdGlvbiwgJycsIDAsIGluZm9fbm90aS50ZXh0KQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgX3VpLnZpc3VhbHMubm90aWZ5X3N0eWxlLnZhbHVlID09ICJNb2Rlcm4iIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgaWYgcmVhZGZpbGUoImludGVyLnBuZyIpIH49IG5pbCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBwbmcgPSBpbWFnZXMubG9hZF9wbmcocmVhZGZpbGUoImludGVyLnBuZyIpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4Lm1fcmVuZGVyOmdsb3dfbW9kdWxlKHggKyAody8yKSAtIHdpZHRoLnggLzIgLSAxNywgeSAtIDIwICsgMzEgKiBpICogZnJhY3Rpb24sIHdpZHRoLnggKyAzNSwgd2lkdGgueSArIDEwLCAxMCwgNSwge2NvbG9yWzFdLCBjb2xvclsyXSwgY29sb3JbM10sNjAgKiBmcmFjdGlvbn0sIHsxNSwxNSwxNSwyNTUgKiBmcmFjdGlvbn0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbmc6ZHJhdyh4ICsgKHcvMikgLSB3aWR0aC54IC8yIC0gMTIsIHkgLSAyMCArIDMxICogaSAqIGZyYWN0aW9uICsgNCwgMTcsIDE1LCBjb2xvclsxXSwgY29sb3JbMl0sIGNvbG9yWzNdLDI1NSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlcmVyLnRleHQoeCArICh3LzIpIC0gd2lkdGgueCAvMiArIDEwLCB5IC0gMjAgKyAzMSAqIGkgKiBmcmFjdGlvbiArIDUsIDI1NSwyNTUsMjU1LDI1NSpmcmFjdGlvbiwgJycsIDAsIGluZm9fbm90aS50ZXh0KQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgX3VpLnZpc3VhbHMubm90aWZ5X3N0eWxlLnZhbHVlID09ICJPRyIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJfb2dza2VldF9ib3JkZXIoeCArICh3LzIpIC0gd2lkdGgueCAvMiwgeSArIDI1ICsgMzUgKiBpICogZnJhY3Rpb24sIHdpZHRoLngsIHdpZHRoLnkgKyAyLCAyNTUgKiBmcmFjdGlvbiwgaW5mb19ub3RpLnRleHQpCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBpZiBpbmZvX25vdGkudGltZXIgKyA0LjMgPCBnbG9iYWxzLnJlYWx0aW1lKCkgdGhlbgogICAgICAgICAgICAgICAgICAgIHRhYmxlLnJlbW92ZShub3RpZnlfZGF0YSxpKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgfQoKICAgIGN0eC5pbmRpY2F0b3JzID0gewogICAgICAgIHJlbmRlciA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgbG9jYWwgbWUgPSBlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpCiAgICAgICAgICAgIGlmIG5vdCBlbnRpdHkuaXNfYWxpdmUobWUpIHRoZW4gcmV0dXJuIGVuZAoKICAgICAgICAgICAgbG9jYWwgaXNfZHQgPSB1aS5nZXQocmVmcy5yZWZlcmVuY2VzLmRvdWJsZV90YXBbMl0pCiAgICAgICAgICAgIGxvY2FsIGlzX2hzID0gdWkuZ2V0KHJlZnMucmVmZXJlbmNlcy5vbl9zaG90X2FudGlfYWltWzJdKQogICAgICAgICAgICBsb2NhbCBpc19mZCA9IHVpLmdldChyZWZzLnJlZmVyZW5jZXMuZHVja19wZWVrX2Fzc2lzdCkKICAgICAgICAgICAgbG9jYWwgaXNfcXAgPSB1aS5nZXQocmVmcy5yZWYucXVpY2tfcGVla1syXSkKICAgICAgICAgICAgbG9jYWwgcixnLGIsYSA9IF91aS52aXN1YWxzLmVuYWJsZTpnZXRfY29sb3IoKQoKICAgICAgICAgICAgaWYgdWkuaXNfbWVudV9vcGVuKCkgYW5kIF91aS52aXN1YWxzLmVuYWJsZS52YWx1ZSBhbmQgX3VpLnZpc3VhbHMuaW5kc19zdHlsZS52YWx1ZSB+PSAiT2ZmIiB0aGVuCiAgICAgICAgICAgICAgICBjdHgubm90aWZ5LnJlbmRlcl9yZWN0X291dGxpbmUoaW5kaWNhdG9yX3Bvcy5wb3NfeCwgaW5kaWNhdG9yX3Bvcy5wb3NfeSwgaW5kaWNhdG9yX3Bvcy5zaXplX3csIGluZGljYXRvcl9wb3Muc2l6ZV9oLCAyNTUsMjU1LDI1NSwyNTUpCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgaWYgY2xpZW50LmtleV9zdGF0ZSgweDAxKSBhbmQgdWkuaXNfbWVudV9vcGVuKCkgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgbW91c2VfcG9zID0geyB1aS5tb3VzZV9wb3NpdGlvbigpIH0KICAgICAgICAgICAgICAgIGlmIGZ1bmNzLmludGVyc2VjdChpbmRpY2F0b3JfcG9zLnBvc194LCBpbmRpY2F0b3JfcG9zLnBvc195LCBpbmRpY2F0b3JfcG9zLnNpemVfdywgaW5kaWNhdG9yX3Bvcy5zaXplX2gpIHRoZW4KICAgICAgICAgICAgICAgICAgICBpbmRfaG92ZXIgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgaW5kaWNhdG9yX3Bvcy5wb3NfeSA9IG1vdXNlX3Bvc1syXSAtIGluZGljYXRvcl9wb3Muc2l6ZV9oIC8yCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBpZiBpbmRpY2F0b3JfcG9zLnBvc195ID4gWSAtIGluZGljYXRvcl9wb3Muc2l6ZV9oIG9yIGluZGljYXRvcl9wb3MucG9zX3kgPCA1MCB0aGVuCiAgICAgICAgICAgICAgICAgICAgaW5kaWNhdG9yX3Bvcy5wb3NfeSA9IFkgLzIgKyAyNQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGluZF9ob3ZlciA9IGZhbHNlCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgbG9jYWwgeCx5LHcsaCA9IGluZGljYXRvcl9wb3MucG9zX3gsIGluZGljYXRvcl9wb3MucG9zX3ksIGluZGljYXRvcl9wb3Muc2l6ZV93LCBpbmRpY2F0b3JfcG9zLnNpemVfaAoKICAgICAgICAgICAgLS1fdWkudmlzdWFscy5pbmRzX29wdGlvbnMKICAgICAgICAgICAgLS1mdW5jcy5jb250YWlucwogICAgICAgICAgICBpZiBmdW5jcy5jb250YWlucyhfdWkudmlzdWFscy5pbmRzX29wdGlvbnMudmFsdWUsICJJbiBzY29wZSIpIHRoZW4KICAgICAgICAgICAgICAgIGlmIGVudGl0eS5nZXRfcHJvcChtZSwgIm1fYklzU2NvcGVkIikgPT0gMSB0aGVuCiAgICAgICAgICAgICAgICAgICAgaW5kX2FuaW1fc2NvcGUgPSBjdHgubm90aWZ5LmNsYW1wKGluZF9hbmltX3Njb3BlICsgZ2xvYmFscy5mcmFtZXRpbWUoKSAvIDAuNiwgMCwgMSkKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBpbmRfYW5pbV9zY29wZSA9IGN0eC5ub3RpZnkuY2xhbXAoaW5kX2FuaW1fc2NvcGUgLSBnbG9iYWxzLmZyYW1ldGltZSgpIC8gMC42LCAwLCAxKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgaWYgZnVuY3MuY29udGFpbnMoX3VpLnZpc3VhbHMuaW5kc19vcHRpb25zLnZhbHVlLCAiQWxwaGEiKSB0aGVuCiAgICAgICAgICAgICAgICBpZiBlbnRpdHkuZ2V0X3Byb3AobWUsICJtX2JJc1Njb3BlZCIpID09IDEgdGhlbgogICAgICAgICAgICAgICAgICAgIGluZF9hbmltX3Njb3BlX2FscGhhID0gY3R4Lm5vdGlmeS5jbGFtcChpbmRfYW5pbV9zY29wZV9hbHBoYSAtIGdsb2JhbHMuZnJhbWV0aW1lKCkgLyAwLjYsIDAsIDEpCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgaW5kX2FuaW1fc2NvcGVfYWxwaGEgPSBjdHgubm90aWZ5LmNsYW1wKGluZF9hbmltX3Njb3BlX2FscGhhICsgZ2xvYmFscy5mcmFtZXRpbWUoKSAvIDAuNiwgMCwgMSkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIGxvY2FsIGZyYWN0aW9uID0gY3R4Lm5vdGlmeS5lYXNlSW5PdXQoaW5kX2FuaW1fc2NvcGUpCiAgICAgICAgICAgIGxvY2FsIGZyYWN0aW9uX2FscGhhID0gY3R4Lm5vdGlmeS5lYXNlSW5PdXQoaW5kX2FuaW1fc2NvcGVfYWxwaGEpCgogICAgICAgICAgICAtLXByaW50KGZyYWN0aW9uX2FscGhhKQoKICAgICAgICAgICAgaWYgX3VpLnZpc3VhbHMuaW5kc19zdHlsZS52YWx1ZSA9PSAiUGl4ZWwiIHRoZW4KICAgICAgICAgICAgICAgIGlmIGZ1bmNzLmNvbnRhaW5zKF91aS52aXN1YWxzLmluZHNfb3B0aW9ucy52YWx1ZSwgIkFuaW1hdGVkIikgdGhlbgogICAgICAgICAgICAgICAgICAgIHJlbmRlcmVyLnRleHQoWCAvMiArICh2ZWN0b3IocmVuZGVyZXIubWVhc3VyZV90ZXh0KCJjLSIsICJpbnRlcml0dXMgICIgLi4gZXVwaGVtaWEuYnVpbGQpKS54IC8yICsgNSkgKiBmcmFjdGlvbiwgeSArIDgsIHIsIGcsIGIsIDI1NSAqIGZyYWN0aW9uX2FscGhhLCAiYy0iLCAwLCBmdW5jcy50ZXh0X2ZhZGVfYW5pbWF0aW9uKDUsIHIsIGcsIGIsIDI1NSAqIGZyYWN0aW9uX2FscGhhLCBzdHJpbmcudXBwZXIoImludGVyaXR1cyAgIiAuLiBldXBoZW1pYS5idWlsZCkpKQogICAgICAgICAgICAgICAgICAgIHJlbmRlcmVyLnRleHQoWCAvMiArICh2ZWN0b3IocmVuZGVyZXIubWVhc3VyZV90ZXh0KCJjLSIsIHN0cmluZy51cHBlcihjdHguaGVscHMuZ2V0X3N0YXRlX2RlZmVuc2l2ZShjdHguaGVscHMuc3BlZWQoKSkpKSkueCAvMiArIDIpICogZnJhY3Rpb24sIHkgKyAxNiwgciwgZywgYiwgMjU1ICogZnJhY3Rpb25fYWxwaGEsICJjLSIsIDAsIHN0cmluZy51cHBlcihjdHguaGVscHMuZ2V0X3N0YXRlX2RlZmVuc2l2ZShjdHguaGVscHMuc3BlZWQoKSkpKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIG1faW5kaWNhdG9ycyA9IHt7dGV4dCA9ICJEVCIsIGNvbG9yID0gaXNfZHQgPT0gdHJ1ZSBhbmQge3IsZyxifSBvciB7OTIsOTIsOTJ9fSx7dGV4dCA9ICJPUyIsY29sb3IgPSBpc19ocyA9PSB0cnVlIGFuZCB7cixnLGJ9IG9yIHs5Miw5Miw5Mn19LCB7dGV4dCA9ICJRUCIsIGNvbG9yID0gaXNfcXAgPT0gdHJ1ZSBhbmQge3IsZyxifSBvciB7OTIsOTIsOTJ9fSwge3RleHQgPSAiRkQiLCBjb2xvciA9IGlzX2ZkID09IHRydWUgYW5kIHtyLGcsYn0gb3IgezkyLDkyLDkyfX19CiAgICAgICAgICAgICAgICAgICAgZm9yIGksIHYgaW4gcGFpcnMobV9pbmRpY2F0b3JzKSBkbwogICAgICAgICAgICAgICAgICAgICAgICByLGcsYiA9IHVucGFjayh2LmNvbG9yKQogICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJlci50ZXh0KFggLyAyIC0gMzAgKyBpKjEyICsgMjMgKiBmcmFjdGlvbiwgeSArIDI0LCByLGcsYiwgMjIwICogZnJhY3Rpb25fYWxwaGEsICJjLSIsIDAsIHYudGV4dCkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICByZW5kZXJlci50ZXh0KFggLzIgKyAodmVjdG9yKHJlbmRlcmVyLm1lYXN1cmVfdGV4dCgiYy0iLCAiaW50ZXJpdHVzICAiIC4uIGV1cGhlbWlhLmJ1aWxkKSkueCAvMiArIDUpICogZnJhY3Rpb24sIHkgKyA4LCByLCBnLCBiLCAyNTUgKiBmcmFjdGlvbl9hbHBoYSwgImMtIiwgMCwgc3RyaW5nLnVwcGVyKCJpbnRlcml0dXMgICIgLi4gZXVwaGVtaWEuYnVpbGQpKQogICAgICAgICAgICAgICAgICAgIHJlbmRlcmVyLnRleHQoWCAvMiArICh2ZWN0b3IocmVuZGVyZXIubWVhc3VyZV90ZXh0KCJjLSIsIHN0cmluZy51cHBlcihjdHguaGVscHMuZ2V0X3N0YXRlX2RlZmVuc2l2ZShjdHguaGVscHMuc3BlZWQoKSkpKSkueCAvMiArIDIpICogZnJhY3Rpb24sIHkgKyAxNiwgciwgZywgYiwgMjU1ICogZnJhY3Rpb25fYWxwaGEsICJjLSIsIDAsIHN0cmluZy51cHBlcihjdHguaGVscHMuZ2V0X3N0YXRlX2RlZmVuc2l2ZShjdHguaGVscHMuc3BlZWQoKSkpKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIG1faW5kaWNhdG9ycyA9IHt7dGV4dCA9ICJEVCIsIGNvbG9yID0gaXNfZHQgPT0gdHJ1ZSBhbmQge3IsZyxifSBvciB7OTIsOTIsOTJ9fSx7dGV4dCA9ICJPUyIsY29sb3IgPSBpc19ocyA9PSB0cnVlIGFuZCB7cixnLGJ9IG9yIHs5Miw5Miw5Mn19LCB7dGV4dCA9ICJRUCIsIGNvbG9yID0gaXNfcXAgPT0gdHJ1ZSBhbmQge3IsZyxifSBvciB7OTIsOTIsOTJ9fSwge3RleHQgPSAiRkQiLCBjb2xvciA9IGlzX2ZkID09IHRydWUgYW5kIHtyLGcsYn0gb3IgezkyLDkyLDkyfX19CiAgICAgICAgICAgICAgICAgICAgZm9yIGksIHYgaW4gcGFpcnMobV9pbmRpY2F0b3JzKSBkbwogICAgICAgICAgICAgICAgICAgICAgICByLGcsYiA9IHVucGFjayh2LmNvbG9yKQogICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJlci50ZXh0KFggLyAyIC0gMzAgKyBpKjEyICsgMjMgKiBmcmFjdGlvbiwgeSArIDI0LCByLGcsYiwgMjIwICogZnJhY3Rpb25fYWxwaGEsICJjLSIsIDAsIHYudGV4dCkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIGlmIF91aS52aXN1YWxzLmluZHNfc3R5bGUudmFsdWUgPT0gIk1pbmltYWwiIHRoZW4KICAgICAgICAgICAgICAgIGlmIGZ1bmNzLmNvbnRhaW5zKF91aS52aXN1YWxzLmluZHNfb3B0aW9ucy52YWx1ZSwgIkFuaW1hdGVkIikgdGhlbgogICAgICAgICAgICAgICAgICAgIHJlbmRlcmVyLnRleHQoWCAvMiArICh2ZWN0b3IocmVuZGVyZXIubWVhc3VyZV90ZXh0KCJjLSIsICJpbnRlcml0dXMiKSkueCAvMiArIDcpICogZnJhY3Rpb24sIHkgKyA4LCByLCBnLCBiLCAyNTUgKiBmcmFjdGlvbl9hbHBoYSwgImMiLCAwLCBmdW5jcy50ZXh0X2ZhZGVfYW5pbWF0aW9uKDEuNSwgcixnLGIsYSAqIGZyYWN0aW9uX2FscGhhLCAiaW50ZXJpdHVzIikpCiAgICAgICAgICAgICAgICAgICAgcmVuZGVyZXIudGV4dChYIC8yICsgKHZlY3RvcihyZW5kZXJlci5tZWFzdXJlX3RleHQoImMtIiwgZXVwaGVtaWEuYnVpbGQpKS54IC8yICsgNikgKiBmcmFjdGlvbiwgeSArIDE4LCByLCBnLCBiLCAyNTUqIGZyYWN0aW9uX2FscGhhLCAiYyIsIDAsIGZ1bmNzLnRleHRfZmFkZV9hbmltYXRpb24oMS41LCByLGcsYixhICogZnJhY3Rpb25fYWxwaGEsIGV1cGhlbWlhLmJ1aWxkKSkKICAgICAgICAgICAgICAgIGVsc2UgCiAgICAgICAgICAgICAgICAgICAgcmVuZGVyZXIudGV4dChYIC8yICsgKHZlY3RvcihyZW5kZXJlci5tZWFzdXJlX3RleHQoImMtIiwgImludGVyaXR1cyIpKS54IC8yICsgNykgKiBmcmFjdGlvbiwgeSArIDgsIHIsIGcsIGIsIDI1NSAqIGZyYWN0aW9uX2FscGhhLCAiYyIsIDAsICJpbnRlcml0dXMiKQogICAgICAgICAgICAgICAgICAgIHJlbmRlcmVyLnRleHQoWCAvMiArICh2ZWN0b3IocmVuZGVyZXIubWVhc3VyZV90ZXh0KCJjLSIsIGV1cGhlbWlhLmJ1aWxkKSkueCAvMiArIDYpICogZnJhY3Rpb24sIHkgKyAxOCwgciwgZywgYiwgMjU1KiBmcmFjdGlvbl9hbHBoYSAsICJjIiwgMCwgZXVwaGVtaWEuYnVpbGQpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBpZiBfdWkudmlzdWFscy5pbmRzX3N0eWxlLnZhbHVlID09ICJNb2Rlcm4iIHRoZW4KICAgICAgICAgICAgICAgIGlmIGZ1bmNzLmNvbnRhaW5zKF91aS52aXN1YWxzLmluZHNfb3B0aW9ucy52YWx1ZSwgIkFuaW1hdGVkIikgdGhlbgogICAgICAgICAgICAgICAgICAgIHJlbmRlcmVyLnRleHQoWCAvMiArICh2ZWN0b3IocmVuZGVyZXIubWVhc3VyZV90ZXh0KCJjLSIsICJpbnRlcml0dXMiKSkueCAvMiArIDcpICogZnJhY3Rpb24sIHkgKyA4LCByLCBnLCBiLCAyNTUgKiBmcmFjdGlvbl9hbHBoYSwgImMiLCAwLCB0b19qaXR0ZXIgYW5kICJcYSIuLmZ1bmNzLnJnYmFfdG9faGV4KHIsZyxiLDI1NSkuLiJpbnRlXGFGRkZGRkZGRnJpdHVzIiBvciAiXGFGRkZGRkZGRmludGVcYSIuLmZ1bmNzLnJnYmFfdG9faGV4KHIsZyxiLDI1NSkuLiJyaXR1cyIpCiAgICAgICAgICAgICAgICAgICAgcmVuZGVyZXIudGV4dChYIC8yICsgKHZlY3RvcihyZW5kZXJlci5tZWFzdXJlX3RleHQoImMtIiwgZXVwaGVtaWEuYnVpbGQpKS54IC8yICsgNikgKiBmcmFjdGlvbiwgeSArIDE4LCByLCBnLCBiLCAyNTUqIGZyYWN0aW9uX2FscGhhLCAiYyIsIDAsIGZ1bmNzLnRleHRfZmFkZV9hbmltYXRpb24oMS41LCByLGcsYixhICogZnJhY3Rpb25fYWxwaGEsIGV1cGhlbWlhLmJ1aWxkKSkKICAgICAgICAgICAgICAgICAgICBsb2NhbCBtX2luZGljYXRvcnMgPSB7e3RleHQgPSAiZHQiLCBjb2xvciA9IGlzX2R0ID09IHRydWUgYW5kIHtyLGcsYn0gb3IgezkyLDkyLDkyfX0se3RleHQgPSAib3MiLGNvbG9yID0gaXNfaHMgPT0gdHJ1ZSBhbmQge3IsZyxifSBvciB7OTIsOTIsOTJ9fSwge3RleHQgPSAicXAiLCBjb2xvciA9IGlzX3FwID09IHRydWUgYW5kIHtyLGcsYn0gb3IgezkyLDkyLDkyfX0sIHt0ZXh0ID0gImZkIiwgY29sb3IgPSBpc19mZCA9PSB0cnVlIGFuZCB7cixnLGJ9IG9yIHs5Miw5Miw5Mn19fQogICAgICAgICAgICAgICAgICAgIGZvciBpLCB2IGluIHBhaXJzKG1faW5kaWNhdG9ycykgZG8KICAgICAgICAgICAgICAgICAgICAgICAgcixnLGIgPSB1bnBhY2sodi5jb2xvcikKICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVyZXIudGV4dChYIC8gMiAtIDMwICsgaSoxMiArIDIzICogZnJhY3Rpb24sIHkgKyAyOCwgcixnLGIsIDIyMCAqIGZyYWN0aW9uX2FscGhhLCAiYyIsIDAsIHYudGV4dCkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVsc2UgCiAgICAgICAgICAgICAgICAgICAgcmVuZGVyZXIudGV4dChYIC8yICsgKHZlY3RvcihyZW5kZXJlci5tZWFzdXJlX3RleHQoImMtIiwgImludGVyaXR1cyIpKS54IC8yICsgNykgKiBmcmFjdGlvbiwgeSArIDgsIHIsIGcsIGIsIDI1NSAqIGZyYWN0aW9uX2FscGhhLCAiYyIsIDAsICJpbnRlcml0dXMiKQogICAgICAgICAgICAgICAgICAgIHJlbmRlcmVyLnRleHQoWCAvMiArICh2ZWN0b3IocmVuZGVyZXIubWVhc3VyZV90ZXh0KCJjLSIsIGV1cGhlbWlhLmJ1aWxkKSkueCAvMiArIDYpICogZnJhY3Rpb24sIHkgKyAxOCwgciwgZywgYiwgMjU1KiBmcmFjdGlvbl9hbHBoYSAsICJjIiwgMCwgZXVwaGVtaWEuYnVpbGQpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgbV9pbmRpY2F0b3JzID0ge3t0ZXh0ID0gImR0IiwgY29sb3IgPSBpc19kdCA9PSB0cnVlIGFuZCB7cixnLGJ9IG9yIHs5Miw5Miw5Mn19LHt0ZXh0ID0gIm9zIixjb2xvciA9IGlzX2hzID09IHRydWUgYW5kIHtyLGcsYn0gb3IgezkyLDkyLDkyfX0sIHt0ZXh0ID0gInFwIiwgY29sb3IgPSBpc19xcCA9PSB0cnVlIGFuZCB7cixnLGJ9IG9yIHs5Miw5Miw5Mn19LCB7dGV4dCA9ICJmZCIsIGNvbG9yID0gaXNfZmQgPT0gdHJ1ZSBhbmQge3IsZyxifSBvciB7OTIsOTIsOTJ9fX0KICAgICAgICAgICAgICAgICAgICBmb3IgaSwgdiBpbiBwYWlycyhtX2luZGljYXRvcnMpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgIHIsZyxiID0gdW5wYWNrKHYuY29sb3IpCiAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlcmVyLnRleHQoWCAvIDIgLSAzMCArIGkqMTIgKyAyMyAqIGZyYWN0aW9uLCB5ICsgMjgsIHIsZyxiLCAyMjAgKiBmcmFjdGlvbl9hbHBoYSwgImMiLCAwLCB2LnRleHQpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICB9CgogICAgY3R4LndhdGVybWFyayA9IHsKICAgICAgICB0YWJsZV9sZXJwID0gZnVuY3Rpb24oYSwgYiwgcGVyY2VudGFnZSkKICAgICAgICAgICAgbG9jYWwgcmVzdWx0ID0ge30KICAgICAgICAgICAgZm9yIGk9MSwgI2EgZG8KICAgICAgICAgICAgICAgIHJlc3VsdFtpXSA9IGxlcnAoYVtpXSwgYltpXSwgcGVyY2VudGFnZSkKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHJldHVybiByZXN1bHQKICAgICAgICBlbmQsCiAgICAgICAgcm91bmQgPSBmdW5jdGlvbihudW0sIG51bURlY2ltYWxQbGFjZXMpCiAgICAgICAgICAgIGxvY2FsIG11bHQgPSAxMF4obnVtRGVjaW1hbFBsYWNlcyBvciAwKQogICAgICAgICAgICByZXR1cm4gbWF0aC5mbG9vcihudW0gKiBtdWx0ICsgMC41KSAvIG11bHQKICAgICAgICBlbmQsCiAgICAgICAgY2xhbXAgPSBmdW5jdGlvbihjdXJfdmFsLCBtaW5fdmFsLCBtYXhfdmFsKQogICAgICAgICAgICByZXR1cm4gbWF0aC5taW4obWF0aC5tYXgoY3VyX3ZhbCwgbWluX3ZhbCksIG1heF92YWwpCiAgICAgICAgZW5kLAogICAgICAgIGNvbG9yZWQgPSBmdW5jdGlvbihyLGcsYixhLCB0ZXh0LCByMixnMixiMixhMikgCiAgICAgICAgICAgIHJldHVybiAiXGEiLi5mdW5jcy5yZ2JhX3RvX2hleChyLGcsYixhKS4udGV4dC4uIlxhIi4uZnVuY3MucmdiYV90b19oZXgocjIsZzIsYjIsYTIpCiAgICAgICAgZW5kLAogICAgICAgIGxlcnBfY29sb3JfeWVsbG93X3JlZCA9IGZ1bmN0aW9uKHZhbCwgbWF4X25vcm1hbCwgbWF4X3llbGxvdywgbWF4X3JlZCwgZGVmYXVsdCwgeWVsbG93LCByZWQpCiAgICAgICAgICAgIGRlZmF1bHQgPSBkZWZhdWx0IG9yIHsyNTUsIDI1NSwgMjU1fQogICAgICAgICAgICB5ZWxsb3cgPSB5ZWxsb3cgb3IgezIzMCwgMjEwLCA0MH0KICAgICAgICAgICAgcmVkID0gcmVkIG9yIHsyNTUsIDMyLCAzMn0KICAgICAgICAgICAgaWYgdmFsID4gbWF4X3llbGxvdyB0aGVuCiAgICAgICAgICAgICAgICByZXR1cm4gdW5wYWNrKGN0eC53YXRlcm1hcmsudGFibGVfbGVycCh5ZWxsb3csIHJlZCwgY3R4LndhdGVybWFyay5jbGFtcCgodmFsLW1heF95ZWxsb3cpLyhtYXhfcmVkLW1heF95ZWxsb3cpLCAwLCAxKSkpCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHJldHVybiB1bnBhY2soY3R4LndhdGVybWFyay50YWJsZV9sZXJwKGRlZmF1bHQsIHllbGxvdywgY3R4LndhdGVybWFyay5jbGFtcCgodmFsLW1heF9ub3JtYWwpLyhtYXhfeWVsbG93LW1heF9ub3JtYWwpLCAwLCAxKSkpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCwKICAgICAgICBnZXRfZnBzID0gZnVuY3Rpb24oKQogICAgICAgICAgICBmdF9wcmV2ID0gZnRfcHJldiAqIDAuOSArIGdsb2JhbHMuYWJzb2x1dGVmcmFtZXRpbWUoKSAqIDAuMQogICAgICAgICAgICByZXR1cm4gY3R4LndhdGVybWFyay5yb3VuZCgxIC8gZnRfcHJldikKICAgICAgICBlbmQsCiAgICAgICAgcmVuZGVyID0gZnVuY3Rpb24oKQogICAgICAgICAgICBsb2NhbCBtZSA9IGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCkKICAgICAgICAgICAgaWYgbm90IGVudGl0eS5pc19hbGl2ZShtZSkgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgIGxvY2FsIHIsZyxiLGEgPSBfdWkudmlzdWFscy5lbmFibGU6Z2V0X2NvbG9yKCkKICAgICAgICAgICAgbG9jYWwgcG9zID0gX3VpLnZpc3VhbHMud2F0ZXJtYXJrc19wb3M6Z2V0KCkKICAgICAgICAgICAgbG9jYWwgb3B0cyA9IF91aS52aXN1YWxzLndhdGVybWFya19vcHRpb25zOmdldCgpCiAgICAgICAgICAgIGxvY2FsIHgsIHkgPSBwb3MgPT0gIkJvdHRvbSIgYW5kIFggLyAyIG9yIDQ1LCBwb3MgPT0gIkJvdHRvbSIgYW5kIFkgLSAxMCBvciBZIC8gMiAtIDQwCiAgICAgICAgICAgIC0tZnVuY3MuY29udGFpbnMoX3VpLnZpc3VhbHMuaW5kc19vcHRpb25zLnZhbHVlLCAiQW5pbWF0ZWQiKQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgZW50aXR5LmdldF9wcm9wKG1lLCAibV9iSXNTY29wZWQiKSA9PSAxIHRoZW4KICAgICAgICAgICAgICAgIGlmIGZ1bmNzLmNvbnRhaW5zKG9wdHMsICJBbHBoYSIpIHRoZW4KICAgICAgICAgICAgICAgICAgICB3YXRlcm1hcmtfYWxwaGEgPSBjdHgubm90aWZ5LmNsYW1wKHdhdGVybWFya19hbHBoYSAtIGdsb2JhbHMuZnJhbWV0aW1lKCkgLyAwLjYsIDAsIDEpCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgd2F0ZXJtYXJrX2FscGhhID0gY3R4Lm5vdGlmeS5jbGFtcCh3YXRlcm1hcmtfYWxwaGEgKyBnbG9iYWxzLmZyYW1ldGltZSgpIC8gMC42LCAwLCAxKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHdhdGVybWFya19hbHBoYSA9IGN0eC5ub3RpZnkuY2xhbXAod2F0ZXJtYXJrX2FscGhhICsgZ2xvYmFscy5mcmFtZXRpbWUoKSAvIDAuNiwgMCwgMSkKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBsb2NhbCBmcmFjdGlvbiA9IGN0eC5ub3RpZnkuZWFzZUluT3V0KHdhdGVybWFya19hbHBoYSkKICAgICAgICAgICAgbG9jYWwgd2F0ZXJtYXJrX3RleHQgPSAiXGEiLi5mdW5jcy5yZ2JhX3RvX2hleCgyMDAsMjAwLDIwMCwyMzAgKiBmcmFjdGlvbikuLiJJIE4gVCBFICIuLiBmdW5jcy50ZXh0X2ZhZGVfYW5pbWF0aW9uKC0yLCByLGcsYiwgMjU1ICogZnJhY3Rpb24sICJSIEkgVCBVIFMiKQoKICAgICAgICAgICAgaWYgZnVuY3MuY29udGFpbnMob3B0cywgIkRlc3luYyIpIHRoZW4KICAgICAgICAgICAgICAgIHdhdGVybWFya190ZXh0ID0gdG9faml0dGVyIGFuZCAiXGEiLi5mdW5jcy5yZ2JhX3RvX2hleChyLGcsYiwyNTUqZnJhY3Rpb24pLi4iSSBOIFQgRSBcYSIuLmZ1bmNzLnJnYmFfdG9faGV4KDIwMCwyMDAsMjAwLDIzMCAqIGZyYWN0aW9uKS4uIlIgSSBUIFUgUyIgb3IgIlxhIi4uZnVuY3MucmdiYV90b19oZXgoMjAwLDIwMCwyMDAsMjMwICogZnJhY3Rpb24pLi4iSSBOIFQgRSBcYSIuLmZ1bmNzLnJnYmFfdG9faGV4KHIsZyxiLDI1NSpmcmFjdGlvbikuLiJSIEkgVCBVIFMiCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHdhdGVybWFya190ZXh0ID0gIlxhIi4uZnVuY3MucmdiYV90b19oZXgoMjAwLDIwMCwyMDAsMjMwICogZnJhY3Rpb24pLi4iSSBOIFQgRSAiLi4gZnVuY3MudGV4dF9mYWRlX2FuaW1hdGlvbigtMiwgcixnLGIsIDI1NSAqIGZyYWN0aW9uLCAiUiBJIFQgVSBTIikKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBsb2NhbCBmaW5hbF90ZXh0ID0gdG9faml0dGVyIGFuZCBmdW5jcy5ncmFkaWVudF90ZXh0KHIsZyxiLCAyNTUqIGZyYWN0aW9uLCByLGcsYiwgNTUsICJJTlRFUklUVVMuUkVEIikgb3IgZnVuY3MuZ3JhZGllbnRfdGV4dChyLGcsYiwgNTUsIHIsZyxiLCAyNTUqIGZyYWN0aW9uLCAiSU5URVJJVFVTLlJFRCIpCiAgICAgICAgICAgIGxvY2FsIGZsYWdhX2NvbG9yID0gcG9zID09ICJCb3R0b20iIGFuZCB7cixnLGIsIDB9IG9yIHtyLGcsYiwyNTV9CiAgICAgICAgICAgIGxvY2FsIGZsYWdhX2NvbG9yMiA9IHBvcyA9PSAiQm90dG9tIiBhbmQge3IsZyxiLDI1NX0gb3Ige3IsZyxiLDB9CgogICAgICAgICAgICBpZiBfdWkudmlzdWFscy53YXRlcm1hcmtzLnZhbHVlID09ICJEZWZhdWx0IiB0aGVuCiAgICAgICAgICAgICAgICByZW5kZXJlci50ZXh0KHgsIHksMTUwLCAxNTAsIDE1MCwgMjU1ICogZnJhY3Rpb24sICJjIiwgbmlsLCB3YXRlcm1hcmtfdGV4dCkKICAgICAgICAgICAgZWxzZWlmIF91aS52aXN1YWxzLndhdGVybWFya3MudmFsdWUgPT0gIk1pbmltYWwiIHRoZW4KICAgICAgICAgICAgICAgIHJlbmRlcmVyLnRleHQocG9zID09ICJCb3R0b20iIGFuZCB4IG9yIHggKyAyNSwgeSwgciwgZywgYiwgMjU1ICogZnJhY3Rpb24sICJjIiwgMCwgd2F0ZXJtYXJrX3RleHQuLiIgXGEiLi5mdW5jcy5yZ2JhX3RvX2hleChyLGcsYiwyNTUgKiBmcmFjdGlvbikuLiJbIi4uc3RyaW5nLnVwcGVyKGV1cGhlbWlhLmJ1aWxkKS4uIl0iKQogICAgICAgICAgICBlbHNlaWYgX3VpLnZpc3VhbHMud2F0ZXJtYXJrcy52YWx1ZSA9PSAiT2ZmIiB0aGVuCiAgICAgICAgICAgICAgICAtLWxvY2FsIHBuZyA9IGltYWdlcy5sb2FkX3BuZyhyZWFkZmlsZSgiaW50ZXIucG5nIikpCiAgICAgICAgICAgICAgICAtLXBuZzpkcmF3KFgvMiAtIDcsIFkgLSAzMCwgMTUsIDE1LCByLGcsYiwyNTUpCiAgICAgICAgICAgICAgICByZW5kZXJlci50ZXh0KFgvMiwgWSAtIDEwLCByLCBnLCBiLCAyNTUsICJjIiwgMCwgImludGVyaXR1cy5yZWQiKQogICAgICAgICAgICBlbHNlaWYgX3VpLnZpc3VhbHMud2F0ZXJtYXJrcy52YWx1ZSA9PSAiTGVnYWN5IiB0aGVuCiAgICAgICAgICAgICAgICByZW5kZXJlci50ZXh0KHBvcyA9PSAiQm90dG9tIiBhbmQgeCArIDEgb3IgeCArIDEsIHkgKyAxLCAwLDAsMCwyNTUqIGZyYWN0aW9uLCAiY2IiLCAwLCAiSU5URVJJVFVTLlJFRCIpCiAgICAgICAgICAgICAgICByZW5kZXJlci50ZXh0KHBvcyA9PSAiQm90dG9tIiBhbmQgeCArIDEgb3IgeCArIDEsIHkgLSAxLCAwLDAsMCwyNTUqIGZyYWN0aW9uLCAiY2IiLCAwLCAiSU5URVJJVFVTLlJFRCIpCiAgICAgICAgICAgICAgICByZW5kZXJlci50ZXh0KHBvcyA9PSAiQm90dG9tIiBhbmQgeCAtIDEgb3IgeCAtIDEsIHkgLSAxLCAwLDAsMCwyNTUqIGZyYWN0aW9uLCAiY2IiLCAwLCAiSU5URVJJVFVTLlJFRCIpCiAgICAgICAgICAgICAgICByZW5kZXJlci50ZXh0KHBvcyA9PSAiQm90dG9tIiBhbmQgeCAtIDEgb3IgeCAtIDEsIHkgKyAxLCAwLDAsMCwyNTUqIGZyYWN0aW9uLCAiY2IiLCAwLCAiSU5URVJJVFVTLlJFRCIpCiAgICAgICAgICAgICAgICByZW5kZXJlci50ZXh0KHBvcyA9PSAiQm90dG9tIiBhbmQgeCBvciB4LCB5LCAyNTUsIDI1NSwgMjU1LCAyNTUqIGZyYWN0aW9uLCAiY2IiLCBuaWwsIGZpbmFsX3RleHQpCiAgICAgICAgICAgIGVsc2VpZiBfdWkudmlzdWFscy53YXRlcm1hcmtzLnZhbHVlID09ICJJbnRlcml0dXMiIHRoZW4KICAgICAgICAgICAgICAgIHJlbmRlcmVyLnRleHQocG9zID09ICJCb3R0b20iIGFuZCB4IG9yIHgsIHksIDI1NSwgMjU1LCAyNTUsIDI1NSogZnJhY3Rpb24sICJjYiIsIG5pbCwgZmluYWxfdGV4dCkKICAgICAgICAgICAgZWxzZWlmIF91aS52aXN1YWxzLndhdGVybWFya3MudmFsdWUgPT0gIkNvdW50cnktQmFzZWQiIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIHRleHRfd2lkdGggPSB2ZWN0b3IocmVuZGVyZXIubWVhc3VyZV90ZXh0KCIiLCBzdHJpbmcudXBwZXIoZXVwaGVtaWEudXNlcm5hbWUuLiIgWyIgLi4gZXVwaGVtaWEuYnVpbGQgLi4gIl0iKSkpCiAgICAgICAgICAgICAgICAtLWxvY2FsIGZsYWcgPSBpbWFnZXMubG9hZF9wbmcocmVhZGZpbGUoImZsYWdfIi4ucGFub3JhbWEub3BlbigpLk15UGVyc29uYUFQSS5HZXRNeUNvdW50cnlDb2RlKCk6bG93ZXIoKS4uIi5wbmciKSkKICAgICAgICAgICAgICAgIHJlbmRlcmVyLmdyYWRpZW50KHBvcyA9PSAiQm90dG9tIiBhbmQgeCAtIDI1IG9yIHggLSA0NCwgeSAtIDE1LCAyNSArIHRleHRfd2lkdGgueCArIDE1LCAyNSwgZmxhZ2FfY29sb3JbMV0sIGZsYWdhX2NvbG9yWzJdLCBmbGFnYV9jb2xvclszXSwgcG9zID09ICJCb3R0b20iIGFuZCAwIG9yIGZsYWdhX2NvbG9yWzRdKiBmcmFjdGlvbiwgZmxhZ2FfY29sb3IyWzFdLCBmbGFnYV9jb2xvcjJbMl0sIGZsYWdhX2NvbG9yMlszXSwgcG9zID09ICJCb3R0b20iIGFuZCAwIG9yIGZsYWdhX2NvbG9yMls0XSogZnJhY3Rpb24sIHRydWUpCiAgICAgICAgICAgICAgICBmbGFnOmRyYXcocG9zID09ICJCb3R0b20iIGFuZCB4IC0gNDUgb3IgeCAtIDQyLCB5IC0gMTAsIDI1LDE2LjUsIDI1NSwyNTUsMjU1LDI1NSogZnJhY3Rpb24pCiAgICAgICAgICAgICAgICByZW5kZXJlci50ZXh0KHBvcyA9PSAiQm90dG9tIiBhbmQgeCAtIDE3IG9yIDMyLCBwb3MgPT0gIkJvdHRvbSIgYW5kIHkgLSAxMSBvciB5IC0gMTEsIDI1NSwyNTUsMjU1LDI1NSogZnJhY3Rpb24sICItIiwgMCwgIklOVEVSSVRVUy5SRUQiKQogICAgICAgICAgICAgICAgcmVuZGVyZXIudGV4dChwb3MgPT0gIkJvdHRvbSIgYW5kIHggLSAxNyBvciAzMiwgcG9zID09ICJCb3R0b20iIGFuZCB5IC0gMyBvciB5IC0gMywgMjU1LDI1NSwyNTUsMjU1KiBmcmFjdGlvbiwgIi0iLCAwLCBzdHJpbmcudXBwZXIoZXVwaGVtaWEudXNlcm5hbWUuLiIgW1xhIi4uIGZ1bmNzLnJnYmFfdG9faGV4KHIsZyxiLDI1NSogZnJhY3Rpb24pIC4uIGV1cGhlbWlhLmJ1aWxkIC4uICJcYSIuLmZ1bmNzLnJnYmFfdG9faGV4KDI1NSwyNTUsMjU1LDI1NSogZnJhY3Rpb24pLi4iXSIpKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0KCiAgICBjdHguZ2V0X2RlZmVuc2l2ZSA9IHsKICAgICAgICBnZXQgPSBmdW5jdGlvbigpCiAgICAgICAgICAgIGxvY2FsIGRpZmYgPSBzaW1fZGlmZigpCgogICAgICAgICAgICBpZiBkaWZmIDw9IC0xIHRoZW4KICAgICAgICAgICAgICAgIHRvX2RyYXcgPSAieWVzIgogICAgICAgICAgICAgICAgdG9fdXAgPSAieWVzIgogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0KCiAgICBjdHguZGVmZW5zaXZlX2luZCA9IHsKICAgICAgICByZW5kZXIgPSBmdW5jdGlvbigpCiAgICAgICAgICAgIGxvY2FsIGRlZmVuc2l2ZSA9IHtfdWkudmlzdWFscy5lbmFibGU6Z2V0X2NvbG9yKCl9CgogICAgICAgICAgICBpZiB0b19kcmF3ID09ICJ5ZXMiIGFuZCB1aS5nZXQocmVmcy5yZWYuZG91YmxldGFwWzJdKSBhbmQgZnVuY3MuY29udGFpbnMoX3VpLnZpc3VhbHMub3RoZXJzLnZhbHVlLCAiRGVmZW5zaXZlIikgdGhlbgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIGRyYXdfYXJ0ID0gdG9fZHJhd190aWNrcyAqIDEwMCAvIDI3CiAgICAgICAgICAgICAgICBsb2NhbCB3YXJuaW5nID0gaW1hZ2VzLmxvYWRfcG5nKGJhc2U2NC5kZWNvZGUoImlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFESUFBQUF5Q0FNQUFBQXA0WGlEQUFBQUFYTlNSMElCMmNrc2Z3QUFBQWx3U0ZsekFBQUxFd0FBQ3hNQkFKcWNHQUFBQW54UVRGUkZBQUFBLy8rOS8vKzkvLys5Ly8rOS8vKzkvLysrLy8vMS8vLy8vLy8rLy8vZy8vKzkvLys5Ly8rOS8vKzkvLys5Ly8rOS8vKzkvLys5Ly8vWS8vL2gvLys5Ly8rOS8vKzkvLys5Ly8rOS8vKzkvLys5Ly8vdy8vLzYvLy9BLy8rOS8vKzkvLys5Ly8vSy8vLy8vLy9qLy8rOS8vKzkvLys5Ly8rOS8vKzkvLy9sLy8vOS8vL0YvLys5Ly8rOS8vKzkvLys5Ly8rOS8vL0IvLy83Ly8vby8vKzkvLys5Ly8rOS8vKzkvLys5Ly8rOS8vL2IvLy9LLy8rOS8vKzkvLys5Ly8rOS8vKzkvLys5Ly8vMC8vL3UvLys5Ly8rOS8vKzkvLys5Ly8vUC8vL1IvLys5Ly8rOS8vKzkvLys5Ly8vci8vKzkvLys5Ly8rOS8vKzkvLys5Ly8rOS8vL0UvLy85Ly8vWi8vKzkvLys5Ly8rOS8vKzkvLys5Ly8vZy8vLzUvLysvLy8rOS8vKzkvLys5Ly8rOS8vKysvLy80Ly8vZy8vKzkvLy9XLy8vOC8vL0QvLys5Ly8rOS8vKzkvLy92Ly8vbS8vKzkvLy9KLy8vKy8vL0kvLys5Ly8rOS8vL3QvLys5Ly8rOS8vKzkvLys5Ly8vQi8vL1AvLys5Ly8rOS8vKzkvLy96Ly8rOS8vKzkvLys5Ly8rOS8vLzAvLy8zLy8vUC8vLzQvLys5Ly8vVy8vKzkvLy9GLy8vby8vKzkvLys5Ly8vay8vLzQvLy9DLy8vNi8vL1MvLys5Ly8vMy8vL3AvLys5Ly8rOS8vKzkvLys5Ly8rOS8vL20vLy81Ly8vQy8vKzkvLy9WLy8rOS8vKzkvLy9xLy8vNi8vL0UvLys5Ly8vWC8vKzkvLy9SLy8vcy8vKzkvLy9GLy8rOS8vL1ovLy9SLy8rOS8vLzgvLy9JLy8vYi8vL1IvLy94Ly8vZS8vL1IvLysrLy8rOS8vL24vLy9MLy8rOS8vL2gvLy9TLy8vMC8vKysvLy9wLy8vKy8vL04vLysrLy8vNi8vL2svLys5Ly8vVy8vLzMvLysvLy8vdS8vL1QvLy83Ly8vcy8vLzQvLy81Ly8vQ01ob1hjQUFBQU5SMFVrNVRBQUVKRlN0TGNPWC8rNHM2SHcwREJDRS9aN1NoUlNRUEJ5NVZoZXYyZVVZTWJLLyswM0pDQmhKUjR2eWtaRGtaRzJhZyt1U0lWQk1sU1h6U3RXOUFGak5kbFBMcmpsZ3djNy9DZFNJdGl1ZGVHQW9jUEdxcS9jNTdFQ2hPZ2R2NG5HTTNObUdhOXRsNHlmeW1hVnFRN09LTHRQN0JVakhwdUlkZ1E2TE52NTkrOEt5WFR6VHgyYjNuS3AxYm1kcDJTTVgzbk83RmVkemxqWUtXcUw3ajk2UzB5SENkNS9tbWJjd2V3T21FcTVuUXY1UDdyOU8rN3RXNWxYL2VzaWZWc2ZDUzF2MnRmZlRQVjVudGhzR2E2N3ZQMkZiNThGNitBQUFETlVsRVFWUjRuSTJVOTE4U2NSakhoY082WWh4V0xLMDhNMVltWWhiRFFoRkRxQ0JsbUtWUW9iWmRXVkJCa1NZMnpOSjJhV1dsTGN2MkhyUnM3L3FIdW1OMDFIRUh6OC9mOSt0NVA5L3Y1L3VrcE9DS1FnVm9xV1BHZ3RFYU41N09ZTEx3NTJJS1lyTFRKa3dFc1pyRTRmSWdNb0xDQndUcEdaTXhZc3JVVEM2UHRBc0xacVJsVGN2R2tPbENFUnNtUXloaUNVMmFNUU1qY21ibXl2S29GREtFS3BmbHp5ckFrTmx6RkRTbG1BU2hRRHlWdW5BdVJtVFAweFF4eUwzNHhkb1NYU21Hek5lWEdRQSttUmVMeVJZWkY4VGM4TUpGSEJNVEl2TVNLODNwaThzeG9sUlhvYldRRHMreTJ1eVZTNm93Wk9reXRZcEgyZ1Nxcm5FNGwyUEVpcFd1MmtRM25GZFh2Mm8xaHF4eE9tb2taRGVjQXZHNG1XdlhZY1Q2RFExMm01WDhoZ0ZEWTFNemhyUnNMRE5ZckJDRnVBMGFMMDByRnE5Tm01MXVqMDBDOHlFV0FZU0wxNWF0Mjd3K2owb3VnWW5HQ2NWcmUweThkdmgzdHVVcmZGb1RZSTNmQmhldmRyL2Z2NnZEMlJEb1pQRGl0d25IYXplSXF6MmNHb0lvczJDMlNMZ1hUNEQ3QW1hQ1lJb2xYZEtNY2p5UnZWOUs4R0VRTDAvM2dTbzhjckNuVjFVZEgwSEM0ajJFSnc0ZmNjbHM4ZjhZaFdycGJEeUtSNDRkVCsxU3hoOEZTWXM1OVFTT09IbXF1ek9QNkZuRTFleGFkMVpmLytremZ2L1pLREZ3cnJLSVRmQXF5RXRhQWE3V0o2MDM2cy83QjZMSWhVSUhUY2tueWpKRkRDdmxYRE05TURpMEkwcGMxSmZVeVFtMFVJUUY4YTA4d0dSMzlVZTlMbDIrSWpJUmFZVWhoSUxsc3R5aHFOZlZ0Z0FOSU5TS0ZNczZYQ1M4RmlHdU4xWFV5V0ZDclVnaCt5SXdFdkVxdUtIeGNlTy9lNndha21idnpZalhMYWZVREZBVGFJVzlib2VKNWp2ZVdodE10c1ArOTdwN2I1Q1RXQ3ZzMVJIMnV0L25GaFFuMUFwNURUNElFUTkxOWJKaDB2Mk5lZlcxb0VST3F6RlRSYjRuLzNwVjZFSmVqMFlVaGlTMFFsNmF4eWpSL3NSRlQwWUw5WEk4ZllZUVZjK052Y0VrdE1KYlNZOTZ2UmhKUjNaeFlpM1VLNjN5SlVLOGV1MnlKNldGZUFYVlBXOUFjUFN0TURrdDVJc0JBdmU3OXlENG9WRGhzUkQvcTM5R3NXZy9mZ0xCejErOGRrWlNXdWdpMHlxK2dxUGZjamxCZ2kyRVJ5d0M5WGZ3UjcxYWtKeFdhSkVGNlQ5Ly9mWVpocGxrcy84QlpwelFKOXNMa1NnQUFBQUFTVVZPUks1Q1lJST0iKSkKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB3YXJuaW5nOmRyYXcoWCAvIDIgLSAyMCwgWSAvIDIgKiAwLjUgLSA0NSwgbmlsLCAzNSwgZGVmZW5zaXZlWzFdLGRlZmVuc2l2ZVsyXSxkZWZlbnNpdmVbM10sIDI1NSkKICAgICAgICAgICAgICAgIGN0eC5tX3JlbmRlcjpnbG93X21vZHVsZShYIC8gMiAtIDIgLSAobWF0aC5mbG9vcihkcmF3X2FydCkgLyAyKSwgWSAvIDIgICogMC41LG1hdGguZmxvb3IoZHJhd19hcnQpLDQsIDEwLDIse2RlZmVuc2l2ZVsxXSxkZWZlbnNpdmVbMl0sZGVmZW5zaXZlWzNdLDE4MH0sIHtkZWZlbnNpdmVbMV0sZGVmZW5zaXZlWzJdLGRlZmVuc2l2ZVszXSwyNTV9KQoKICAgICAgICAgICAgICAgIC0tIGN0eC5tX3JlbmRlcjpnbG93X21vZHVsZShYIC8gMiAtIDUwLCBZIC8gMiAqIDAuNSwgMTAwLDQsIDEwLDIse2RlZmVuc2l2ZVsxXSxkZWZlbnNpdmVbMl0sZGVmZW5zaXZlWzNdLDUwfSwgezMwLDMwLDMwLDEwMH0pCiAgICAgICAgICAgICAgICAtLSByZW5kZXJlci5ibHVyKFggLyAyIC0gNTAsIFkgLyAyICAqIDAuNSwtZHJhd19hcnQgLzIsIDEwMCwgNiwgMSwgMSkKICAgICAgICAgICAgICAgIC0tIHJlbmRlcmVyLnJlY3RhbmdsZShYIC8gMiwgWSAvIDIgICogMC41LC1kcmF3X2FydCAvMiArIDEsNCxkZWZlbnNpdmVbMV0sZGVmZW5zaXZlWzJdLGRlZmVuc2l2ZVszXSwyNTUpCiAgICAgICAgICAgICAgICAtLSByZW5kZXJlci5yZWN0YW5nbGUoWCAvIDIsIFkgLyAyICAqIDAuNSxkcmF3X2FydCAvMiAtIDEsNCxkZWZlbnNpdmVbMV0sZGVmZW5zaXZlWzJdLGRlZmVuc2l2ZVszXSwyNTUpCiAgICAgICAgICAgICAgICAtLSByZW5kZXJlci50ZXh0KFggLyAyICwgWSAvIDIgICogMC41IC0gMTAgLDI1NSwyNTUsMjU1LDI1NSwiYyIsMCwiLSBkZWZlbnNpdmUgLSIpCgogICAgICAgICAgICAgICAgaWYgdG9fZHJhd190aWNrcyA9PSAyNyB0aGVuCiAgICAgICAgICAgICAgICAgICAgdG9fZHJhd190aWNrcyA9IDAKICAgICAgICAgICAgICAgICAgICB0b19kcmF3ID0gIm5vIgogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICB0b19kcmF3X3RpY2tzID0gdG9fZHJhd190aWNrcyArIDEKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICB9CgogICAgY3R4LnNsb3dlZF9kb3duID0gewogICAgICAgIHJlbmRlciA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgbG9jYWwgbWUgPSBlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpCiAgICAgICAgICAgIGlmIG1lID09IG5pbCB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgaWYgbm90IGVudGl0eS5pc19hbGl2ZShtZSkgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgIGxvY2FsIHIsZyxiLGEgPSBfdWkudmlzdWFscy5lbmFibGU6Z2V0X2NvbG9yKCkKCiAgICAgICAgICAgIGxvY2FsIHNsb3dlZF9kb3duX3ZhbHVlID0gZW50aXR5LmdldF9wcm9wKG1lLCJtX2ZsVmVsb2NpdHlNb2RpZmllciIpICogMTAwCiAgICAgICAgICAgIGxvY2FsIGlzX2RlZmVuc2l2ZSA9IHRvX2RyYXcgPT0gInllcyIgYW5kIHVpLmdldChyZWZzLnJlZi5kb3VibGV0YXBbMl0pIGFuZCBmdW5jcy5jb250YWlucyhfdWkudmlzdWFscy5vdGhlcnMudmFsdWUsICJEZWZlbnNpdmUiKQoKICAgICAgICAgICAgaWYgZnVuY3MuY29udGFpbnMoX3VpLnZpc3VhbHMub3RoZXJzLnZhbHVlLCAiU2xvdy1kb3duIikgYW5kIHNsb3dlZF9kb3duX3ZhbHVlIDwgMTAwIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIHNpemVfYmFyID0gc2xvd2VkX2Rvd25fdmFsdWUgKiA5OCAvIDEwMAogICAgICAgICAgICAgICAgcmVuZGVyZXIudGV4dChYIC8gMiAsIFkgLyAyICAqIDAuNiAtIDE1ICwgMjU1LCAyNTUsIDI1NSwgMjU1LCAiYyIsIDAsICItIHNsb3dlZCBkb3duIC0iKQogICAgICAgICAgICAgICAgY3R4Lm1fcmVuZGVyOmdsb3dfbW9kdWxlKFggLyAyIC0gMiAtIChtYXRoLmZsb29yKHNpemVfYmFyKSAvIDIpLCBZIC8gMiAgKiAwLjYsbWF0aC5mbG9vcihzaXplX2JhciksNCwgMTAsMix7cixnLGIsMTgwfSwge3IsZyxiLDI1NX0pCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgfQoKICAgIGN0eC5jbGFudGFnID0gewogICAgICAgIHJ1biA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgbG9jYWwgY3VyID0gbWF0aC5mbG9vcihnbG9iYWxzLnRpY2tjb3VudCgpIC8gMzApICUgI2NsYW50YWdzCiAgICAgICAgICAgIGxvY2FsIGNsYW50YWcgPSBjbGFudGFnc1tjdXIrMV0KICAgICAgICAKICAgICAgICAgICAgaWYgY2xhbnRhZyB+PSBjbGFudGFnX3ByZXYgdGhlbgogICAgICAgICAgICAgICAgY2xhbnRhZ19wcmV2ID0gY2xhbnRhZwogICAgICAgICAgICAgICAgaWYgX3VpLm1pc2MuY2xhbnRhZy52YWx1ZSA9PSB0cnVlIHRoZW4KICAgICAgICAgICAgICAgICAgICBjbGllbnQuc2V0X2NsYW5fdGFnKGNsYW50YWcpCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgY2xpZW50LnNldF9jbGFuX3RhZygiIikKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0KCiAgICBjdHguYW5pbXMgPSB7CiAgICAgICAgcnVuID0gZnVuY3Rpb24oKQogICAgICAgICAgICBpZiBub3QgZW50aXR5LmlzX2FsaXZlKGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCkpIHRoZW4KICAgICAgICAgICAgICAgIGVuZF90aW1lID0gMAogICAgICAgICAgICAgICAgZ3JvdW5kX3RpY2tzID0gMAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGVuZAogICAgICAgIAogICAgICAgICAgICBpZiBmdW5jcy5jb250YWlucyhfdWkubWlzYy5hbmltcy52YWx1ZSwicGl0Y2ggMCIpIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIG9uX2dyb3VuZCA9IGJpdC5iYW5kKGVudGl0eS5nZXRfcHJvcChlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpLCAibV9mRmxhZ3MiKSwgMSkKICAgICAgICAKICAgICAgICAgICAgICAgIGlmIG9uX2dyb3VuZCA9PSAxIHRoZW4KICAgICAgICAgICAgICAgICAgICBncm91bmRfdGlja3MgPSBncm91bmRfdGlja3MgKyAxCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgZ3JvdW5kX3RpY2tzID0gMAogICAgICAgICAgICAgICAgICAgIGVuZF90aW1lID0gZ2xvYmFscy5jdXJ0aW1lKCkgKyAxCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAKICAgICAgICAgICAgICAgIGlmICBncm91bmRfdGlja3MgPiA1IGFuZCBlbmRfdGltZSArIDAuNSA+IGdsb2JhbHMuY3VydGltZSgpIHRoZW4KICAgICAgICAgICAgICAgICAgICBlbnRpdHkuc2V0X3Byb3AoZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKSwgIm1fZmxQb3NlUGFyYW1ldGVyIiwgMC41LCAxMikKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICAKICAgICAgICAgICAgaWYgZnVuY3MuY29udGFpbnMoX3VpLm1pc2MuYW5pbXMudmFsdWUsInJldmVyc2VkIGxlZ3MiKSB0aGVuCiAgICAgICAgICAgICAgICBsb2NhbCBtYXRoX3JhbmRvbWl6ZWQgPSBtYXRoLnJhbmRvbSgxLDIpCiAgICAgICAgCiAgICAgICAgICAgICAgICB1aS5zZXQodWkucmVmZXJlbmNlKCJBQSIsICJPdGhlciIsICJMZWcgbW92ZW1lbnQiKSwgbWF0aF9yYW5kb21pemVkID09IDEgYW5kICJBbHdheXMgc2xpZGUiIG9yICJOZXZlciBzbGlkZSIpCiAgICAgICAgICAgICAgICBlbnRpdHkuc2V0X3Byb3AoZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKSwgIm1fZmxQb3NlUGFyYW1ldGVyIiwgOCwgMCkKICAgICAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgICAgIGlmIGZ1bmNzLmNvbnRhaW5zKF91aS5taXNjLmFuaW1zLnZhbHVlLCJzdGF0aWMgbGVncyIpIHRoZW4KICAgICAgICAgICAgICAgIGVudGl0eS5zZXRfcHJvcChlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpLCAibV9mbFBvc2VQYXJhbWV0ZXIiLCAxLCA2KSAKICAgICAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgICAgIGlmIGZ1bmNzLmNvbnRhaW5zKF91aS5taXNjLmFuaW1zLnZhbHVlLCAibGVnIGJyYWtlciIpIHRoZW4KICAgICAgICAgICAgICAgIGVudGl0eS5zZXRfcHJvcChlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpLCAibV9mbFBvc2VQYXJhbWV0ZXIiLCBjbGllbnQucmFuZG9tX2Zsb2F0KDAuNzUsIDEpLCAwKQogICAgICAgICAgICAgICAgdWkuc2V0KHVpLnJlZmVyZW5jZSgnQUEnLCAnT3RoZXInLCAnTGVnIG1vdmVtZW50JyksIGNsaWVudC5yYW5kb21faW50KDEsIDIpID09IDEgYW5kICJPZmYiIG9yICJBbHdheXMgc2xpZGUiKQogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIGlmIGZ1bmNzLmNvbnRhaW5zKF91aS5taXNjLmFuaW1zLnZhbHVlLCAicGVyZmVjdCIpIHRoZW4KICAgICAgICAgICAgICAgIGVudGl0eS5zZXRfcHJvcChlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpLCAibV9mbFBvc2VQYXJhbWV0ZXIiLCBtYXRoLnJhbmRvbSgwLCAxMCkvMTAsIDMpCiAgICAgICAgICAgICAgICBlbnRpdHkuc2V0X3Byb3AoZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKSwgIm1fZmxQb3NlUGFyYW1ldGVyIiwgbWF0aC5yYW5kb20oMCwgMTApLzEwLCA3KQogICAgICAgICAgICAgICAgZW50aXR5LnNldF9wcm9wKGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCksICJtX2ZsUG9zZVBhcmFtZXRlciIsIG1hdGgucmFuZG9tKDAsIDEwKS8xMCwgNikKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICB9CgogICAgY3R4LmRlYnVnX3BhbmVsID0gewogICAgICAgIHJlbmRlciA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgaWYgdWkuaXNfbWVudV9vcGVuKCkgYW5kIF91aS52aXN1YWxzLmVuYWJsZS52YWx1ZSBhbmQgX3VpLnZpc3VhbHMuZGVidWdfcGFuZWw6Z2V0KCkgfj0gIk9mZiIgdGhlbgogICAgICAgICAgICAgICAgY3R4Lm5vdGlmeS5yZW5kZXJfcmVjdF9vdXRsaW5lKGRlYnVnX3Bvcy5wb3NfeCwgZGVidWdfcG9zLnBvc195LCBkZWJ1Z19wb3Muc2l6ZV93LCBkZWJ1Z19wb3Muc2l6ZV9oLCAyNTUsMjU1LDI1NSwyNTUpCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgaWYgY2xpZW50LmtleV9zdGF0ZSgweDAxKSBhbmQgdWkuaXNfbWVudV9vcGVuKCkgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgbW91c2VfcG9zID0geyB1aS5tb3VzZV9wb3NpdGlvbigpIH0KICAgICAgICAgICAgICAgIGlmIGZ1bmNzLmludGVyc2VjdChkZWJ1Z19wb3MucG9zX3gsIGRlYnVnX3Bvcy5wb3NfeSwgZGVidWdfcG9zLnNpemVfdywgZGVidWdfcG9zLnNpemVfaCkgdGhlbgogICAgICAgICAgICAgICAgICAgIGRlYnVnX2hvdmVyID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgIGRlYnVnX3Bvcy5wb3NfeCA9IG1vdXNlX3Bvc1sxXSAtIGRlYnVnX3Bvcy5zaXplX3cgLzIgCiAgICAgICAgICAgICAgICAgICAgZGVidWdfcG9zLnBvc195ID0gbW91c2VfcG9zWzJdIC0gZGVidWdfcG9zLnNpemVfaCAvMgogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGRlYnVnX2hvdmVyID0gZmFsc2UKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBsb2NhbCBsb2NhbF9wbGF5ZXIgPSBlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpCiAgICAgICAgICAgIGlmIGxvY2FsX3BsYXllciA9PSBuaWwgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgIGlmIG5vdCBlbnRpdHkuaXNfYWxpdmUobG9jYWxfcGxheWVyKSB0aGVuIHJldHVybiBlbmQKCiAgICAgICAgICAgIGxvY2FsIHIsZyxiLGEgPSBfdWkudmlzdWFscy5lbmFibGU6Z2V0X2NvbG9yKCkKCiAgICAgICAgICAgIGlmIF91aS52aXN1YWxzLmRlYnVnX3BhbmVsOmdldCgpID09ICJNb2Rlcm4iIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIHRleHQgPSAiaW50ZXJpdHVzICBbIi4uZXVwaGVtaWEuYnVpbGQuLiJdICB8ICAiLi5ldXBoZW1pYS51c2VybmFtZS4uIiAgfCAgIi4uY3R4LndhdGVybWFyay5yb3VuZChjbGllbnQubGF0ZW5jeSgpICogMTAwMCwgMCkuLiJtcyIKICAgICAgICAgICAgICAgIGxvY2FsIHdpZHRoID0gdmVjdG9yKHJlbmRlcmVyLm1lYXN1cmVfdGV4dCgiIix0ZXh0KSkKICAgICAgICAgICAgICAgIHJlbmRlcmVyLmdyYWRpZW50KGRlYnVnX3Bvcy5wb3NfeCwgZGVidWdfcG9zLnBvc195LCBkZWJ1Z19wb3Muc2l6ZV93IC8gMiwgd2lkdGgueSArIDUsIDAsMCwwLDAsIDAsMCwwLDE0MCwgdHJ1ZSkKICAgICAgICAgICAgICAgIHJlbmRlcmVyLmdyYWRpZW50KGRlYnVnX3Bvcy5wb3NfeCArIGRlYnVnX3Bvcy5zaXplX3cgLyAyLCBkZWJ1Z19wb3MucG9zX3ksIGRlYnVnX3Bvcy5zaXplX3cgLyAyLCB3aWR0aC55ICsgNSwgMCwwLDAsMTQwLCAwLDAsMCwwLCB0cnVlKQogICAgICAgICAgICAgICAgcmVuZGVyZXIuZ3JhZGllbnQoZGVidWdfcG9zLnBvc194ICsgZGVidWdfcG9zLnNpemVfdyAvIDIsIGRlYnVnX3Bvcy5wb3NfeSArIHdpZHRoLnkgKyA2LCBkZWJ1Z19wb3Muc2l6ZV93IC8gMiwgMSwgcixnLGIsMjU1LCByLGcsYiwwLCB0cnVlKQogICAgICAgICAgICAgICAgcmVuZGVyZXIuZ3JhZGllbnQoZGVidWdfcG9zLnBvc194LCBkZWJ1Z19wb3MucG9zX3kgKyB3aWR0aC55ICsgNiwgZGVidWdfcG9zLnNpemVfdyAvIDIsIDEsIHIsZyxiLDAsIHIsZyxiLDI1NSwgdHJ1ZSkKICAgICAgICAgICAgICAgIHJlbmRlcmVyLnRleHQoZGVidWdfcG9zLnBvc194ICsgNSwgZGVidWdfcG9zLnBvc195ICsgNCwgMjU1LCAyNTUsIDI1NSwgMjU1LCAiLSIsIDAsIHN0cmluZy51cHBlcih0ZXh0KSkKCiAgICAgICAgICAgICAgICAtLW90aGVyCiAgICAgICAgICAgICAgICByZW5kZXJlci50ZXh0KGRlYnVnX3Bvcy5wb3NfeCArIDUsIGRlYnVnX3Bvcy5wb3NfeSArIHdpZHRoLnkgKyA4LCAyNTUsIDI1NSwgMjU1LCAyNTUsICItIiwgMCwgIi0gQ09ORElUSU9OOiAiLi5zdHJpbmcudXBwZXIoY3R4LmhlbHBzLmdldF9zdGF0ZV9kZWZlbnNpdmUoY3R4LmhlbHBzLnNwZWVkKCkpKSkKICAgICAgICAgICAgICAgIHJlbmRlcmVyLnRleHQoZGVidWdfcG9zLnBvc194ICsgNSwgZGVidWdfcG9zLnBvc195ICsgd2lkdGgueSArIDE2LCAyNTUsIDI1NSwgMjU1LCAyNTUsICItIiwgMCwgIi0gQ0hPS0U6ICIuLnN0cmluZy51cHBlcihnbG9iYWxzLmNob2tlZGNvbW1hbmRzKCkpKQogICAgICAgICAgICAgICAgcmVuZGVyZXIudGV4dChkZWJ1Z19wb3MucG9zX3ggKyA1LCBkZWJ1Z19wb3MucG9zX3kgKyB3aWR0aC55ICsgMjQsIDI1NSwgMjU1LCAyNTUsIDI1NSwgIi0iLCAwLCAiLSBFWFBMT0lUIENIQVJHRTogIi4uc3RyaW5nLnVwcGVyKGFudGlhaW1fZnVuY3MuZ2V0X3RpY2tiYXNlX3NoaWZ0aW5nKCkpKQogICAgICAgICAgICAgICAgcmVuZGVyZXIudGV4dChkZWJ1Z19wb3MucG9zX3ggKyA1LCBkZWJ1Z19wb3MucG9zX3kgKyB3aWR0aC55ICsgMzIsIDI1NSwgMjU1LCAyNTUsIDI1NSwgIi0iLCAwLCAiLSBERVNZTkM6ICIuLnN0cmluZy51cHBlcihtYXRoLmZsb29yKGFudGlhaW1fZnVuY3MuZ2V0X2Rlc3luYygxKSkpKQogICAgICAgICAgICBlbHNlaWYgX3VpLnZpc3VhbHMuZGVidWdfcGFuZWw6Z2V0KCkgPT0gIkRlZmF1bHQiIHRoZW4KICAgICAgICAgICAgICAgIC0tKiBtYXRoLmFicyhtYXRoLmNvcyhnbG9iYWxzLmN1cnRpbWUoKSoxLjUpKQogICAgICAgICAgICAgICAgcmVuZGVyZXIudGV4dChkZWJ1Z19wb3MucG9zX3ggKyA4LCBkZWJ1Z19wb3MucG9zX3ksIDI1NSwgMjU1LCAyNTUsIDI1NSwgIiIsIDAsICJpbnRlcml0dXMgLSAiLi5ldXBoZW1pYS51c2VybmFtZSkKICAgICAgICAgICAgICAgIHJlbmRlcmVyLnRleHQoZGVidWdfcG9zLnBvc194ICsgOCwgZGVidWdfcG9zLnBvc195ICsgOSwgMjU1LCAyNTUsIDI1NSwgMjU1LCAiIiwgMCwgInZlcnNpb246IFxhIi4uZnVuY3MucmdiYV90b19oZXgocixnLGIsMjQwICogbWF0aC5hYnMobWF0aC5jb3MoZ2xvYmFscy5jdXJ0aW1lKCkqMikpKS4uZXVwaGVtaWEuYnVpbGQpCiAgICAgICAgICAgICAgICByZW5kZXJlci50ZXh0KGRlYnVnX3Bvcy5wb3NfeCArIDgsIGRlYnVnX3Bvcy5wb3NfeSArIDE4LCAyNTUsIDI1NSwgMjU1LCAyNTUsICIiLCAwLCAiZXhwbG9pdCBjaGFyZ2U6ICIuLiBhbnRpYWltX2Z1bmNzLmdldF90aWNrYmFzZV9zaGlmdGluZygpKQogICAgICAgICAgICAgICAgcmVuZGVyZXIudGV4dChkZWJ1Z19wb3MucG9zX3ggKyA4LCBkZWJ1Z19wb3MucG9zX3kgKyAyNywgMjU1LCAyNTUsIDI1NSwgMjU1LCAiIiwgMCwgImRlc3luYyBhbW91bnQ6ICIuLiBtYXRoLmZsb29yKGFudGlhaW1fZnVuY3MuZ2V0X2Rlc3luYygxKSkpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgfQoKICAgIGN0eC5hbnRpYnJ1dGVmb3JjZSA9IHsKICAgICAgICB2ZWN0b3IzX2Rpc3RhbmNlID0gZnVuY3Rpb24oeDEsIHkxLCB6MSwgeDIsIHkyLCB6MikKICAgICAgICAgICAgcmV0dXJuIG1hdGguc3FydCgoeDEgLSB4MileMiArICh5MSAtIHkyKV4yICsgKHoxIC0gejIpXjIpCiAgICAgICAgZW5kLAogICAgICAgIGNsb3Nlc3RfcG9pbnRfb25fcmF5ID0gZnVuY3Rpb24odHgsIHR5LCB0eiwgc3RhcnR4LCBzdGFydHksIHN0YXJ0eiwgZW5keCwgZW5keSwgZW5keikKICAgICAgICAgICAgbG9jYWwgdG94LCB0b3ksIHRveiA9IHR4IC0gc3RhcnR4LCB0eSAtIHN0YXJ0eSwgdHogLSBzdGFydHoKICAgICAgICAgICAgbG9jYWwgZGlyeCwgZGlyeSwgZGlyeiA9IGVuZHggLSBzdGFydHgsIGVuZHkgLSBzdGFydHksIGVuZHogLSBzdGFydHoKICAgICAgICAgICAgbG9jYWwgbGVuZ3RoID0gbWF0aC5zcXJ0KGRpcnheMiArIGRpcnleMiArIGRpcnpeMikKICAgICAgICAgICAgZGlyeCwgZGlyeSwgZGlyeiA9IGRpcnggLyBsZW5ndGgsIGRpcnkgLyBsZW5ndGgsIGRpcnogLyBsZW5ndGgKICAgICAgICAgICAgbG9jYWwgcmFuZ2VfYWxvbmcgPSBkaXJ4ICogdG94ICsgZGlyeSAqIHRveSArIGRpcnogKiB0b3oKICAgICAgICAgICAgaWYgcmFuZ2VfYWxvbmcgPCAwIHRoZW4KICAgICAgICAgICAgICAgIHJldHVybiBzdGFydHgsIHN0YXJ0eSwgc3RhcnR6CiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBpZiByYW5nZV9hbG9uZyA+IGxlbmd0aCB0aGVuCiAgICAgICAgICAgICAgICByZXR1cm4gZW5keCwgZW5keSwgZW5kegogICAgICAgICAgICBlbmQJCiAgICAgICAgICAgIHJldHVybiBzdGFydHggKyBkaXJ4ICogcmFuZ2VfYWxvbmcsIHN0YXJ0eSArIGRpcnkgKiByYW5nZV9hbG9uZywgc3RhcnR6ICsgZGlyeiAqIHJhbmdlX2Fsb25nCiAgICAgICAgZW5kLAogICAgICAgIHJlc2V0ID0gZnVuY3Rpb24oKQogICAgICAgICAgICBpZiBub3QgX3VpLmFudGlfYmYuZW5hYmxlLnZhbHVlIHRoZW4KICAgICAgICAgICAgICAgIGFudGlfYmZfdGFibGUubWlzc19jb3VudGVyID0gMAogICAgICAgICAgICAgICAgYW50aV9iZl90YWJsZS5lbnRpdHkgPSBuaWwKICAgICAgICAgICAgICAgIGFudGlfYmZfdGFibGUuZW50aXR5XzIgPSBuaWwKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIGlmIGFudGlfYmZfdGFibGUubWlzc19jb3VudGVyID09IDAgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgIGlmIGFudGlfYmZfYnVpbGRlclthbnRpX2JmX3RhYmxlLm1pc3NfY291bnRlcl0gPT0gbmlsIHRoZW4gYW50aV9iZl90YWJsZS5taXNzX2NvdW50ZXIgPSAwIHJldHVybiBlbmQKCiAgICAgICAgICAgIGFudGlfYmZfdGFibGUucmVjb3JkZWRfZW50ID0gYW50aV9iZl90YWJsZS5lbnRpdHlfMgoKICAgICAgICAgICAgbG9jYWwgcixnLGIsYSA9IF91aS52aXN1YWxzLmVuYWJsZTpnZXRfY29sb3IoKQoKICAgICAgICAgICAgaWYgZnVuY3MuY29udGFpbnMoX3VpLmFudGlfYmYucmVzZXRpZi52YWx1ZSwgIlJlYWNoZWQgVGltZSBMaW5lIikgdGhlbgogICAgICAgICAgICAgICAgaWYgbWF0aC5jZWlsKGFudGlfYmZfdGFibGUudGltZXJfYnJ1dGUgKyA5KSA9PSBtYXRoLmNlaWwoZ2xvYmFscy5jdXJ0aW1lKCkpIHRoZW4KICAgICAgICAgICAgICAgICAgICBhbnRpX2JmX3RhYmxlLm1pc3NfY291bnRlciA9IDAKICAgICAgICAgICAgICAgICAgICBhbnRpX2JmX3RhYmxlLmVudGl0eSA9IG5pbAogICAgICAgICAgICAgICAgICAgIGFudGlfYmZfdGFibGUuZW50aXR5XzIgPSBuaWwKICAgICAgICAgICAgICAgICAgICBhbnRpX2JmX3RhYmxlLmVudGl0eV9jaGFuZ2VkID0gZmFsc2UKCiAgICAgICAgICAgICAgICAgICAgbmV3X25vdGlmeShzdHJpbmcuZm9ybWF0KCJcYSVzQW50aS1CcnV0ZVxhRkZGRkZGRkYgcmVzZXR0ZWQgZHVlIHRvIFxhJXNyZWFjaGVkIHRpbWUtbGluZSIsIGZ1bmNzLnJnYmFfdG9faGV4KHIsZyxiLDI1NSksIGZ1bmNzLnJnYmFfdG9faGV4KHIsZyxiLDI1NSkpLCByLGcsYiwyNTUpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBpZiBmdW5jcy5jb250YWlucyhfdWkuYW50aV9iZi5yZXNldGlmLnZhbHVlLCAiVGFyZ2V0IERlYXRoIikgdGhlbgogICAgICAgICAgICAgICAgaWYgbm90IGVudGl0eS5pc19hbGl2ZShhbnRpX2JmX3RhYmxlLmVudGl0eSkgdGhlbgogICAgICAgICAgICAgICAgICAgIGFudGlfYmZfdGFibGUubWlzc19jb3VudGVyID0gMAogICAgICAgICAgICAgICAgICAgIGFudGlfYmZfdGFibGUuZW50aXR5ID0gbmlsCiAgICAgICAgICAgICAgICAgICAgYW50aV9iZl90YWJsZS5lbnRpdHlfMiA9IG5pbAogICAgICAgICAgICAgICAgICAgIGFudGlfYmZfdGFibGUuZW50aXR5X2NoYW5nZWQgPSBmYWxzZQoKICAgICAgICAgICAgICAgICAgICBuZXdfbm90aWZ5KHN0cmluZy5mb3JtYXQoIlxhJXNBbnRpLUJydXRlXGFGRkZGRkZGRiByZXNldHRlZCBkdWUgdG8gXGElc3RhcmdldCBkZWF0aCIsIGZ1bmNzLnJnYmFfdG9faGV4KHIsZyxiLDI1NSksIGZ1bmNzLnJnYmFfdG9faGV4KHIsZyxiLDI1NSkpLCByLGcsYiwyNTUpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBpZiBhbnRpX2JmX3RhYmxlLm1heF9waGFzZSA8IGFudGlfYmZfdGFibGUubWlzc19jb3VudGVyIHRoZW4KICAgICAgICAgICAgICAgIGFudGlfYmZfdGFibGUubWlzc19jb3VudGVyID0gMAogICAgICAgICAgICAgICAgYW50aV9iZl90YWJsZS5lbnRpdHkgPSBuaWwKICAgICAgICAgICAgICAgIGFudGlfYmZfdGFibGUuZW50aXR5XzIgPSBuaWwKICAgICAgICAgICAgICAgIGFudGlfYmZfdGFibGUuZW50aXR5X2NoYW5nZWQgPSBmYWxzZQoKICAgICAgICAgICAgICAgIG5ld19ub3RpZnkoc3RyaW5nLmZvcm1hdCgiXGElc0FudGktQnJ1dGVcYUZGRkZGRkZGIHJlc2V0dGVkIGR1ZSB0byBcYSVzcmVhY2ggbWF4IGNhcGFjaXR5IiwgZnVuY3MucmdiYV90b19oZXgocixnLGIsMjU1KSwgZnVuY3MucmdiYV90b19oZXgocixnLGIsMjU1KSksIHIsZyxiLDI1NSkKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBpZiBhbnRpX2JmX3RhYmxlLm1pc3NfY291bnRlciA+IDAgdGhlbgogICAgICAgICAgICAgICAgaWYgbm90IGFudGlfYmZfYnVpbGRlclthbnRpX2JmX3RhYmxlLm1pc3NfY291bnRlcl0uZW5hYmxlZC52YWx1ZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgYW50aV9iZl90YWJsZS5taXNzX2NvdW50ZXIgPSAwCiAgICAgICAgICAgICAgICAgICAgYW50aV9iZl90YWJsZS5lbnRpdHkgPSBuaWwKICAgICAgICAgICAgICAgICAgICBhbnRpX2JmX3RhYmxlLmVudGl0eV8yID0gbmlsCiAgICAgICAgICAgICAgICAgICAgYW50aV9iZl90YWJsZS5lbnRpdHlfY2hhbmdlZCA9IGZhbHNlCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kLAogICAgICAgIHJlc2V0MiA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgbG9jYWwgcixnLGIsYSA9IF91aS52aXN1YWxzLmVuYWJsZTpnZXRfY29sb3IoKQoKICAgICAgICAgICAgaWYgbm90IF91aS5hbnRpX2JmLmVuYWJsZS52YWx1ZSB0aGVuIHJldHVybiBlbmQKCiAgICAgICAgICAgIGFudGlfYmZfdGFibGUubWlzc19jb3VudGVyID0gMAogICAgICAgICAgICBhbnRpX2JmX3RhYmxlLmVudGl0eSA9IG5pbAogICAgICAgICAgICBhbnRpX2JmX3RhYmxlLmVudGl0eV8yID0gbmlsCiAgICAgICAgICAgIGFudGlfYmZfdGFibGUuZW50aXR5X2NoYW5nZWQgPSBmYWxzZQoKICAgICAgICAgICAgbmV3X25vdGlmeShzdHJpbmcuZm9ybWF0KCJcYSVzQW50aS1CcnV0ZVxhRkZGRkZGRkYgcmVzZXR0ZWQiLCBmdW5jcy5yZ2JhX3RvX2hleChyLGcsYiwyNTUpKSwgcixnLGIsMjU1KQogICAgICAgIGVuZCwKICAgICAgICBydW4gPSBmdW5jdGlvbihlKQogICAgICAgICAgICBpZiBub3QgX3VpLmFudGlfYmYuZW5hYmxlLnZhbHVlIHRoZW4KICAgICAgICAgICAgICAgIGFudGlfYmZfdGFibGUubWlzc19jb3VudGVyID0gMAogICAgICAgICAgICAgICAgYW50aV9iZl90YWJsZS5lbnRpdHkgPSBuaWwKICAgICAgICAgICAgICAgIGFudGlfYmZfdGFibGUuZW50aXR5XzIgPSBuaWwKICAgICAgICAgICAgICAgIGFudGlfYmZfdGFibGUuZW50aXR5X2NoYW5nZWQgPSBmYWxzZQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgbG9jYWwgcixnLGIsYSA9IF91aS52aXN1YWxzLmVuYWJsZTpnZXRfY29sb3IoKQoKICAgICAgICAgICAgaWYgZW50aXR5LmlzX2FsaXZlKGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCkpIHRoZW4KICAgICAgICAgICAgICAgIGlmIGZ1bmNzLmNvbnRhaW5zKF91aS5hbnRpX2JmLnN0YXRlLnZhbHVlLCBjdHguaGVscHMuZ2V0X3N0YXRlX2RlZmVuc2l2ZShjdHguaGVscHMuc3BlZWQoKSkpIHRoZW4KICAgICAgICAgICAgICAgICAgICBpZiBtYXRoLmFicyhhbnRpX2JmX3RhYmxlLnRpbWVyX2JydXRlIC0gZ2xvYmFscy5jdXJ0aW1lKCkpID4gMC4yNTAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBlbnQgPSBjbGllbnQudXNlcmlkX3RvX2VudGluZGV4KGUudXNlcmlkKQogICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgZW50aXR5LmlzX2Rvcm1hbnQoZW50KSBhbmQgZW50aXR5LmlzX2VuZW15KGVudCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgaGVhZHgsIGhlYWR5LCBoZWFkeiA9IGVudGl0eS5oaXRib3hfcG9zaXRpb24oZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKSwgMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGV5ZXgsIGV5ZXksIGV5ZXogPSBlbnRpdHkuZ2V0X29yaWdpbihlbnQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleWV6ID0gZXlleiArIDY0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCB4LCB5LCB6ID0gY3R4LmFudGlicnV0ZWZvcmNlLmNsb3Nlc3RfcG9pbnRfb25fcmF5KGhlYWR4LCBoZWFkeSwgaGVhZHosIGV5ZXgsIGV5ZXksIGV5ZXosIGUueCwgZS55LCBlLnopCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBjdHguYW50aWJydXRlZm9yY2UudmVjdG9yM19kaXN0YW5jZSh4LCB5LCB6LCBoZWFkeCwgaGVhZHksIGhlYWR6KSA8IDg4IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbnRpX2JmX3RhYmxlLm1pc3NfY291bnRlciA9IGFudGlfYmZfdGFibGUubWlzc19jb3VudGVyICsgMQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFudGlfYmZfdGFibGUudGltZXJfYnJ1dGUgPSBnbG9iYWxzLmN1cnRpbWUoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFudGlfYmZfdGFibGUuZW50aXR5ID0gZW50CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW50aV9iZl90YWJsZS5lbnRpdHlfMiA9IGVudAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld19ub3RpZnkoc3RyaW5nLmZvcm1hdCgiXGElc0FudGktQnJ1dGVcYUZGRkZGRkZGIENoYW5nZWQgZHVlIHRvXGElcyAlc1xhRkZGRkZGRkYncyBzaG90IFtcYSVzICVzXGFGRkZGRkZGRiBdIiwgZnVuY3MucmdiYV90b19oZXgocixnLGIsMjU1KSwgZnVuY3MucmdiYV90b19oZXgocixnLGIsMjU1KSwgZW50aXR5LmdldF9wbGF5ZXJfbmFtZShlbnQpLCBmdW5jcy5yZ2JhX3RvX2hleChyLGcsYiwyNTUpLCBhbnRpX2JmX3RhYmxlLm1pc3NfY291bnRlciksIHIsZyxiLDI1NSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0KCiAgICBjdHguZmFzdF9sYWQgPSB7CiAgICAgICAgcnVuID0gZnVuY3Rpb24oZSkKICAgICAgICAgICAgaWYgX3VpLm1pc2MuZmFzdF9sYWRkZXIudmFsdWUgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgbG9jYWxfcGxheWVyID0gZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKQogICAgICAgICAgICAgICAgbG9jYWwgcGl0Y2gsIHlhdyA9IGNsaWVudC5jYW1lcmFfYW5nbGVzKCkKICAgICAgICAgICAgICAgIGlmIGVudGl0eS5nZXRfcHJvcChsb2NhbF9wbGF5ZXIsICJtX01vdmVUeXBlIikgPT0gOSB0aGVuCiAgICAgICAgICAgICAgICAgICAgZS55YXcgPSBtYXRoLmZsb29yKGUueWF3ICsgMC41KQogICAgICAgICAgICAgICAgICAgIGUucm9sbCA9IDAKICAgICAgICAgICAgICAgICAgICBpZiBlLmZvcndhcmRtb3ZlID09IDAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBlLnBpdGNoID0gODkKICAgICAgICAgICAgICAgICAgICAgICAgZS55YXcgPSBlLnlhdyArIDE4MAogICAgICAgICAgICAgICAgICAgICAgICBpZiBtYXRoLmFicygxODApID4gMCBhbmQgbWF0aC5hYnMoMTgwKSA8IDE4MCBhbmQgZS5zaWRlbW92ZSB+PSAwIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUueWF3ID0gZS55YXcgLSB1aS5nZXQoMTgwKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgaWYgbWF0aC5hYnMoMTgwKSA9PSAxODAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZS5zaWRlbW92ZSA8IDAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuaW5fbW92ZWxlZnQgPSAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5pbl9tb3ZlcmlnaHQgPSAxCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGUuc2lkZW1vdmUgPiAwIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLmluX21vdmVsZWZ0ID0gMQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuaW5fbW92ZXJpZ2h0ID0gMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpZiBlLmZvcndhcmRtb3ZlID4gMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHBpdGNoIDwgNDUgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5waXRjaCA9IDg5CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLmluX21vdmVyaWdodCA9IDEKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuaW5fbW92ZWxlZnQgPSAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLmluX2ZvcndhcmQgPSAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLmluX2JhY2sgPSAxCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBlLnNpZGVtb3ZlID09IDAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUueWF3ID0gZS55YXcgKyA5MAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBlLnNpZGVtb3ZlIDwgMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS55YXcgPSBlLnlhdyArIDE1MAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBlLnNpZGVtb3ZlID4gMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS55YXcgPSBlLnlhdyArIDMwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kIAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGlmIGUuZm9yd2FyZG1vdmUgPCAwIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgZS5waXRjaCA9IDg5CiAgICAgICAgICAgICAgICAgICAgICAgIGUuaW5fbW92ZWxlZnQgPSAxCiAgICAgICAgICAgICAgICAgICAgICAgIGUuaW5fbW92ZXJpZ2h0ID0gMAogICAgICAgICAgICAgICAgICAgICAgICBlLmluX2ZvcndhcmQgPSAxCiAgICAgICAgICAgICAgICAgICAgICAgIGUuaW5fYmFjayA9IDAKICAgICAgICAgICAgICAgICAgICAgICAgaWYgZS5zaWRlbW92ZSA9PSAwIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUueWF3ID0gZS55YXcgKyA5MAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgaWYgZS5zaWRlbW92ZSA+IDAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZS55YXcgPSBlLnlhdyArIDE1MAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgaWYgZS5zaWRlbW92ZSA8IDAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZS55YXcgPSBlLnlhdyArIDMwCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgfQoKICAgIGN0eC5hbnRpYWltX2Fycm93cyA9IHsKICAgICAgICByZW5kZXIgPSBmdW5jdGlvbigpCiAgICAgICAgICAgIGxvY2FsIG1lID0gZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKQogICAgICAgICAgICBpZiBub3QgZW50aXR5LmlzX2FsaXZlKG1lKSB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgZGVzeW5jX3R5cGUgPSBlbnRpdHkuZ2V0X3Byb3AobWUsICJtX2ZsUG9zZVBhcmFtZXRlciIsIDExKSAqIDEyMCAtIDYwCiAgICAgICAgICAgIGRlc3luY19zaWRlID0gZGVzeW5jX3R5cGUgPiAwIGFuZCAxIG9yIC0xCiAgICAgICAgICAgIGxvY2FsIHZlbF9hZGFwID0gY3R4LmhlbHBzLnNwZWVkKCkgKiA0NSAvIDQ1MAogICAgICAgICAgICBsb2NhbCByLGcsYixhID0gX3VpLnZpc3VhbHMuZW5hYmxlOmdldF9jb2xvcigpCgogICAgICAgICAgICBpZiBfdWkudmlzdWFscy5hbnRpYWltX2Fycm93cy52YWx1ZSB+PSAiT2ZmIiB0aGVuCiAgICAgICAgICAgICAgICByZW5kZXJlci50cmlhbmdsZShYIC8gMiArIDU1ICsgdmVsX2FkYXAsIFkgLyAyICsgMiwgWCAvIDIgKyA0MiArIHZlbF9hZGFwLCBZIC8gMiAtIDcsIFggLyAyICsgNDIgKyB2ZWxfYWRhcCwgWSAvIDIgKyAxMSwgCiAgICAgICAgICAgICAgICBfdWkua2V5YmluZHMubWFudWFsX3JpZ2h0OmdldCgpIGFuZCByIG9yIDI1LCAKICAgICAgICAgICAgICAgIF91aS5rZXliaW5kcy5tYW51YWxfcmlnaHQ6Z2V0KCkgYW5kIGcgb3IgMjUsIAogICAgICAgICAgICAgICAgX3VpLmtleWJpbmRzLm1hbnVhbF9yaWdodDpnZXQoKSBhbmQgYiBvciAyNSwgCiAgICAgICAgICAgICAgICBfdWkua2V5YmluZHMubWFudWFsX3JpZ2h0OmdldCgpIGFuZCBhIG9yIDE2MCkKICAgICAgICAKICAgICAgICAgICAgICAgIHJlbmRlcmVyLnRyaWFuZ2xlKFggLyAyIC0gNTUgKyAtdmVsX2FkYXAsIFkgLyAyICsgMiwgWCAvIDIgLSA0MiArIC12ZWxfYWRhcCwgWSAvIDIgLSA3LCBYIC8gMiAtIDQyICsgLXZlbF9hZGFwLCBZIC8gMiArIDExLCAKICAgICAgICAgICAgICAgIF91aS5rZXliaW5kcy5tYW51YWxfbGVmdDpnZXQoKSBhbmQgciBvciAyNSwgCiAgICAgICAgICAgICAgICBfdWkua2V5YmluZHMubWFudWFsX2xlZnQ6Z2V0KCkgYW5kIGcgb3IgMjUsIAogICAgICAgICAgICAgICAgX3VpLmtleWJpbmRzLm1hbnVhbF9sZWZ0OmdldCgpIGFuZCBiIG9yIDI1LCAKICAgICAgICAgICAgICAgIF91aS5rZXliaW5kcy5tYW51YWxfbGVmdDpnZXQoKSBhbmQgYSBvciAxNjApCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgcmVuZGVyZXIucmVjdGFuZ2xlKFggLyAyICsgMzggKyB2ZWxfYWRhcCwgWSAvIDIgLSA3LCAyLCAxOCwgCiAgICAgICAgICAgICAgICBkZXN5bmNfc2lkZSA+IDAgYW5kIHIgb3IgMjUsCiAgICAgICAgICAgICAgICBkZXN5bmNfc2lkZSA+IDAgYW5kIGcgb3IgMjUsCiAgICAgICAgICAgICAgICBkZXN5bmNfc2lkZSA+IDAgYW5kIGIgb3IgMjUsCiAgICAgICAgICAgICAgICBkZXN5bmNfc2lkZSA+IDAgYW5kIGEgb3IgMTYwKQogICAgICAgICAgICAgICAgcmVuZGVyZXIucmVjdGFuZ2xlKFggLyAyIC0gNDAgKyAtdmVsX2FkYXAsIFkgLyAyIC0gNywgMiwgMTgsCQkJCiAgICAgICAgICAgICAgICBkZXN5bmNfc2lkZSA8IDAgYW5kIHIgb3IgMjUsCiAgICAgICAgICAgICAgICBkZXN5bmNfc2lkZSA8IDAgYW5kIGcgb3IgMjUsCiAgICAgICAgICAgICAgICBkZXN5bmNfc2lkZSA8IDAgYW5kIGIgb3IgMjUsCiAgICAgICAgICAgICAgICBkZXN5bmNfc2lkZSA8IDAgYW5kIGEgb3IgMTYwKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0KCiAgICByZXR1cm4gY3R4CmVuZCkoKQoKZnVuY3Rpb24gbmV3X25vdGlmeShzdHJpbmcsIHIsIGcsIGIsIGEpCiAgICBsb2NhbCBub3RpZmljYXRpb24gPSB7CiAgICAgICAgdGV4dCA9IHN0cmluZywKICAgICAgICB0aW1lciA9IGdsb2JhbHMucmVhbHRpbWUoKSwKICAgICAgICBjb2xvciA9IHsgciwgZywgYiwgYSB9LAogICAgICAgIGFscGhhID0gMCwKICAgICAgICBmcmFjdGlvbiA9IDAsCiAgICAgICAgdGltZV9sZWZ0ID0gMAogICAgfQoKICAgIGlmICNub3RpZnlfZGF0YSA9PSAwIHRoZW4KICAgICAgICBub3RpZmljYXRpb24ueSA9IFkgKyAyMAogICAgZWxzZQogICAgICAgIGxvY2FsIGxhc3ROb3RpZmljYXRpb24gPSBub3RpZnlfZGF0YVsjbm90aWZ5X2RhdGFdCiAgICAgICAgbm90aWZpY2F0aW9uLnkgPSBsYXN0Tm90aWZpY2F0aW9uLnkgKyAyMCAKICAgIGVuZAoKICAgIHRhYmxlLmluc2VydChub3RpZnlfZGF0YSwgbm90aWZpY2F0aW9uKQplbmQKCmxvY2FsIGhpdGdyb3VwX25hbWVzID0geyJnZW5lcmljIiwgImhlYWQiLCAiY2hlc3QiLCAic3RvbWFjaCIsICJsZWZ0IGFybSIsICJyaWdodCBhcm0iLCAibGVmdCBsZWciLCAicmlnaHQgbGVnIiwgIm5lY2siLCAiPyIsICJnZWFyIn0KbG9jYWwgd2VhcG9uX3RvX3ZlcmIgPSB7IGtuaWZlID0gJ0tuaWZlZCcsIGhlZ3JlbmFkZSA9ICdOYWRlZCcsIGluZmVybm8gPSAnQnVybmVkJyB9Cgpsb2NhbCBmdW5jdGlvbiBhaW1faGl0KGUpCiAgICBsb2NhbCBncm91cCA9IGhpdGdyb3VwX25hbWVzW2UuaGl0Z3JvdXAgKyAxXSBvciAiPyIKICAgIGxvY2FsIHIsZyxiLGEgPSBfdWkudmlzdWFscy5lbmFibGU6Z2V0X2NvbG9yKCkKCiAgICBpZiBmdW5jcy5jb250YWlucyhfdWkudmlzdWFscy5oaXRsb2dzLnZhbHVlLCAiSGl0IikgdGhlbgogICAgICAgIG5ld19ub3RpZnkoc3RyaW5nLmZvcm1hdCgiXGFGRkZGRkZGRkhpdCBcYSVzJXNcYUZGRkZGRkZGIGluIHRoZSBcYSVzJXNcYUZGRkZGRkZGIGZvciBcYSVzJWRcYUZGRkZGRkZGIGRhbWFnZSAoJWQgaGVhbHRoIHJlbWFpbmluZykiLCBmdW5jcy5yZ2JhX3RvX2hleChyLGcsYiwyNTUpLCBlbnRpdHkuZ2V0X3BsYXllcl9uYW1lKGUudGFyZ2V0KSwgZnVuY3MucmdiYV90b19oZXgocixnLGIsMjU1KSwgZ3JvdXAsIGZ1bmNzLnJnYmFfdG9faGV4KHIsZyxiLDI1NSksIGUuZGFtYWdlLCBlbnRpdHkuZ2V0X3Byb3AoZS50YXJnZXQsICJtX2lIZWFsdGgiKSApLCByLGcsYiwyNTUpCiAgICAgICAgZnVuY3MubXVsdGljb2xvcl9jb25zb2xlKHsyMDAsIDIwMCwgMjAwLCAiWyJ9LCB7cixnLGIsICIrIn0sIHsyMDAsIDIwMCwgMjAwLCAiXSAifSwgezIwMCwgMjAwLCAyMDAsICJIaXQgIn0sIHtyLGcsYiwgZW50aXR5LmdldF9wbGF5ZXJfbmFtZShlLnRhcmdldCl9LCB7MjAwLCAyMDAsIDIwMCwgIiBpbiB0aGUgIn0sIHtyLGcsYiwgZ3JvdXB9LCB7MjAwLCAyMDAsIDIwMCwgIiBmb3IgIn0sIHtyLGcsYiwgZS5kYW1hZ2V9LCB7MjAwLCAyMDAsIDIwMCwgIiBkYW1hZ2UgKCJ9LCB7cixnLGIsIGVudGl0eS5nZXRfcHJvcChlLnRhcmdldCwgIm1faUhlYWx0aCIpfSwgezIwMCwgMjAwLCAyMDAsICIgaGVhbHRoIHJlbWFpbmluZykifSkKICAgIGVuZAplbmQKCmNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soImFpbV9oaXQiLCBhaW1faGl0KQoKbG9jYWwgZnVuY3Rpb24gYWltX21pc3MoZSkKICAgIGxvY2FsIGdyb3VwID0gaGl0Z3JvdXBfbmFtZXNbZS5oaXRncm91cCArIDFdIG9yICI/IgogICAgbG9jYWwgcixnLGIsYSA9IF91aS52aXN1YWxzLmVuYWJsZTpnZXRfY29sb3IoKQoKICAgIGlmIGZ1bmNzLmNvbnRhaW5zKF91aS52aXN1YWxzLmhpdGxvZ3MudmFsdWUsICJNaXNzIikgdGhlbgogICAgICAgIG5ld19ub3RpZnkoc3RyaW5nLmZvcm1hdCgiXGFGRkZGRkZGRk1pc3NlZCBcYSVzJXNcYUZGRkZGRkZGIChcYSVzJXNcYUZGRkZGRkZGKSBkdWUgdG8gXGElcyVzIiwgZnVuY3MucmdiYV90b19oZXgociwgZywgYiwyNTUpLCBlbnRpdHkuZ2V0X3BsYXllcl9uYW1lKGUudGFyZ2V0KSwgZnVuY3MucmdiYV90b19oZXgociwgZywgYiwyNTUpLCBncm91cCwgZnVuY3MucmdiYV90b19oZXgociwgZywgYiwyNTUpLCBlLnJlYXNvbiksIHIsIGcsIGIsMjU1KQogICAgICAgIGZ1bmNzLm11bHRpY29sb3JfY29uc29sZSh7MjAwLCAyMDAsIDIwMCwgIlsifSwge3IsZyxiLCAiLSJ9LCB7MjAwLCAyMDAsIDIwMCwgIl0gIn0sIHsyMDAsIDIwMCwgMjAwLCAiTWlzc2VkICJ9LCB7cixnLGIsIGVudGl0eS5nZXRfcGxheWVyX25hbWUoZS50YXJnZXQpfSwgezIwMCwgMjAwLCAyMDAsICIgKCJ9LCB7cixnLGIsIGdyb3VwfSwgezIwMCwgMjAwLCAyMDAsICIpIGR1ZSB0byAifSwge3IsZyxiLCBlLnJlYXNvbn0pCiAgICBlbmQKZW5kCgpjbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrKCJhaW1fbWlzcyIsIGFpbV9taXNzKQoKY2xpZW50LnNldF9ldmVudF9jYWxsYmFjaygncGxheWVyX2h1cnQnLCBmdW5jdGlvbihlKQoJaWYgbm90IGZ1bmNzLmNvbnRhaW5zKF91aS52aXN1YWxzLmhpdGxvZ3MudmFsdWUsICJOYWRlZCIpIHRoZW4KCQlyZXR1cm4KCWVuZAoJCglsb2NhbCBhdHRhY2tlcl9pZCA9IGNsaWVudC51c2VyaWRfdG9fZW50aW5kZXgoZS5hdHRhY2tlcikKCglpZiBhdHRhY2tlcl9pZCA9PSBuaWwgb3IgYXR0YWNrZXJfaWQgfj0gZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKSB0aGVuCiAgICAgICAgcmV0dXJuCiAgICBlbmQKCglpZiB3ZWFwb25fdG9fdmVyYltlLndlYXBvbl0gfj0gbmlsIHRoZW4KICAgICAgICBsb2NhbCB0YXJnZXRfaWQgPSBjbGllbnQudXNlcmlkX3RvX2VudGluZGV4KGUudXNlcmlkKQoJCWxvY2FsIHRhcmdldF9uYW1lID0gZW50aXR5LmdldF9wbGF5ZXJfbmFtZSh0YXJnZXRfaWQpCgogICAgICAgIGxvY2FsIHIsZyxiLGEgPSBfdWkudmlzdWFscy5lbmFibGU6Z2V0X2NvbG9yKCkKICAgICAgICBuZXdfbm90aWZ5KHdlYXBvbl90b192ZXJiW2Uud2VhcG9uXS4uIiBcYSIuLmZ1bmNzLnJnYmFfdG9faGV4KHIsZyxiLGEpLi50YXJnZXRfbmFtZS4uIlxhRkZGRkZGRkYgZm9yIi4uIiBcYSIuLmZ1bmNzLnJnYmFfdG9faGV4KHIsZyxiLGEpLi5lLmRtZ19oZWFsdGguLiJcYUZGRkZGRkZGIGRhbWFnZSAoIi4uIlxhIi4uZnVuY3MucmdiYV90b19oZXgocixnLGIsYSkuLmUuaGVhbHRoLi4iXGFGRkZGRkZGRikiLCByLGcsYixhKQogICAgICAgIGZ1bmNzLm11bHRpY29sb3JfY29uc29sZSh7MjAwLCAyMDAsIDIwMCwgIlsifSwge3IsZyxiLCAifiJ9LCB7MjAwLCAyMDAsIDIwMCwgIl0gIn0sIHsyMDAsIDIwMCwgMjAwLCB3ZWFwb25fdG9fdmVyYltlLndlYXBvbl19LCB7MjAwLDIwMCwyMDAsICIgIn0sIHtyLGcsYiwgdGFyZ2V0X25hbWV9LCB7MjAwLCAyMDAsIDIwMCwgIiBmb3IgIn0sIHtyLGcsYiwgZS5kbWdfaGVhbHRofSwgezIwMCwgMjAwLCAyMDAsICIgZGFtYWdlICgifSwge3IsZyxiLCBlLmhlYWx0aH0sIHsyMDAsMjAwLDIwMCwgIikifSkKCWVuZAplbmQpCgpsb2NhbCBmdW5jdGlvbiBhaW1fZmlyZShlKQogICAgbG9jYWwgZmxhZ3MgPSB7CiAgICAgICAgZS50ZWxlcG9ydGVkIGFuZCAiVCIgb3IgIiIsCiAgICAgICAgZS5pbnRlcnBvbGF0ZWQgYW5kICJJIiBvciAiIiwKICAgICAgICBlLmV4dHJhcG9sYXRlZCBhbmQgIkUiIG9yICIiLAogICAgICAgIGUuYm9vc3RlZCBhbmQgIkIiIG9yICIiLAogICAgICAgIGUuaGlnaF9wcmlvcml0eSBhbmQgIkgiIG9yICIiCiAgICB9CgogICAgbG9jYWwgZ3JvdXAgPSBoaXRncm91cF9uYW1lc1tlLmhpdGdyb3VwICsgMV0gb3IgIj8iCiAgICBsb2NhbCByLGcsYixhID0gX3VpLnZpc3VhbHMuZW5hYmxlOmdldF9jb2xvcigpCiAgICBpZiBmdW5jcy5jb250YWlucyhfdWkudmlzdWFscy5oaXRsb2dzLnZhbHVlLCAiRmlyZWQiKSB0aGVuCiAgICAgICAgbmV3X25vdGlmeShzdHJpbmcuZm9ybWF0KAogICAgICAgICAgICAiXGFGRkZGRkZGRkZpcmVkIGF0IFxhJXMlcyBcYUZGRkZGRkZGKFxhJXMlc1xhRkZGRkZGRkYpIGZvciBcYSVzJWQgXGFGRkZGRkZGRmRtZyAoIGNoYW5jZT1cYSVzJWQlJVxhRkZGRkZGRkYsIGZsYWdzPVxhJXMlcyBcYUZGRkZGRkZGKSIsCiAgICAgICAgICAgIGZ1bmNzLnJnYmFfdG9faGV4KHIsZyxiLDI1NSksZW50aXR5LmdldF9wbGF5ZXJfbmFtZShlLnRhcmdldCksIGZ1bmNzLnJnYmFfdG9faGV4KHIsZyxiLGEpLCBncm91cCwgZnVuY3MucmdiYV90b19oZXgocixnLGIsYSksIGUuZGFtYWdlLAogICAgICAgICAgICBmdW5jcy5yZ2JhX3RvX2hleChyLGcsYixhKSwgbWF0aC5mbG9vcihlLmhpdF9jaGFuY2UgKyAwLjUpLAogICAgICAgICAgICBmdW5jcy5yZ2JhX3RvX2hleChyLGcsYixhKSwgdGFibGUuY29uY2F0KGZsYWdzKQogICAgICAgICksIHIsZyxiLDI1NSkKICAgICAgICBmdW5jcy5tdWx0aWNvbG9yX2NvbnNvbGUoezIwMCwgMjAwLCAyMDAsICJbIn0sIHtyLGcsYiwgIi8ifSwgezIwMCwgMjAwLCAyMDAsICJdICJ9LCB7MjAwLCAyMDAsIDIwMCwgIkZpcmVkIGF0ICJ9LCB7cixnLGIsIGVudGl0eS5nZXRfcGxheWVyX25hbWUoZS50YXJnZXQpfSwgezIwMCwgMjAwLCAyMDAsICIgKCJ9LCB7cixnLGIsIGdyb3VwfSwgezIwMCwgMjAwLCAyMDAsICIpIGZvciAifSwge3IsZyxiLCBlLmRhbWFnZX0sIHsyMDAsMjAwLDIwMCwgIiBkbWcifSwgezIwMCwyMDAsMjAwLCAiKCBjaGFuY2U9In0sIHtyLGcsYiwgbWF0aC5mbG9vcihlLmhpdF9jaGFuY2UgKyAwLjUpfSwgezIwMCwyMDAsMjAwLCAiLCBmbGFncz0ifSwge3IsZyxiLCB0YWJsZS5jb25jYXQoZmxhZ3MpfSwgezIwMCwyMDAsMjAwLCAiICkifSkKICAgIGVuZAoKZW5kCgpjbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrKCJhaW1fZmlyZSIsIGFpbV9maXJlKQoKLS1PTkxPQUQKY2xpZW50LmV4ZWMoImNsZWFyIikKY2xpZW50LmNvbG9yX2xvZygyNTUsIDI1NSwgMjU1LCAiV2VsY29tZSB0b1wwIikKY2xpZW50LmNvbG9yX2xvZygyNTUsIDExNSwgMTA1LCAiIGludGVyaXR1c1wwIikKY2xpZW50LmNvbG9yX2xvZygyNTUsIDI1NSwgMjU1LCAiLCAiIC4uIGV1cGhlbWlhLnVzZXJuYW1lKQoKbmV3X25vdGlmeSgiV2VsY29tZSB0byBcYSIuLmZ1bmNzLnJnYmFfdG9faGV4KDI1NSwxMTUsMTA1LDI1NSkuLiJpbnRlcml0dXMgXGFGRkZGRkZGRiIuLmV1cGhlbWlhLnVzZXJuYW1lLCAyNTUsIDExNSwgMTA1LDI1NSkKCmxvY2FsIFdlYmhvb2sgPSBkaXNjb3JkLm5ldygibG9hZCBpbmZvIikKbG9jYWwgUmljaEVtYmVkID0gZGlzY29yZC5uZXdFbWJlZCgpCgpXZWJob29rOnNldFVzZXJuYW1lKCJJTlRFUklUVVMiKQpSaWNoRW1iZWQ6c2V0VGl0bGUoIkx1YSBoYXMgYmVlbiBsb2FkZWQhIikKUmljaEVtYmVkOmFkZEZpZWxkKCJCdWlsZDogIiwgImBgYCIgLi4gZXVwaGVtaWEuYnVpbGQgLi4gImBgYCIsIHRydWUpClJpY2hFbWJlZDphZGRGaWVsZCgiVXNlcm5hbWU6ICIsICJgYGAiIC4uIGV1cGhlbWlhLnVzZXJuYW1lIC4uICJgYGAiKQpSaWNoRW1iZWQ6YWRkRmllbGQoIlRpbWU6ICIsICJgYGAiIC4uIGZ1bmNzLmNvbnZlcnRVbml4VGltZShjbGllbnQudW5peF90aW1lKCkpIC4uICJgYGAiKQpSaWNoRW1iZWQ6c2V0Q29sb3IoMTY3NDEyMjUpCldlYmhvb2s6c2VuZChSaWNoRW1iZWQpCgpjbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrKCJzZXR1cF9jb21tYW5kIiwgZnVuY3Rpb24oY21kKQogICAgY3R4LmFudGlhaW0ucnVuKGNtZCkKICAgIGN0eC5nZXRfZGVmZW5zaXZlLmdldCgpCiAgICBjdHguYW50aWJydXRlZm9yY2UucmVzZXQoKQogICAgY3R4LmZhc3RfbGFkLnJ1bihjbWQpCgogICAgaWYgdWlfbWVudS5pc19ob3ZlcmVkIG9yIG5vdGlmeV9ob3ZlciBvciBpbmRfaG92ZXIgb3IgZGVidWdfaG92ZXIgdGhlbgogICAgICAgIGNtZC5pbl9hdHRhY2sgPSBmYWxzZQogICAgZW5kCmVuZCkKCmNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soInByZWRpY3RfY29tbWFuZCIsIGZ1bmN0aW9uKGUpCiAgICBsb2NhbCB0aWNrX2Jhc2UgPSBlbnRpdHkuZ2V0X3Byb3AoZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKSwgIm1fblRpY2tCYXNlIikKICAgIGFndXdubyA9IG1hdGguYWJzKHRpY2tfYmFzZSAtIGNoZWNrZXIpCiAgICBjaGVja2VyID0gbWF0aC5tYXgodGlja19iYXNlLCBjaGVja2VyIG9yIDApCmVuZCkKCmNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soInNodXRkb3duIiwgZnVuY3Rpb24oKQogICAgZnVuY3MuaGlkZV9za2VldF9hbnRpYWltX2RlZihmYWxzZSkKZW5kKQoKY2xpZW50LnNldF9ldmVudF9jYWxsYmFjaygicGFpbnRfdWkiLCBmdW5jdGlvbigpCiAgICBmdW5jcy5oaWRlX3NrZWV0X2FudGlhaW1fZGVmKF91aS5sdWEuZW5hYmxlX2x1YS52YWx1ZSkKICAgIC0tIkFudGktYWltIiwgIkRlZmVuc2l2ZSIsICJWaXN1YWxzIiwgIk1pc2NlbGxhbmVvdXMiLCAiQ29uZmlnIgogICAgaWYgX3VpLmx1YS5lbmFibGVfbHVhLnZhbHVlIHRoZW4KICAgICAgICBjdHgubm90aWZ5LnJlbmRlcigpCgogICAgICAgIGlmIGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCkgfj0gbmlsIHRoZW4gCiAgICAgICAgICAgIC0tYW50aV9iZl90YWJsZS5waGFzZSA9IGFudGlfYmZfYnVpbGRlcltjdHguaGVscHMuZ2V0X3N0YXRlX2RlZmVuc2l2ZShjdHguaGVscHMuc3BlZWQoKSldLnBoYXNlX3NsaWRlci52YWx1ZSAKICAgICAgICAgICAgLS1wcmludChhbnRpX2JmX3RhYmxlLnBoYXNlKQogICAgICAgIGVuZAogICAgZW5kCmVuZCkKCmNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soInBhaW50IiwgZnVuY3Rpb24oKQogICAgaWYgX3VpLmx1YS5lbmFibGVfbHVhLnZhbHVlIHRoZW4KICAgICAgICBjdHgud2F0ZXJtYXJrLnJlbmRlcigpCiAgICAgICAgY3R4LmluZGljYXRvcnMucmVuZGVyKCkKICAgICAgICBjdHguZGVmZW5zaXZlX2luZC5yZW5kZXIoKQogICAgICAgIGN0eC5zbG93ZWRfZG93bi5yZW5kZXIoKQogICAgICAgIGN0eC5kZWJ1Z19wYW5lbC5yZW5kZXIoKQogICAgICAgIGN0eC5hbnRpYWltX2Fycm93cy5yZW5kZXIoKQogICAgZW5kCmVuZCkKCmNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soImJ1bGxldF9pbXBhY3QiLCBmdW5jdGlvbihlKQogICAgY3R4LmFudGlicnV0ZWZvcmNlLnJ1bihlKQplbmQpCgp1aV9jb25maWdzID0gdWkubmV3X2xpc3Rib3goImFhIiwgImFudGktYWltYm90IGFuZ2xlcyIsICJDb25maWdzIiwgIiIpLCBmdW5jdGlvbigpIAogICAgcmV0dXJuCmVuZAp1aV9jb25maWdzX25hbWUgPSB1aS5uZXdfdGV4dGJveCgiYWEiLCAiYW50aS1haW1ib3QgYW5nbGVzIiwgIkNvbmZpZyBuYW1lIiwgIiIpLCBmdW5jdGlvbigpIAogICAgcmV0dXJuIAplbmQKdWlfbG9hZF9jZmdzID0gdWkubmV3X2J1dHRvbigiYWEiLCAiYW50aS1haW1ib3QgYW5nbGVzIiwgIlxhZmY3MzY5RkZMb2FkIiwgZnVuY3Rpb24oKSBlbmQpLCBmdW5jdGlvbigpIAogICAgcmV0dXJuCmVuZAp1aV9zYXZlX2NmZ3MgPSB1aS5uZXdfYnV0dG9uKCJhYSIsICJhbnRpLWFpbWJvdCBhbmdsZXMiLCAiXGFmZjczNjlGRlNhdmUiLCBmdW5jdGlvbigpIGVuZCksIGZ1bmN0aW9uKCkgCiAgICByZXR1cm4KZW5kCnVpX2RlbGV0ZV9jZmdzID0gdWkubmV3X2J1dHRvbigiYWEiLCAiYW50aS1haW1ib3QgYW5nbGVzIiwgIlxhZmY3MzY5RkZEZWxldGUiLCBmdW5jdGlvbigpIGVuZCksIGZ1bmN0aW9uKCkgCiAgICByZXR1cm4KZW5kCnVpX2ltcG9ydF9jZmdzID0gdWkubmV3X2J1dHRvbigiYWEiLCAiYW50aS1haW1ib3QgYW5nbGVzIiwgIlxhZmY3MzY5RkZJbXBvcnQgc2V0dGluZ3MiLCBmdW5jdGlvbigpIGVuZCkKdWlfZXhwb3J0X2NmZ3MgPSB1aS5uZXdfYnV0dG9uKCJhYSIsICJhbnRpLWFpbWJvdCBhbmdsZXMiLCAiXGFmZjczNjlGRkV4cG9ydCBzZXR0aW5ncyIsIGZ1bmN0aW9uKCkgZW5kKQp1aV9zaGFyZV9jZmdzID0gdWkubmV3X2J1dHRvbigiYWEiLCAiYW50aS1haW1ib3QgYW5nbGVzIiwgIlxhZmY3MzY5RkZTaGFyZSBvbiBkaXNjb3JkIiwgZnVuY3Rpb24oKSBzaGFyZV9jZmcoKSBlbmQpCnVpLnVwZGF0ZSh1aV9jb25maWdzLCBjdHguY2Zncy5nZXRjb25maWdfbGlzdCgpKQp1aS5zZXRfY2FsbGJhY2sodWlfY29uZmlncywgZnVuY3Rpb24odmFsdWUpCnVpLnNldCh1aV9jb25maWdzX25hbWUsIGN0eC5jZmdzLmdldGNvbmZpZ19saXN0KClbdWkuZ2V0KHVpX2NvbmZpZ3MpKzFdKQplbmQpCnVpLnNldF9jYWxsYmFjayh1aV9pbXBvcnRfY2ZncywgZnVuY3Rpb24oKQogICAgbG9jYWwgcHJvdGVjdGVkID0gZnVuY3Rpb24oKQogICAgICAgIGN0eC5jZmdzLmltcG9ydF9jb25maWcoKQogICAgZW5kCgogICAgaWYgcGNhbGwocHJvdGVjdGVkKSB0aGVuCiAgICAgICAgLS1wcmludCgiZWVlIikKICAgICAgICBuZXdfbm90aWZ5KCJTdWNjZXNzZnVsbHkhIEltcG9ydGVkIHNldHRpbmdzIGZyb20gY2xpcGJvYXJkIiwgMjU1LDExNSwxMDUsMjU1KQogICAgZWxzZQogICAgICAgIC0tcHJpbnQoImd1d25vICIpCiAgICAgICAgbmV3X25vdGlmeSgiRXJycm9yISBXaGlsZSBpbXBvcnRpbmcgY2ZnIiwgMjU1LDExNSwxMDUsMjU1KQogICAgZW5kCmVuZCkKdWkuc2V0X2NhbGxiYWNrKHVpX2V4cG9ydF9jZmdzLCBmdW5jdGlvbigpCiAgICBsb2NhbCBwcm90ZWN0ZWQgPSBmdW5jdGlvbigpCiAgICAgICAgY3R4LmNmZ3MuZXhwb3J0X2NvbmZpZygpCiAgICBlbmQKCiAgICBpZiBwY2FsbChwcm90ZWN0ZWQpIHRoZW4KICAgICAgICBuZXdfbm90aWZ5KCJTdWNjZXNzZnVsbHkhIEV4cG9ydGVkIHNldHRpbmdzIHRvIGNsaXBib2FyZCIsIDI1NSwxMTUsMTA1LDI1NSkKICAgIGVsc2UKICAgICAgICBuZXdfbm90aWZ5KCJFcnJyb3IhIFdoaWxlIGV4cG9ydGluZyBjZmciLCAyNTUsMTE1LDEwNSwyNTUpCiAgICBlbmQKZW5kKQp1aS5zZXRfY2FsbGJhY2sodWlfc2F2ZV9jZmdzLCBmdW5jdGlvbigpCiAgICBsb2NhbCBuYW1lID0gdWkuZ2V0KHVpX2NvbmZpZ3NfbmFtZSkKICAgIGlmIG5hbWUgPT0gIiIgdGhlbiByZXR1cm4gZW5kCgogICAgaWYgbmFtZTptYXRjaCgiW14ld10iKSB+PSBuaWwgdGhlbgogICAgICAgIC0tImludmFsaWQgY2hhcnMiCiAgICAgICAgcmV0dXJuCiAgICBlbmQKCiAgICBsb2NhbCBwcm90ZWN0ZWQgPSBmdW5jdGlvbigpCiAgICAgICAgY3R4LmNmZ3Muc2F2ZV9jb25maWcobmFtZSkKICAgIGVuZAoKICAgIGlmIHBjYWxsKHByb3RlY3RlZCkgdGhlbgogICAgICAgIG5ld19ub3RpZnkoIlN1Y2Nlc3NmdWxseSEgU2F2ZWQgc2V0dGluZ3MgKCIuLm5hbWUuLiIpIiwgMjU1LDExNSwxMDUsMjU1KQogICAgZWxzZQogICAgICAgIG5ld19ub3RpZnkoIkVycnJvciEgV2hpbGUgc2F2aW5nIGNmZyIsIDI1NSwxMTUsMTA1LDI1NSkKICAgIGVuZAogICAgdWkudXBkYXRlKHVpX2NvbmZpZ3MsIGN0eC5jZmdzLmdldGNvbmZpZ19saXN0KCkpCmVuZCkKdWkuc2V0X2NhbGxiYWNrKHVpX2xvYWRfY2ZncywgZnVuY3Rpb24oKQogICAgbG9jYWwgbmFtZSA9IHVpLmdldCh1aV9jb25maWdzX25hbWUpCiAgICBpZiBuYW1lID09ICIiIHRoZW4gcmV0dXJuIGVuZAoKICAgIGlmIG5hbWU6bWF0Y2goIlteJXddIikgfj0gbmlsIHRoZW4KICAgICAgICBwcmludCgiaW52YWxpZCBjaGFycyIpCiAgICAgICAgcmV0dXJuCiAgICBlbmQKCiAgICBsb2NhbCBwcm90ZWN0ZWQgPSBmdW5jdGlvbigpCiAgICAgICAgY3R4LmNmZ3MubG9hZF9jb25maWcobmFtZSkKICAgIGVuZAoKICAgIGlmIHBjYWxsKHByb3RlY3RlZCkgdGhlbgogICAgICAgIG5ld19ub3RpZnkoIlN1Y2Nlc3NmdWxseSEgTG9hZGVkIHNldHRpbmdzICgiLi5uYW1lLi4iKSIsIDI1NSwxMTUsMTA1LDI1NSkKICAgIGVsc2UKICAgICAgICBuZXdfbm90aWZ5KCJFcnJyb3IhIFdoaWxlIGxvYWRpbmcgY2ZnIiwgMjU1LDExNSwxMDUsMjU1KQogICAgZW5kCmVuZCkKdWkuc2V0X2NhbGxiYWNrKHVpX2RlbGV0ZV9jZmdzLCBmdW5jdGlvbigpCiAgICBsb2NhbCBuYW1lID0gdWkuZ2V0KHVpX2NvbmZpZ3NfbmFtZSkKICAgIGlmIG5hbWUgPT0gIiIgdGhlbiByZXR1cm4gZW5kCgogICAgaWYgY3R4LmNmZ3MuZGVsZXRlX2NvbmZpZyhuYW1lKSA9PSBmYWxzZSB0aGVuCiAgICAgICAgdWkudXBkYXRlKHVpX2NvbmZpZ3MsIGN0eC5jZmdzLmdldGNvbmZpZ19saXN0KCkpCiAgICAgICAgcmV0dXJuCiAgICBlbmQKCiAgICBsb2NhbCBwcm90ZWN0ZWQgPSBmdW5jdGlvbigpCiAgICAgICAgY3R4LmNmZ3MuZGVsZXRlX2NvbmZpZyhuYW1lKQogICAgZW5kCgogICAgaWYgcGNhbGwocHJvdGVjdGVkKSB0aGVuCiAgICAgICAgdWkudXBkYXRlKHVpX2NvbmZpZ3MsIGN0eC5jZmdzLmdldGNvbmZpZ19saXN0KCkpCiAgICAgICAgdWkuc2V0KHVpX2NvbmZpZ3MsICNjZmdfZGF0YS5wcmVzZXRzICsgI2RhdGFiYXNlLnJlYWQoY2ZnX2RhdGEuZGF0YWJhc2UuY29uZmlncykgLSAjZGF0YWJhc2UucmVhZChjZmdfZGF0YS5kYXRhYmFzZS5jb25maWdzKSkKICAgICAgICBuZXdfbm90aWZ5KCJTdWNjZXNzZnVsbHkhIGRlbGV0ZWQgdGhlIGNvbmZpZyIsIDI1NSwxMTUsMTA1LDI1NSkKICAgIGVsc2UKICAgICAgICBuZXdfbm90aWZ5KCJGYWlsZWQgdG8gZGVsZXRlIHRoZSBjb25maWciLCAyNTUsMTE1LDEwNSwyNTUpCiAgICBlbmQKZW5kKQoKY2xpZW50LnNldF9ldmVudF9jYWxsYmFjaygicGFpbnRfdWkiLCBmdW5jdGlvbigpCiAgICBpc19hYV90YWIoKQoKICAgIGxvY2FsIHRlc3RfdmlzaWJpbGl0eSA9IF91aS5sdWEudGFiLnZhbHVlID09ICJDb25maWciIGFuZCBfdWkubHVhLmVuYWJsZV9sdWEudmFsdWUgYW5kIF91aS5jZmdzLmNmZ3Nfc2VsZWN0LnZhbHVlID09ICJMb2NhbCIKICAgIHVpLnNldF92aXNpYmxlKHVpX2NvbmZpZ3MsIHRlc3RfdmlzaWJpbGl0eSkKICAgIHVpLnNldF92aXNpYmxlKHVpX2NvbmZpZ3NfbmFtZSwgdGVzdF92aXNpYmlsaXR5KQogICAgdWkuc2V0X3Zpc2libGUodWlfbG9hZF9jZmdzLCB0ZXN0X3Zpc2liaWxpdHkpCiAgICB1aS5zZXRfdmlzaWJsZSh1aV9zYXZlX2NmZ3MsIHRlc3RfdmlzaWJpbGl0eSkKICAgIHVpLnNldF92aXNpYmxlKHVpX2RlbGV0ZV9jZmdzLCB0ZXN0X3Zpc2liaWxpdHkpCiAgICB1aS5zZXRfdmlzaWJsZSh1aV9pbXBvcnRfY2ZncywgdGVzdF92aXNpYmlsaXR5KQogICAgdWkuc2V0X3Zpc2libGUodWlfZXhwb3J0X2NmZ3MsIHRlc3RfdmlzaWJpbGl0eSkKICAgIHVpLnNldF92aXNpYmxlKHVpX3NoYXJlX2NmZ3MsIHRlc3RfdmlzaWJpbGl0eSkKCgogICAgaWYgbm90IF91aS5taXNjLmFsdGVybmF0aXZlX3VpOmdldCgpIHRoZW4gcmV0dXJuIGVuZAoKICAgIGlmIHVpX21lbnUuc2VsZWN0ZWRfdGFiID09IDYgdGhlbgogICAgICAgIF91aS5sdWEudGFiOm92ZXJyaWRlKCJDb25maWciKQogICAgZWxzZWlmIHVpX21lbnUuc2VsZWN0ZWRfdGFiID09IDUgdGhlbgogICAgICAgIF91aS5sdWEudGFiOm92ZXJyaWRlKCJNaXNjZWxsYW5lb3VzIikKICAgIGVsc2VpZiB1aV9tZW51LnNlbGVjdGVkX3RhYiA9PSA0IHRoZW4KICAgICAgICBfdWkubHVhLnRhYjpvdmVycmlkZSgiVmlzdWFscyIpCiAgICBlbHNlaWYgdWlfbWVudS5zZWxlY3RlZF90YWIgPT0gMyB0aGVuCiAgICAgICAgX3VpLmx1YS50YWI6b3ZlcnJpZGUoIkFudGktQnJ1dGVmb3JjZSIpCiAgICBlbHNlaWYgdWlfbWVudS5zZWxlY3RlZF90YWIgPT0gMiB0aGVuCiAgICAgICAgX3VpLmx1YS50YWI6b3ZlcnJpZGUoIkRlZmVuc2l2ZSIpCiAgICBlbHNlaWYgdWlfbWVudS5zZWxlY3RlZF90YWIgPT0gMSB0aGVuCiAgICAgICAgX3VpLmx1YS50YWI6b3ZlcnJpZGUoIkFudGktYWltIikKICAgIGVuZAoKICAgIHJlbmRlcl90YWJzKCkKICAgIG5ld190YWIoKQplbmQpCgpjbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrKCJuZXRfdXBkYXRlX2VuZCIsIGZ1bmN0aW9uKCkKICAgIGN0eC5jbGFudGFnOnJ1bigpCmVuZCkKCmNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soInByZV9yZW5kZXIiLCBmdW5jdGlvbigpCiAgICBjdHguYW5pbXM6cnVuKCkKZW5kKQoKY2xpZW50LnNldF9ldmVudF9jYWxsYmFjaygncm91bmRfZW5kJywgZnVuY3Rpb24oKQoJY3R4LmFudGlicnV0ZWZvcmNlLnJlc2V0MigpCmVuZCkKY2xpZW50LnNldF9ldmVudF9jYWxsYmFjaygncm91bmRfc3RhcnQnLCBmdW5jdGlvbigpCgljdHguYW50aWJydXRlZm9yY2UucmVzZXQyKCkKZW5kKQpjbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrKCdjbGllbnRfZGlzY29ubmVjdCcsIGZ1bmN0aW9uKCkKCWN0eC5hbnRpYnJ1dGVmb3JjZS5yZXNldDIoKQplbmQpCmNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soJ2xldmVsX2luaXQnLCBmdW5jdGlvbigpCgljdHguYW50aWJydXRlZm9yY2UucmVzZXQyKCkKZW5kKQpjbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrKCdwbGF5ZXJfY29ubmVjdF9mdWxsJywgZnVuY3Rpb24oZSkgCglpZiBjbGllbnQudXNlcmlkX3RvX2VudGluZGV4KGUudXNlcmlkKSA9PSBlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpIHRoZW4gY3R4LmFudGlicnV0ZWZvcmNlLnJlc2V0MigpIGVuZCAKZW5kKQ=="
}
